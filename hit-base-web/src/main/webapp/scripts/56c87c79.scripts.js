angular.module("commonServices",[]),angular.module("common",["ngResource","default","xml","hl7v2-edi","hl7v2","edi","soap","hit-util"]),angular.module("main",["common"]),angular.module("account",["common"]),angular.module("cf",["common"]),angular.module("doc",["common"]),angular.module("cb",["common"]),angular.module("hit-tool-directives",[]),angular.module("hit-tool-services",["common"]),angular.module("documentation",[]),angular.module("domains",[]),angular.module("logs",["common"]),angular.module("transport",[]),angular.module("reports",["common","treeGrid"]),angular.module("cache",[]);var app=angular.module("hit-app",["ngRoute","ui.bootstrap","ngCookies","LocalStorageModule","treeGrid","ngResource","ngSanitize","ngIdle","ngAnimate","ui.bootstrap","ui-notification","angularBootstrapNavTree","QuickList","hit-util","format","default","hl7v2-edi","xml","hl7v2","edi","soap","cf","cb","reports","ngTreetable","hit-tool-directives","hit-tool-services","commonServices","smart-table","hit-profile-viewer","hit-validation-result","hit-vocab-search","hit-report-viewer","hit-testcase-details","hit-testcase-tree","hit-settings","doc","account","main","hit-manual-report-viewer","ociFixedHeader","ngFileUpload","ui.tree","ui.select","hit-edit-testcase-details","angularFileUpload","documentation","domains","logs","transport","angular-cache","cache","ngFileSaver","LocalForageModule"]),httpHeaders,loginMessage,spinner,mToHide=["usernameNotFound","emailNotFound","usernameFound","emailFound","loginSuccess","userAdded","uploadImageFailed"],msg={};app.config(["$routeProvider","$httpProvider","localStorageServiceProvider","KeepaliveProvider","IdleProvider","NotificationProvider","$provide",function(a,b,c,d,e,f,g){c.setPrefix("hit-app").setStorageType("sessionStorage"),a.when("/",{templateUrl:"views/home.html"}).when("/home",{templateUrl:"views/home.html"}).when("/doc",{templateUrl:"views/documentation/documentation.html"}).when("/setting",{templateUrl:"views/setting.html"}).when("/about",{templateUrl:"views/about.html"}).when("/profilevalidation",{templateUrl:"views/profilevalidation.html",controller:"UploadCtrl",resolve:{isValidationOnly:function(){return!0}}}).when("/cf",{templateUrl:"views/cf/cf.html"}).when("/cb",{templateUrl:"views/cb/cb.html"}).when("/error",{templateUrl:"error.html"}).when("/transport",{templateUrl:"views/transport/transport.html"}).when("/forgotten",{templateUrl:"views/account/forgotten.html",controller:"ForgottenCtrl"}).when("/registration",{templateUrl:"views/account/registration.html",controller:"RegistrationCtrl"}).when("/useraccount",{templateUrl:"views/account/userAccount.html"}).when("/glossary",{templateUrl:"views/glossary.html"}).when("/resetPassword",{templateUrl:"views/account/registerResetPassword.html",controller:"RegisterResetPasswordCtrl",resolve:{isFirstSetup:function(){return!1}}}).when("/registrationSubmitted",{templateUrl:"views/account/registrationSubmitted.html"}).when("/uploadTokens",{templateUrl:"views/home.html",controller:"UploadTokenCheckCtrl"}).when("/addprofiles",{redirectTo:"/cf"}).when("/saveCBTokens",{templateUrl:"views/home.html",controller:"UploadCBTokenCheckCtrl"}).when("/addcbprofiles",{templateUrl:"views/home.html",controller:"UploadCBTokenCheckCtrl"}).when("/domains",{templateUrl:"views/domains/domains.html"}).when("/logs",{templateUrl:"views/logs/logs.html"}).when("/reports",{templateUrl:"views/reports/reports.html"}).otherwise({redirectTo:"/"}),b.interceptors.push("interceptor1"),b.interceptors.push("interceptor2"),b.interceptors.push("interceptor3"),b.interceptors.push("interceptor4"),e.idle(7200),e.timeout(30),d.interval(10),f.setOptions({delay:3e4,maxCount:1}),httpHeaders=b.defaults.headers,g.decorator("nvFileOverDirective",["$delegate",function(a){var b=a[0],c=b.link;return b.compile=function(){return function(a,b,d){var e=d.overClass||"nv-file-over";c.apply(this,arguments),b.on("dragleave",function(){b.removeClass(e)})}},a}])}]),app.factory("interceptor1",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){var f=function(a){440===a.status?(a.data="Session timeout",b.openSessionExpiredDlg()):498===a.status&&(a.data="Invalid Application State",b.openVersionChangeDlg())};return{responseError:function(b){return f(b),a.reject(b)}}}]),app.factory("interceptor2",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){return{response:function(b){return b||a.when(b)},responseError:function(c){if(401===c.status&&"api/accounts/cuser"!==c.config.url){if("api/accounts/login"!==c.config.url){var d=a.defer(),e={config:c.config,deferred:d};b.requests401.push(e)}return b.$broadcast("event:loginRequired"),a.when(c)}return a.reject(c)}}}]),app.factory("interceptor3",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){return{response:function(b){return spinner=!1,b||a.when(b)},responseError:function(b){return spinner=!1,a.reject(b)}}}]),app.factory("interceptor4",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){var f=function(a){if(a.data&&a.data.text&&a.data.type)if(401===a.status)loginMessage={text:a.data.text,type:a.data.type,skip:a.data.skip,show:!0,manualHandle:a.data.manualHandle};else if(503===a.status)msg={text:"server.down",type:"danger",show:!0,manualHandle:!0};else{msg={text:a.data.text,type:a.data.type,skip:a.data.skip,show:!0,manualHandle:a.data.manualHandle};for(var b=!1,c=0;c<mToHide.length&&!b;)msg.text===mToHide[c]&&(b=!0),c++;b===!0&&(msg.show=!1)}};return{response:function(b){return f(b),b||a.when(b)},responseError:function(b){return f(b),a.reject(b)}}}]),app.run(["Session","$rootScope","$location","$modal","TestingSettings","AppInfo","$q","$sce","$templateCache","$compile","StorageService","$window","$route","$timeout","$http","User","Idle","Transport","IdleService","userInfoService","base64","Notification","DomainsManager","$filter",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){k.set(k.ACTIVE_SUB_TAB_KEY,null);c.search().d?decodeURIComponent(c.search().d):null;b.appInfo={},b.stackPosition=0,b.transportSupported=!1,b.scrollbarWidth=null,b.vcModalInstance=null,b.sessionExpiredModalInstance=null,b.errorModalInstanceInstance=null;var y=function(a){t.setCurrentUser(a),p.initUser(a)};b.clearDomainSession=function(){k.set(k.CF_SELECTED_TESTPLAN_ID_KEY,null),k.set(k.CF_EDITOR_CONTENT_KEY,null),k.set(k.CF_LOADED_TESTCASE_ID_KEY,null),k.set(k.CB_EDITOR_CONTENT_KEY,null),k.set(k.CB_SELECTED_TESTCASE_TYPE_KEY,null),k.set(k.CB_LOADED_TESTCASE_ID_KEY,null),k.set(k.CB_LOADED_TESTCASE_TYPE_KEY,null),k.set(k.CB_LOADED_TESTSTEP_TYPE_KEY,null),k.set(k.CB_LOADED_TESTSTEP_ID_KEY,null),k.set(k.ISOLATED_EDITOR_CONTENT_KEY,null),k.set(k.ISOLATED_SELECTED_TESTCASE_TYPE_KEY,null),k.set(k.CB_SELECTED_TESTPLAN_ID_KEY,null),k.set(k.CB_SELECTED_TESTPLAN_TYPE_KEY,null),k.set(k.CB_SELECTED_TESTPLAN_SCOPE_KEY,null),k.set(k.CF_SELECTED_TESTPLAN_SCOPE_KEY,null),k.set(k.CF_SELECTED_TESTPLAN_ID_KEY,null),k.set(k.CF_SELECTED_TESTPLAN_TYPE_KEY,null),k.set(k.CB_MANAGE_SELECTED_TESTCASE_ID_KEY,null),k.set(k.CB_MANAGE_SELECTED_TESTCASE_TYPE_KEY,null),k.set(k.CB_MANAGE_LOADED_TESTCASE_ID_KEY,null),k.set(k.CB_MANAGE_LOADED_TESTCASE_TYPE_KEY,null),k.set(k.CB_MANAGE_LOADED_TESTSTEP_TYPE_KEY,null),k.set(k.CB_MANAGE_LOADED_TESTSTEP_ID_KEY,null),k.set(k.CB_MANAGE_SELECTED_TESTPLAN_ID_KEY,null),k.set(k.CB_MANAGE_SELECTED_TESTPLAN_TYPE_KEY,null),k.set(k.CB_MANAGE_SELECTED_TESTPLAN_SCOPE_KEY,null),k.set(k.APP_SELECTED_DOMAIN,null),k.set(k.CB_TEST_PLANS,[]),k.set(k.CB_LOADED_TESTCASE_ID_KEY,null),k.set(k.ACTIVE_SUB_TAB_KEY,null),k.set(k.TEST_STEP_EXECUTION_MESSAGES_KEY,null),k.set(k.TEST_STEP_VALIDATION_REPORTS_KEY,null),k.set(k.TEST_STEP_MESSAGE_TREES_KEY,null),k.set(k.TEST_STEP_VALIDATION_RESULTS_KEY,null),k.set(k.TEST_STEP_EXECUTION_STATUSES_KEY,null)},b.selectDomain=function(a){null!=a&&(k.set(k.APP_SELECTED_DOMAIN,a),c.search("d",a),b.reloadPage())},b.reloadPage=function(){l.location.reload()},b.$watch(function(){return c.path()},function(a,c){if(b.activePath===a){var d,e=l.history.state;d=!!(e&&e.position<=b.stackPosition),d?b.stackPosition--:b.stackPosition++}else m.current&&(l.history.replaceState({position:b.stackPosition},""),b.stackPosition++)}),b.isActive=function(a){return a===b.activePath},b.setActive=function(a){""===a||"/"===a?c.path("/home"):b.activePath=a},b.isSubActive=function(a){return a===b.subActivePath},b.setSubActive=function(a){b.subActivePath=a,k.set(k.ACTIVE_SUB_TAB_KEY,a)},b.msg=function(){return msg},b.loginMessage=function(){return loginMessage},b.showSpinner=function(){return spinner},b.createGuestIfNotExist=function(){p.createGuestIfNotExist().then(function(a){y(a)},function(a){b.openCriticalErrorDlg("ERROR: Sorry, Failed to initialize the session. Please refresh the page and try again.")})},b.requests401=[],b.$on("event:loginRequired",function(){b.showLoginDialog()}),b.$on("event:loginConfirmed",function(){y(t.getCurrentUser());var a,c=b.requests401,d=function(a){o(a.config).then(function(b){a.deferred.resolve(b)})};for(a=0;a<c.length;a+=1)d(c[a]);b.requests401=[],l.location.reload()}),b.$on("event:loginRequest",function(a,c,d){httpHeaders.common.Accept="application/json",httpHeaders.common.Authorization="Basic "+u.encode(c+":"+d),o.get("api/accounts/login").success(function(){httpHeaders.common.Authorization=null,o.get("api/accounts/cuser").then(function(a){if(a.data&&null!=a.data){var c=angular.fromJson(a.data);t.setCurrentUser(c),b.$broadcast("event:loginConfirmed")}else t.setCurrentUser(null)},function(){t.setCurrentUser(null)})})}),b.$on("event:loginRequestWithAuth",function(a,d,e){httpHeaders.common.Accept="application/json",httpHeaders.common.Authorization="Basic "+d,o.get("api/accounts/login").success(function(){httpHeaders.common.Authorization=null,o.get("api/accounts/cuser").then(function(a){if(a.data&&null!=a.data){var d=angular.fromJson(a.data);y(d),b.$broadcast("event:loginConfirmed"),void 0!==e&&c.url(e)}else t.setCurrentUser(null)},function(){t.setCurrentUser(null)})})}),b.$on("event:loginRedirectRequest",function(a,d,e,f){httpHeaders.common.Accept="application/json",httpHeaders.common.Authorization="Basic "+u.encode(d+":"+e),o.get("api/accounts/login").success(function(){httpHeaders.common.Authorization=null,o.get("api/accounts/cuser").then(function(a){if(a.data&&null!=a.data){var d=angular.fromJson(a.data);y(d),b.$broadcast("event:loginConfirmed")}else t.setCurrentUser(null);c.url(f)},function(){t.setCurrentUser(null)})})}),b.$on("event:logoutRequest",function(){httpHeaders.common.Authorization=null,t.setCurrentUser(null),o.get("j_spring_security_logout").then(function(a){b.createGuestIfNotExist(),b.$broadcast("event:logoutConfirmed")})}),b.$on("event:loginCancel",function(){httpHeaders.common.Authorization=null}),b.$on("$routeChangeStart",function(a,b){msg&&"false"===msg.manualHandle&&(msg.show=!1)}),b.$watch(function(){return b.msg().text},function(a){b.showNotification(b.msg())}),b.$watch("language()",function(a){b.showNotification(b.msg())}),b.loadFromCookie=function(){t.hasCookieInfo()===!0&&(t.loadFromCookie(),httpHeaders.common.Authorization=t.getHthd())},b.showNotification=function(a){if(void 0!=a&&a.show&&null!=a.text){var c=angular.copy(a),d=$.i18n.prop(c.text),e=c.type;"danger"===e?v.error({message:d,templateUrl:"NotificationErrorTemplate.html",scope:b,delay:1e4}):"warning"===e?v.warning({message:d,templateUrl:"NotificationWarningTemplate.html",scope:b,delay:5e3}):"success"===e&&v.success({message:d,templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.text=null,a.type=null,a.show=!1}},b.getScrollbarWidth=function(){if(0==b.scrollbarWidth){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",a.appendChild(d);var e=d.offsetWidth;a.parentNode.removeChild(a),b.scrollbarWidth=c-e}return b.scrollbarWidth},t.loadFromServer().then(function(a){null!==a&&null!=a.accountId&&void 0!=a.accountId?y(a):b.createGuestIfNotExist()},function(a){b.createGuestIfNotExist()}),b.getAppInfo=function(){return b.appInfo},b.isAuthenticationRequired=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.AUTHENTICATION_REQUIRED},b.isEmployerRequired=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.EMPLOYER_REQUIRED},b.isCbManagementSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.CB_MANAGEMENT_SUPPORTED},b.isCfManagementSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.CF_MANAGEMENT_SUPPORTED},b.isDocumentationManagementSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.DOC_MANAGEMENT_SUPPORTED},b.isDomainOwner=function(a){return null!=b.domain&&null!=b.domain.ownerEmails&&b.domain.ownerEmails.length()>0&&b.domain.ownerEmails.indexOf(a)!=-1},b.isDomainsManagementSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.DOMAIN_MANAGEMENT_SUPPORTED||t.isAdmin()||t.isSupervisor()||t.isDeployer()},b.isLoggedIn=function(){return t.isAuthenticated()},b.isDomainSelectionSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.DOMAIN_SELECTION_SUPPORTED},b.isUserLoginSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.USER_LOGIN_SUPPORTED},b.isReportSavingSupported=function(){return b.domain&&b.domain.options&&"true"===b.domain.options.REPORT_SAVING_SUPPORTED},b.isToolScopeSelectionDisplayed=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.TOOL_SCOPE_SELECTON_DISPLAYED},b.isUserLoginSupported=function(){return b.getAppInfo().options&&"true"===b.getAppInfo().options.USER_LOGIN_SUPPORTED}}]),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(a,b,c,d){}]).directive("carousel",[function(){return{}}]),angular.module("hit-tool-services").factory("TabSettings",["$rootScope",function(a){return{new:function(a){return{key:a,activeTab:0,getActiveTab:function(){return this.activeTab},setActiveTab:function(a){this.activeTab=a,this.save()},save:function(){sessionStorage.setItem(this.key,this.activeTab)},restore:function(){this.activeTab=null!=sessionStorage.getItem(this.key)&&""!=sessionStorage.getItem(this.key)?parseInt(sessionStorage.getItem(this.key)):0}}}}}]),app.controller("ErrorDetailsCtrl",["$scope","$modalInstance","error",function(a,b,c){a.error=c,a.ok=function(){b.close(a.error)},a.cancel=function(){b.dismiss("cancel")}}]),app.directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),app.controller("TableFoundCtrl",["$scope","$modalInstance","table",function(a,b,c){a.table=c,a.tmpTableElements=[].concat(null!=c?c.valueSetElements:[]),a.cancel=function(){b.dismiss("cancel")}}]),app.controller("ValidationResultInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),app.filter("capitalize",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),app.controller("ErrorCtrl",["$scope","$modalInstance","StorageService","$window",function(a,b,c,d){a.refresh=function(){b.close(d.location.reload())}}]),app.controller("FailureCtrl",["$scope","$modalInstance","StorageService","$window","error",function(a,b,c,d,e){a.error=e,a.close=function(){b.close()}}]),app.service("base64",function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(b){for(var c,d,e,f,g,h="",i="",j="",k=0;k<b.length;)c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";return h},this.decode=function(b){var c,d,e,f,g,h="",i="",j="",k=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<b.length;)e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!==g&&(h+=String.fromCharCode(d)),64!==j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j=""}}),app.factory("i18n",function(){var a,b=function(b){$.i18n.properties({name:"messages",path:"lang/",mode:"map",language:b,callback:function(){a=b}})};return b("en"),{setLanguage:b}}),app.factory("Resource",["$resource",function(a){return function(b,c,d){var e={update:{method:"put",isArray:!1},create:{method:"post"}};d=angular.extend(e,d);var f=a(b,c,d);return f.prototype.$save=function(a,b){return this.id?this.$update(a,b):this.$create(a,b)},f}}]),angular.module("commonServices").factory("StorageService",["$rootScope","localStorageService",function(a,b){var c={CF_EDITOR_CONTENT_KEY:"CF_EDITOR_CONTENT",CF_LOADED_TESTCASE_ID_KEY:"CF_LOADED_TESTCASE_ID",CF_LOADED_TESTCASE_TYPE_KEY:"CF_LOADED_TESTCASE_TYPE",CB_EDITOR_CONTENT_KEY:"CB_EDITOR_CONTENT",CB_SELECTED_TESTCASE_ID_KEY:"CB_SELECTED_TESTCASE_ID",CB_SELECTED_TESTCASE_TYPE_KEY:"CB_SELECTED_TESTCASE_TYPE",CB_LOADED_TESTCASE_ID_KEY:"CB_LOADED_TESTCASE_ID",CB_LOADED_TESTCASE_TYPE_KEY:"CB_LOADED_TESTCASE_TYPE",CB_LOADED_TESTSTEP_TYPE_KEY:"CB_LOADED_TESTSTEP_TYPE_KEY",CB_LOADED_TESTSTEP_ID_KEY:"CB_LOADED_TESTSTEP_ID",TRANSPORT_CONFIG_KEY:"TRANSPORT_CONFIG_KEY",ACTIVE_SUB_TAB_KEY:"ACTIVE_SUB_TAB",CB_TESTCASE_LOADED_RESULT_MAP_KEY:"CB_TESTCASE_LOADED_RESULT_MAP_KEY",SETTINGS_KEY:"SETTINGS_KEY",USER_KEY:"USER_KEY",USER_CONFIG_KEY:"USER_CONFIG_KEY",TRANSPORT_CONFIG_KEY:"TRANSPORT_CONFIG_KEY",APP_STATE_TOKEN:"APP_STATE_TOKEN",TRANSPORT_DISABLED:"TRANSPORT_DISABLED",TRANSPORT_PROTOCOL:"TRANSPORT_PROTOCOL",CB_SELECTED_TESTPLAN_ID_KEY:"CB_SELECTED_TESTPLAN_ID",CB_SELECTED_TESTPLAN_TYPE_KEY:"CB_SELECTED_TESTPLAN_TYPE",CB_SELECTED_TESTPLAN_SCOPE_KEY:"CB_SELECTED_TESTPLAN_SCOPE_KEY",CF_SELECTED_TESTPLAN_SCOPE_KEY:"CF_SELECTED_TESTPLAN_SCOPE_KEY",CF_SELECTED_TESTPLAN_ID_KEY:"CF_SELECTED_TESTPLAN_ID",CF_SELECTED_TESTPLAN_TYPE_KEY:"CF_SELECTED_TESTPLAN_TYPE",TRANSPORT_TIMEOUT:"TRANSPORT_TIMEOUT",CB_MANAGE_SELECTED_TESTCASE_ID_KEY:"CB_MANAGE_SELECTED_TESTCASE_ID",CB_MANAGE_SELECTED_TESTCASE_TYPE_KEY:"CB_MANAGE_SELECTED_TESTCASE_TYPE",CB_MANAGE_LOADED_TESTCASE_ID_KEY:"CB_MANAGE_LOADED_TESTCASE_ID",CB_MANAGE_LOADED_TESTCASE_TYPE_KEY:"CB_MANAGE_LOADED_TESTCASE_TYPE",CB_MANAGE_LOADED_TESTSTEP_TYPE_KEY:"CB_MANAGE_LOADED_TESTSTEP_TYPE_KEY",CB_MANAGE_LOADED_TESTSTEP_ID_KEY:"CB_MANAGE_LOADED_TESTSTEP_ID",CB_MANAGE_SELECTED_TESTPLAN_ID_KEY:"CB_MANAGE_SELECTED_TESTPLAN_ID",CB_MANAGE_SELECTED_TESTPLAN_TYPE_KEY:"CB_MANAGE_SELECTED_TESTPLAN_TYPE",CB_MANAGE_SELECTED_TESTPLAN_SCOPE_KEY:"CB_MANAGE_SELECTED_TESTPLAN_SCOPE_KEY",DOC_MANAGE_SELECTED_SCOPE_KEY:"DOC_MANAGE_SELECTED_SCOPE_KEY",APP_SELECTED_DOMAIN:"APP_SELECTED_DOMAIN",DOMAIN_MANAGE_SELECTED_SCOPE_KEY:"DOMAIN_MANAGE_SELECTED_SCOPE_KEY",DOMAIN_MANAGE_SELECTED_ID:"DOMAIN_MANAGE_SELECTED_ID",CF_MANAGE_SELECTED_TESTPLAN_ID_KEY:"CF_MANAGE_SELECTED_TESTPLAN_ID_KEY",CB_TEST_PLANS:"CB_TEST_PLANS",TEST_STEP_EXECUTION_MESSAGES_KEY:"testStepExecutionMessages",TEST_STEP_VALIDATION_REPORTS_KEY:"testStepValidationReports",TEST_STEP_MESSAGE_TREES_KEY:"testStepMessageTrees",TEST_STEP_VALIDATION_RESULTS_KEY:"testStepValidationResults",TEST_STEP_EXECUTION_STATUSES_KEY:"testStepExecutionStatuses",remove:function(a){return b.remove(a)},removeList:function(a,c,d){return b.remove(a,c,d)},clearAll:function(){return b.clearAll()},set:function(a,c){return b.set(a,c)},get:function(a){return b.get(a)},getTransportConfig:function(a,c){return b.get(a+"-"+c+"-transport-configs")},setTransportConfig:function(a,c,d){return b.set(a+"-"+c+"-transport-configs",d)}};return c}]),angular.module("transport").factory("Transport",["$q","$http","StorageService","User","$timeout","$rootScope",function(a,b,c,d,e,f){var g={running:!1,configs:{},transactions:[],logs:{},timeout:null!=c.get(c.TRANSPORT_TIMEOUT)&&void 0!=c.get(c.TRANSPORT_TIMEOUT)?c.get(c.TRANSPORT_TIMEOUT):120,disabled:null==c.get(c.TRANSPORT_DISABLED)||c.get(c.TRANSPORT_DISABLED),setDisabled:function(a){this.disabled=a},setTimeout:function(a){this.timeout=a,c.set(c.TRANSPORT_TIMEOUT,a)},getTimeout:function(){return this.timeout},getDomainForms:function(c){var d=a.defer();return b.get("api/transport/forms/"+c).then(function(a){var b=angular.fromJson(a.data);d.resolve(b)},function(a){d.reject(a)}),d.promise},getConfigData:function(c,e){var f=a.defer();return null!=c&&null!=e&&d.info&&null!=d.info&&null!=d.info.id?b.post("api/transport/"+c+"/"+e+"/configs").then(function(a){f.resolve(angular.fromJson(a.data))},function(a){f.reject(a)}):f.reject("Domain, protocol or user info not provided"),f.promise},searchTransaction:function(c,e,f,g,h){var i=a.defer(),j=this;if(null!=e){var k=angular.fromJson({testStepId:c,userId:d.info.id,config:e,responseMessageId:f});b.post("api/transport/"+g+"/"+h+"/searchTransaction",k).then(function(a){null!=a.data&&""!=a.data?j.transactions[c]=angular.fromJson(a.data):j.transactions[c]=null,i.resolve(j.transactions[c])},function(a){j.transactions[c]=null,i.reject(j.transactions[c])})}else i.reject("Configuration info not found");return i.promise},deleteTransaction:function(c){var d=a.defer(),e=this;if(e.transactions&&null!=e.transactions&&e.transactions[c]){var f=e.transactions[c];b.post("api/transport/transaction/"+f.id+"/delete").then(function(a){delete e.transactions[c],d.resolve(!0)},function(a){delete e.transactions[c],d.resolve(!0)})}else d.resolve(!0);return d.promise},stopListener:function(c,d,e){var f=this,g=a.defer();return this.deleteTransaction(c).then(function(a){var h=angular.fromJson({testStepId:c});b.post("api/transport/"+d+"/"+e+"/stopListener",h).then(function(a){f.running=!0,g.resolve(!0)},function(a){f.running=!1,g.reject(null)})}),g.promise},startListener:function(c,d,e,f){var g=a.defer(),h=this;return this.deleteTransaction(c).then(function(a){var i=angular.fromJson({testStepId:c,responseMessageId:d});b.post("api/transport/"+e+"/"+f+"/startListener",i).then(function(a){h.running=!0,g.resolve(!0)},function(a){h.running=!1,g.reject(null)})}),g.promise},send:function(c,d,e,f){var g=a.defer(),h=this;return this.deleteTransaction(c).then(function(a){var i=angular.fromJson({testStepId:c,message:d,config:h.configs[f].data.taInitiator});b.post("api/transport/"+e+"/"+f+"/send",i).then(function(a){h.transactions[c]=angular.fromJson(a.data),g.resolve(h.transactions[c])},function(a){h.transactions[c]=null,g.reject(a)})}),g.promise},populateMessage:function(c,d,e,f){var g=a.defer(),h=angular.fromJson({testStepId:c,message:d});return b.post("api/transport/"+e+"/"+f+"/populateMessage",h).then(function(a){g.resolve(angular.fromJson(a.data))},function(a){g.reject(null)}),g.promise},saveTransportLog:function(c,d,e,f){var g=a.defer(),h=angular.fromJson({testStepId:c,content:d,domain:e,protocol:f});return b.post("api/logs/transport",h).then(function(a){g.resolve(a.data)},function(a){g.reject(null)}),g.promise}};return g}]),angular.module("cf").factory("CF",["$rootScope","$http","$q","Message","Tree",function(a,b,c,d,e){var f={editor:null,cursor:null,tree:new e,testCase:null,selectedTestCase:null,message:new d,searchTableId:0,savedReports:[],selectedSavedReport:null};return f}]),angular.module("cf").factory("CFTestPlanExecutioner",["$q","$http","$rootScope","CacheFactory","$localForage",function(a,b,c,d,e){var f={getTestPlan:function(c){var d=a.defer();return b.get("api/cf/testplans/"+c+"/updateDate",{timeout:18e4}).then(function(a){e.getItem("api/cf/testplans/"+c,!0).then(function(f){var g=f;g&&g.updateDate===a.data?d.resolve(f):b.get("api/cf/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cf/testplans/"+c,angular.fromJson(a.data)).then(function(){}),d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)})},function(a){b.get("api/cf/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cf/testplans/"+c,angular.fromJson(a.data)).then(function(){}),d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)})})},function(a){b.get("api/cf/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cf/testplans/"+c,angular.fromJson(a.data)).then(function(){}),d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)})}),d.promise},getTestPlans:function(c,d){var e=a.defer();return b.get("api/cf/testplans",{timeout:18e4,params:{scope:c,domain:d}}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise}};return f}]),angular.module("cf").factory("CFTestPlanManager",["$q","$http",function(a,b){var c={getTestStepGroupProfiles:function(c){var d=a.defer();return b.get("api/cf/management/testStepGroups/"+c+"/profiles",{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getTestPlanProfiles:function(c){var d=a.defer();return b.get("api/cf/management/testPlans/"+c+"/profiles",{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getTokenProfiles:function(c,d){var e=a.defer();return b.get("api/cf/"+c+"/management/tokens/"+d+"/profiles",{timeout:18e4}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},getTestPlan:function(c){var d=a.defer();return b.get("api/cf/management/testPlans/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getTestPlans:function(c,d){var e=a.defer();return b.get("api/cf/management/testPlans",{timeout:18e4,params:{scope:c,domain:d}}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},addChild:function(c,d){var e=a.defer(),f=$.param({position:c.position,name:c.name,description:c.description,scope:c.scope,domain:c.domain}),g={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}},h=null;return h="TestPlan"==d.type?"api/cf/management/testPlans/"+d.id+"/addChild":"api/cf/management/testStepGroups/"+d.id+"/addChild",b.post(h,f,g).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},createTestPlan:function(c){var d=a.defer(),e=$.param({name:c.name,description:c.description,position:c.position,domain:c.domain,scope:c.scope}),f={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}};return b.post("api/cf/management/testPlans/create",e,f).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteProfile:function(c,d){var e=a.defer();return b.post("api/cf/"+c+"/management/profiles/"+d+"/delete").then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},deleteTestStepGroup:function(c){var d=a.defer(),e="TestPlan"===c.parent.type?"testPlans/":"testStepGroups/";return b.post("api/cf/management/"+e+c.parent.id+"/testStepGroups/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTestPlan:function(c){var d=a.defer();return b.post("api/cf/management/testPlans/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},updateLocation:function(c,d,e){var f=$.param({newPosition:e,oldParentId:d.parent.id,oldParentType:d.parent.type,newParentId:c.id,newParentType:c.type}),g={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}},h=a.defer();return b.post("api/cf/management/testStepGroups/"+d.id+"/location",f,g).then(function(a){h.resolve(angular.fromJson(a.data))},function(a){h.reject(a.data)}),h.promise},deleteToken:function(c){var d=a.defer();return b.post("api/cf/management/tokens/"+c+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(response.data)}),d.promise},saveTestStepGroup:function(c,d,e,f,g,h,i){var j=a.defer();return b.post("api/cf/"+c+"/management/testStepGroups/"+i.groupId,{groupId:i.groupId,testcasename:i.name,testcasedescription:i.description,added:h,removed:g,updated:f,token:e,scope:d}).then(function(a){j.resolve(angular.fromJson(a.data))},function(a){j.reject(a.data)}),j.promise},saveTestPlan:function(c,d,e,f,g,h,i){var j=a.defer();return b.post("api/cf/"+c+"/management/testPlans/"+i.groupId,{groupId:i.groupId,testcasename:i.name,testcasedescription:i.description,added:h,removed:g,updated:f,token:e,scope:d}).then(function(a){j.resolve(angular.fromJson(a.data))},function(a){j.reject(a.data)}),j.promise},publishTestPlan:function(c){var d=a.defer();return b.post("api/cf/management/testPlans/"+c+"/publish").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},unPublishTestPlan:function(c){var d=a.defer();return b.post("api/cf/management/testPlans/"+c+"/unPublish").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise}};return c}]),angular.module("cf").service("modalService",["$modal",function(a){var b={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"views/cf/modal.html"},c={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(a,b){return a||(a={}),a.backdrop="static",this.show(a,b)},this.show=function(d,e){var f={},g={};return angular.extend(f,b,d),angular.extend(g,c,e),f.controller||(f.controller=["$scope","$modalInstance",function(a,b){a.modalOptions=g,a.modalOptions.ok=function(a){b.close(a)},a.modalOptions.close=function(a){b.dismiss("cancel")}}]),a.open(f).result}}]),angular.module("cb").factory("CB",["Message","ValidationSettings","Tree","StorageService","Transport","Logger","User",function(a,b,c,d,e,f,g){var h={testCase:null,selectedTestCase:null,selectedTestPlan:null,editor:null,tree:new c,cursor:null,message:new a,logger:new f,validationSettings:new b,setContent:function(a){h.message.content=a,h.editor.instance.doc.setValue(a),h.message.notifyChange()},getContent:function(){return h.message.content},savedReports:[],selectedSavedReport:null};return h}]),angular.module("cb").factory("CBTestPlanListLoader",["$q","$http","StorageService",function(a,b,c){return function(c,d){var e=a.defer();return b.get("api/cb/testplans",{timeout:18e4,params:{scope:c,domain:d}}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise}}]),angular.module("cb").factory("CBTestPlanLoader",["$q","$http","$rootScope","CacheFactory","$localForage",function(a,b,c,d,e){return function(c,d){var f=a.defer();return b.get("api/cb/testplans/"+c+"/updateDate",{timeout:18e4}).then(function(a){e.getItem("api/cb/testplans/"+c,!0).then(function(d){var g=d;g&&g.updateDate===a.data?f.resolve(d):b.get("api/cb/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cb/testplans/"+c,angular.fromJson(a.data)).then(function(){}),f.resolve(angular.fromJson(a.data))},function(a){f.reject(a.data)})},function(a){b.get("api/cb/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cb/testplans/"+c,angular.fromJson(a.data)).then(function(){}),f.resolve(angular.fromJson(a.data))},function(a){f.reject(a.data)})})},function(a){b.get("api/cb/testplans/"+c,{timeout:18e4}).then(function(a){e.setItem("api/cb/testplans/"+c,angular.fromJson(a.data)).then(function(){}),f.resolve(angular.fromJson(a.data))},function(a){f.reject(a.data)})}),f.promise}}]),angular.module("cb").factory("CBTestPlanManager",["$q","$http",function(a,b){var c={getTestPlan:function(c){var d=a.defer();return b.get("api/cb/management/testPlans/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getTestPlans:function(c,d){var e=a.defer();return b.get("api/cb/management/testPlans",{timeout:18e4,params:{scope:c,domain:d}}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},publishTestPlan:function(c){var d=a.defer();return b.post("api/cb/management/testPlans/"+c+"/publish").then(function(a){
d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTestStep:function(c){var d=a.defer();return b.post("api/cb/management/testCases/"+c.parent.id+"/testSteps/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTestCase:function(c){var d=a.defer(),e="TestPlan"===c.parent.type?"testPlans/":"testCaseGroups/";return b.post("api/cb/management/"+e+c.parent.id+"/testCases/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTestPlan:function(c){var d=a.defer();return b.post("api/cb/management/testPlans/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTestCaseGroup:function(c){var d=a.defer(),e="TestPlan"===c.parent.type?"testPlans/":"testCaseGroups/";return b.post("api/cb/management/"+e+c.parent.id+"/testCaseGroups/"+c.id+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},updateTestCaseGroupName:function(c){var d=a.defer();return b.post("api/cb/management/testCaseGroups/"+c.id+"/name",{name:c.editName}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},updateTestCaseName:function(c){var d=a.defer();return b.post("api/cb/management/testCases/"+c.id+"/name",{name:c.editName}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},updateTestStepName:function(c){var d=a.defer();return b.post("api/cb/management/testSteps/"+c.id+"/name",{name:c.editName}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},updateTestPlanName:function(c){var d=a.defer();return b.post("api/cb/management/testPlans/"+c.id+"/name",{name:c.editName}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},saveZip:function(c,d){var e=a.defer();return b.post("api/cb/management/saveZip/",{token:c,domain:d}).then(function(a){e.resolve(angular.fromJson(a.data))},function(a){e.reject(a.data)}),e.promise},unpublishTestPlan:function(c){var d=a.defer();return b.post("api/cb/management/testPlans/"+c+"/unpublish").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise}};return c}]),angular.module("main").controller("MainService",["$scope",function(a){}]),angular.module("main").factory("TestingSettings",["$rootScope",function(a){var b={activeTab:0,getActiveTab:function(){return b.activeTab},setActiveTab:function(a){b.activeTab=a,b.save()},save:function(){sessionStorage.TestingActiveTab=b.activeTab},restore:function(){b.activeTab=null!=sessionStorage.TestingActiveTab&&""!=sessionStorage.TestingActiveTab?parseInt(sessionStorage.TestingActiveTab):0}};return b}]),angular.module("main").service("modalService",["$modal",function(a){var b={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"views/modal.html"},c={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(a,b){return a||(a={}),a.backdrop="static",this.show(a,b)},this.show=function(d,e){var f={},g={};return angular.extend(f,b,d),angular.extend(g,c,e),f.controller||(f.controller=["$scope","$modalInstance",function(a,b){a.modalOptions=g,a.modalOptions.ok=function(a){b.close(a)},a.modalOptions.close=function(a){b.dismiss("cancel")}}]),a.open(f).result}}]),angular.module("account").factory("Account",["$resource",function(a){return a("api/accounts/:id",{id:"@id"})}]),angular.module("account").factory("LoginService",["$resource","$q",function(a,b){return function(){var c=a("api/accounts/login"),d=b.defer();return c.get({},function(a){d.resolve(a)}),d.promise}}]),angular.module("account").factory("AccountLoader",["Account","$q",function(a,b){return function(c){var d=b.defer();return a.get({id:c},function(a){d.resolve(a)},function(){d.reject("Unable to fetch account")}),d.promise}}]),angular.module("account").factory("Testers",["$resource",function(a){return a("api/shortaccounts",{filter:["accountType::tester","accountType::deployer","accountType::admin"]})}]),angular.module("account").factory("Supervisors",["$resource",function(a){return a("api/shortaccounts",{filter:"accountType::supervisor"})}]),angular.module("account").factory("MultiTestersLoader",["Testers","$q",function(a,b){return function(){var c=b.defer();return a.query(function(a){c.resolve(a)},function(){c.reject("Unable to fetch list of testers")}),c.promise}}]),angular.module("account").factory("MultiSupervisorsLoader",["Supervisors","$q",function(a,b){return function(){var c=b.defer();return a.query(function(a){c.resolve(a)},function(){c.reject("Unable to fetch list of supervisors")}),c.promise}}]),angular.module("account").factory("userLoaderService",["userInfo","$q",function(a,b){var c=function(){var c=b.defer();return a.get({},function(a){c.resolve(a)},function(){c.reject("Unable to fetch user info")}),c.promise};return{load:c}}]),angular.module("account").factory("userInfo",["$resource",function(a){return a("api/accounts/cuser")}]),angular.module("account").factory("userLoaderService",["userInfo","$q",function(a,b){var c=function(){var c=b.defer();return a.get({},function(a){c.resolve(a)},function(){c.reject("Unable to fetch user info")}),c.promise};return{load:c}}]),angular.module("account").factory("userInfoService",["StorageService","userLoaderService","User","Transport","$q","$timeout","$rootScope",function(a,b,c,d,e,f,g){var h=null,i=!1,j=!1,k=!1,l=!1,m=!1,n=null,o="",p="",q=null,r=null,s=function(){n=a.get("userID"),o=a.get("username"),j=a.get("tester"),i=a.get("supervisor"),l=a.get("deployer"),k=a.get("publisher"),m=a.get("admin"),q=a.get("lastTestPlanPersistenceId"),r=a.get("employer")},t=function(b){a.set("hthd",b)},u=function(b){return a.get("hthd")},v=function(){return""!==a.get("username")},w=function(){return D()?h.accountId.toString():"0"},x=function(){return!m&&null!=h&&null!=g.appInfo.adminEmails&&g.appInfo.adminEmails&&(m=Array.isArray(g.appInfo.adminEmails)?g.appInfo.adminEmails.indexOf(h.email)>=0:g.appInfo.adminEmails===h.email),m},y=function(){return j},z=function(){return i},A=function(){return l},B=function(){return k},C=function(){return!(!D()||null==h)&&h.pending},D=function(){var a=void 0!==h&&null!=h&&h.authenticated===!0;return a},E=function(){if(D()){var a=e.defer();return f(function(){a.resolve(h)}),a.promise}return b.load()},F=function(){return h},G=function(a){h=a,null!==h&&void 0!==h?(o=h.username,n=h.accountId,p=h.fullName,q=h.lastTestPlanPersistenceId,r=h.employer,angular.isArray(h.authorities)&&angular.forEach(h.authorities,function(a,b){switch(a.authority){case"user":break;case"admin":m=!0;break;case"tester":j=!0;break;case"supervisor":i=!0;break;case"deployer":l=!0;break;case"publisher":k=!0}})):(i=!1,j=!1,l=!1,k=!1,m=!1,o="",n=null,p="",q=null,r="")},H=function(){return o},I=function(){return p},J=function(){return q},K=function(){return r};return{saveHthd:t,getHthd:u,hasCookieInfo:v,loadFromCookie:s,getAccountID:w,isAdmin:x,isPublisher:B,isTester:y,isAuthenticated:D,isPending:C,isSupervisor:z,isDeployer:A,setCurrentUser:G,getCurrentUser:F,loadFromServer:E,getUsername:H,getFullName:I,getLastTestPlanPersistenceId:J,getEmployer:K}}]),angular.module("doc").factory("DocumentationManager",["$q","$http",function(a,b){var c={getInstallationGuide:function(){var c=a.defer();return b.get("api/documentation/installationguides",{timeout:6e4}).then(function(a){null!=a.data&&""!=a.data?c.resolve(angular.fromJson(a.data)):c.resolve(null)},function(a){c.reject(a.data)}),c.promise},getTestCaseDocuments:function(c,d){var e=a.defer();return b.get("api/documentation/testcases",{timeout:6e4,params:{domain:c,scope:d}}).then(function(a){null!=a.data&&""!=a.data?e.resolve(angular.fromJson(a.data)):e.resolve(null)},function(a){e.reject(a.data)}),e.promise},getDocuments:function(c,d,e){var f=a.defer();return b.get("api/documentation/documents",{params:{domain:c,scope:d,type:e}}).then(function(a){f.resolve(angular.fromJson(a.data))},function(a){f.reject(a.data)}),f.promise},saveDocument:function(c){var d=a.defer();return b.post("api/documentation/documents",c).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteDocument:function(c){var d=a.defer();return b.post("api/documentation/documents/"+c+"/delete").then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},publishDocument:function(c){var d=a.defer();return b.post("api/documentation/documents/"+c+"/publish").then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise}};return c}]),angular.module("domains").factory("DomainsManager",["$q","$http",function(a,b){var c={getUserDomains:function(){var c=a.defer();return b.get("api/domains/findByUser",{timeout:6e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},findByUserAndRole:function(){var c=a.defer();return b.get("api/domains/findByUserAndRole",{timeout:6e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDomains:function(){var c=a.defer();return b.get("api/domains",{timeout:6e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDomainsByScope:function(c){var d=a.defer();return b.get("api/domains/searchByScope"+{params:{scope:c}}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getDomainById:function(c){var d=a.defer();return b.get("api/domains/"+c,{timeout:6e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},canModify:function(c){var d=a.defer();return b.get("api/domains/"+c+"/canModify",{timeout:6e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getUpdateDate:function(c){var d=a.defer();return b.get("api/domains/"+c+"/updateDate",{timeout:6e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getDomainByKey:function(c){var d=a.defer();return b.get("api/domains/searchByKey",{params:{key:c}}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},save:function(c){var d=a.defer(),e=angular.fromJson(c);return b.post("api/domains/"+c.id,e).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},publish:function(c){var d=a.defer();return b.post("api/domains/"+c+"/publish").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},unpublish:function(c){var d=a.defer();return b.post("api/domains/"+c+"/unpublish").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},saveAndPublish:function(c){var d=a.defer(),e=angular.fromJson(c);return b.post("api/domains/save-publish",e).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},saveAndUnpublish:function(c){var d=a.defer(),e=angular.fromJson(c);return b.post("api/domains/save-unpublish",e).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},delete:function(c){var d=a.defer();return b.post("api/domains/"+c+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},create:function(c,d,e,f){var g=a.defer(),h=angular.fromJson({domain:d,name:c,scope:e,homeTitle:f});return b.post("api/domains/create",h).then(function(a){g.resolve(angular.fromJson(a.data))},function(a){g.reject(a.data)}),g.promise},getDefaultHomeContent:function(){var c=a.defer();return b.post("api/domains/home-content").then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDefaultValueSetCopyright:function(){var c=a.defer();return b.post("api/domains/valueset-copyright").then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDefaultProfileInfo:function(){var c=a.defer();return b.post("api/domains/profile-info").then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDefaultMessageContent:function(){var c=a.defer();return b.post("api/domains/message-content").then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise},getDefaultValidationResultInfo:function(){var c=a.defer();return b.post("api/domains/validation-result-info").then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise}};return c}]),angular.module("logs").factory("ValidationLogService",["$q","$http",function(a,b){var c={getTotalCount:function(c){var d=a.defer();return b.get("api/logs/validation/"+c+"/count",{timeout:18e4}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},getAll:function(c){var d=a.defer();return b.get("api/logs/validation/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getById:function(c){var d=a.defer();return b.get("api/logs/validation/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteLog:function(c){var d=a.defer();return b.post("api/logs/validation/"+c+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise}};return c}]),angular.module("logs").factory("TransportLogService",["$q","$http",function(a,b){var c={getTotalCount:function(c){var d=a.defer();return b.get("api/logs/transport/"+c+"/count",{timeout:18e4}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},getAll:function(c){var d=a.defer();return b.get("api/logs/transport/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},getById:function(c){var d=a.defer();return b.get("api/logs/transport/"+c,{timeout:18e4}).then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteLog:function(c){var d=a.defer();return b.post("api/logs/transport/"+c+"/delete").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise}};return c}]),angular.module("reports").factory("ReportService",["$rootScope","$http","$q","$filter","Notification","FileSaver",function(a,b,c,d,e,f){var g={downloadTestStepValidationReport:function(a,b){var c=document.createElement("form");c.action="api/tsReport/"+a+"/download",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="format",d.value=b,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()},downloadMessageValidationReport:function(a,b){var c=document.createElement("form");c.action="api/mReport"+a+"/download",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="format",d.value=b,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()},downloadTestCaseReports:function(a,b,c,d,e,f){var g=document.createElement("form");g.action="api/tcReport/download",g.method="POST",g.target="_target";var h=document.createElement("input");h.name="format",h.value=b,g.appendChild(h),h=document.createElement("input"),h.name="testCaseId",h.value=a,g.appendChild(h),h=document.createElement("input"),h.name="result",h.value=c,g.appendChild(h),h=document.createElement("input"),h.name="comments",h.value=d,g.appendChild(h),h=document.createElement("input"),h.name="testPlan",h.value=e,g.appendChild(h),h=document.createElement("input"),h.name="testGroup",h.value=f,g.appendChild(h),g.style.display="none",document.body.appendChild(g),g.submit()},createMessageValidationReport:function(a){var d=c.defer(),e=angular.fromJson({testStepId:a});return b.post("api/tsReport/create",e).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},initTestStepValidationReport:function(a){var d=c.defer(),e=$.param({testStepId:a}),f={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}};return b.post("api/tsReport/init",e,f).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},getJson:function(a,d){var e=c.defer();return b.get("api/tsReport/json",{params:{testStepId:a,testReportId:d}}).then(function(a){e.resolve(a)},function(a){e.reject(a.data)}),e.promise},updateTestStepValidationReport:function(a,d,e,f){var g=c.defer(),h=angular.fromJson({reportId:a,testStepId:d,result:e,comments:f});return b.post("api/tsReport/save",h).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;g.resolve(b)},function(a){g.reject(a.data)}),g.promise},saveValidationReport:function(a){var d=c.defer(),e=angular.fromJson({testStepValidationReportId:a});return b.post("api/userTSReport/savePersistentUserTestStepReport",e).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){console.log("error"),d.reject(a.data)}),d.promise},saveTestCaseValidationReport:function(a,d,e,f){var g=c.defer(),h=angular.fromJson({testCaseId:a,testStepReportIds:d,result:e,comments:f});return b.post("api/userTCReport/savePersistentUserTestCaseReport",h).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;g.resolve(b)},function(a){g.reject(a.data)}),g.promise},downloadUserTestStepValidationReport:function(a,c){return b.get("api/userTSReport/"+a+"/download/"+c,{responseType:"blob"}).then(function(a){var b,c=a.headers("Content-Disposition");b=null!=c?c.split(";")[1].split("filename")[1].split("=")[1].trim():"report",f.saveAs(a.data,b)})},downloadUserTestCaseValidationReport:function(a,c){return b.get("api/userTCReport/"+a+"/download/"+c,{responseType:"blob"}).then(function(a){var b,c=a.headers("Content-Disposition");b=null!=c?c.split(";")[1].split("filename")[1].split("=")[1].trim():"report",f.saveAs(a.data,b)})},getAllTSByAccountIdAndDomain:function(a){var d=c.defer();return b.get("api/userTSReport/domain/"+a,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},getAllTSByAccountIdAndDomainAndtestStepId:function(a,d){var e=c.defer();return b.get("api/userTSReport/domain/"+a+"/testStep/"+d,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;e.resolve(b)},function(a){e.reject(a.data)}),e.promise},getAllIndependantTSByAccountIdAndDomainAndtestStepId:function(a,d){var e=c.defer();return b.get("api/userTSReport/domain/"+a+"/testStep/"+d,{timeout:18e4,params:{onlyIndependant:!0}}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;e.resolve(b)},function(a){e.reject(a.data)}),e.promise},getAllTCByAccountIdAndDomainAndtestCaseId:function(a,d){var e=c.defer();return b.get("api/userTCReport/domain/"+a+"/testCase/"+d,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;e.resolve(b)},function(a){e.reject(a.data)}),e.promise},getAllTCByAccountIdAndDomain:function(a){var d=c.defer();return b.get("api/userTCReport/domain/"+a,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},getUserTSReport:function(a){var d=c.defer();return b.get("api/userTSReport/"+a,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},getUserTCReport:function(a){var d=c.defer();return b.get("api/userTCReport/"+a,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},getAllReportsByAccountIdAndDomain:function(a){var d=c.defer();return b.get("api/reports/"+a,{timeout:18e4}).then(function(a){var b=null!=a.data&&""!=a.data?angular.fromJson(a.data):null;d.resolve(b)},function(a){d.reject(a.data)}),d.promise},deleteTSReport:function(a){var d=c.defer();return b.post("api/userTSReport/"+a+"/deleteReport").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise},deleteTCReport:function(a){var d=c.defer();return b.post("api/userTCReport/"+a+"/deleteReport").then(function(a){d.resolve(angular.fromJson(a.data))},function(a){d.reject(a.data)}),d.promise}};return g}]),angular.module("cache").factory("CachingService",["$q","$http","$rootScope","CacheFactory","CBTestPlanListLoader","CBTestPlanLoader","CFTestPlanExecutioner",function(a,b,c,d,e,f,g){var h={cacheCBTestPlans:function(a,b){var d=new e(a,c.domain.domain);d.then(function(a){for(var b=0;b<a.length;b++){var d=new f(a[b].id,c.domain);d.then(function(a){},function(a){})}},function(a){$scope.error="Sorry, Cannot load the test plans. Please try again"})},cacheCFTestPlans:function(a,b){g.getTestPlans(a,b).then(function(a){for(var b=0;b<a.length;b++)g.getTestPlan(a[b].id,c.domain).then(function(a){},function(a){})},function(a){$scope.error="Sorry, Cannot load the test plans. Please try again"})}};return h}]),angular.module("main").controller("MainCtrl",["$scope","$rootScope","i18n","$location","userInfoService","$modal","$filter","base64","$http","Idle","Notification","IdleService","StorageService","TestingSettings","Session","AppInfo","User","$templateCache","$window","$sce","DomainsManager","Transport","$timeout","CBTestPlanListLoader","CBTestPlanLoader","CachingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(){b.warning&&(b.warning.close(),b.warning=null),b.timedout&&(b.timedout.close(),b.timedout=null)}b.loginDialog=null,b.started=!1;var B=d.search().d?decodeURIComponent(d.search().d):null;a.language=function(){return c.language},a.setLanguage=function(a){c.setLanguage(a)},a.activeWhen=function(a){return a?"active":""},a.activeIfInList=function(a,b){var c=!1;if(angular.isArray(b)===!1)return"";for(var d=0;d<b.length&&c===!1;){if(b[d]===a)return"active";d++}return""},a.path=function(){return d.url()},a.login=function(){a.$emit("event:loginRequest",a.username,a.password)},a.loginAndRedirect=function(b){a.$emit("event:loginRedirectRequest",a.username,a.password,b)},a.loginReq=function(){b.loginMessage()&&(b.loginMessage().text="",b.loginMessage().show=!1),a.$emit("event:loginRequired")},a.logout=function(){a.execLogout()},a.execLogout=function(){e.setCurrentUser(null),a.username=a.password=null,a.$emit("event:logoutRequest"),d.url("/home"),s.location.reload()},a.cancel=function(){a.$emit("event:loginCancel")},a.isAuthenticated=function(){return e.isAuthenticated()},a.isPending=function(){return e.isPending()},a.isSupervisor=function(){return e.isSupervisor()},a.isTester=function(){return e.isTester()},a.isAdmin=function(){return e.isAdmin()},a.isPublisher=function(){return e.isPublisher()},a.getRoleAsString=function(){return a.isTester()===!0?"tester":a.isSupervisor()===!0?"Supervisor":a.isAdmin()===!0?"Admin":"undefined"},a.getUsername=function(){return e.isAuthenticated()===!0?e.getUsername():""},b.showLoginDialog=function(c){b.loginDialog&&null!=b.loginDialog&&b.loginDialog.opened&&b.loginDialog.dismiss("cancel"),b.loginDialog=f.open({backdrop:"static",keyboard:"false",controller:"LoginCtrl",size:"lg",templateUrl:"views/account/login.html",resolve:{user:function(){return{username:a.username,password:a.password}}}}),b.loginDialog.result.then(function(b){b?(a.username=b.username,a.password=b.password,void 0!==c?a.loginAndRedirect(c+"&loggedin=true"):a.login()):a.cancel()})},b.started=!1,j.watch(),b.$on("IdleStart",function(){A(),b.warning=f.open({templateUrl:"warning-dialog.html",windowClass:"modal-danger"})}),b.$on("IdleEnd",function(){A()}),b.$on("IdleTimeout",function(){A(),a.isAuthenticated()?(b.$emit("event:execLogout"),b.timedout=f.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger"})):(m.clearAll(),o.delete().then(function(a){b.timedout=f.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.timedout.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()})}))}),a.$on("Keepalive",function(){a.isAuthenticated()&&l.keepAlive()}),b.$on("Keepalive",function(){l.keepAlive()}),b.$on("event:execLogout",function(){a.execLogout()}),b.start=function(){A(),j.watch(),b.started=!0},b.stop=function(){A(),j.unwatch(),b.started=!1},a.checkForIE=function(){var a={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(c.indexOf(a[b].subString)!==-1)return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!==-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};if(a.init(),"Explorer"===a.browser);},b.readonly=!1,a.scrollbarWidth=0,b.showError=function(a){var c=f.open({templateUrl:"ErrorDlgDetails.html",controller:"ErrorDetailsCtrl",resolve:{error:function(){return a}}});c.result.then(function(a){b.error=a},function(){})},b.openRichTextDlg=function(a,b,c,d){f.open({templateUrl:"RichTextCtrl.html",controller:"RichTextCtrl",windowClass:"app-modal-window",backdrop:!0,keyboard:!0,backdropClick:!1,resolve:{editorTarget:function(){return{key:b,obj:a,disabled:d,title:c}}}})},b.openInputTextDlg=function(a,b,c,d){f.open({templateUrl:"InputTextCtrl.html",controller:"InputTextCtrl",backdrop:!0,keyboard:!0,windowClass:"app-modal-window",backdropClick:!1,resolve:{editorTarget:function(){return{key:b,obj:a,disabled:d,title:c}}}})},b.showError=function(a){var c=f.open({templateUrl:"ErrorDlgDetails.html",controller:"ErrorDetailsCtrl",resolve:{error:function(){return a}}});c.result.then(function(a){b.error=a},function(){})},b.cutString=function(a){return a.length>20&&(a=a.substring(0,20)+"..."),a},b.toHTML=function(a){return t.trustAsHtml(a)},b.selectTestingType=function(a){b.tabs[0]=!1,b.tabs[1]=!1,b.tabs[2]=!1,b.tabs[3]=!1,b.tabs[4]=!1,b.tabs[5]=!1,b.activeTab=a,b.tabs[b.activeTab]=!0,n.setActiveTab(b.activeTab)},b.downloadArtifact=function(a){var b=document.createElement("form");b.action="api/artifact/download",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()},b.tabs=new Array,b.compile=function(a){return $compile(a)},b.$on("$locationChangeSuccess",function(){b.setActive(d.path())}),b.openValidationResultInfo=function(){f.open({templateUrl:"ValidationResultInfoCtrl.html",windowClass:"profile-modal",controller:"ValidationResultInfoCtrl"})},b.openVersionChangeDlg=function(){m.clearAll(),b.vcModalInstance&&null!==b.vcModalInstance&&b.vcModalInstance.opened||(b.vcModalInstance=f.open({templateUrl:"VersionChanged.html",size:"lg",backdrop:"static",keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.vcModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openCriticalErrorDlg=function(a){m.clearAll(),b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"CriticalError.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return a}}}),b.errorModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openUnknownDomainDlg=function(a){m.clearAll(),f.open({templateUrl:"UnknownDomain.html",size:"lg",backdrop:!1,keyboard:"false",controller:"UnknownDomainCtrl",resolve:{domain:function(){return a}}}).result.then(function(a){"New"!==a?b.selectDomain(a):b.createDomain()},function(){})},b.openSessionExpiredDlg=function(){m.clearAll(),b.sessionExpiredModalInstance&&null!==b.sessionExpiredModalInstance&&b.sessionExpiredModalInstance.opened||(b.sessionExpiredModalInstance=f.open({templateUrl:"timedout-dialog.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.sessionExpiredModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.clearTemplate=function(){r.removeAll()},b.openErrorDlg=function(){d.path("/error")},b.pettyPrintType=function(a){return"TestStep"===a?"Test Step":"TestCase"===a?"Test Case":a},b.openInvalidReqDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"InvalidReqCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.openNotFoundDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"NotFoundCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.getDomain=function(){return b.domain},b.nav=function(a){d.path(a)},b.showSettings=function(){f.open({templateUrl:"SettingsCtrl.html",size:"lg",keyboard:"false",controller:"SettingsCtrl"})},a.init=function(){},a.getFullName=function(){return e.isAuthenticated()===!0?e.getFullName():""},b.isEditable=function(){return e.isAuthenticated()&&(e.isAdmin()||e.isSupervisor())&&null!=b.domain&&b.domain.owner===e.getUsername()},b.hasWriteAccess=function(){return e.isAuthenticated()&&(e.isAdmin()||null!=b.domain&&b.domain.owner===e.getUsername())},b.canPublish=function(){return b.hasWriteAccess()&&(e.isAdmin()||e.isPublisher())},b.createDomain=function(){var a=f.open({templateUrl:"views/domains/create.html",controller:"CreateDomainCtrl",size:"md",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{scope:function(){return"USER"}}});a.result.then(function(a){a?b.selectDomain(a.domain):null!==b.domain&&void 0!==b.domain||b.reloadPage()},function(){b.reloadPage()})},b.domainsByOwner={my:[],others:[]},b.initDomainsByOwner=function(){for(var a=0;a<b.appInfo.domains.length;a++)b.appInfo.domains[a].owner===e.getUsername()?b.domainsByOwner.my.push(b.appInfo.domains[a]):b.domainsByOwner.others.push(b.appInfo.domains[a]);
},p.get().then(function(c){b.loadingDomain=!0,b.appInfo=c,b.apiLink=b.appInfo.url+b.appInfo.apiDocsPath,httpHeaders.common.rsbVersion=c.rsbVersion;var d=m.get(m.APP_STATE_TOKEN);null!=d&&d!==c.rsbVersion&&b.openVersionChangeDlg(),m.set(m.APP_STATE_TOKEN,c.rsbVersion),void 0!=B&&null!=B&&m.set(m.APP_SELECTED_DOMAIN,B);var e=m.get(m.APP_SELECTED_DOMAIN),f=null;b.domain=null,b.appInfo.selectedDomain=null,b.domainsByOwner={my:[],others:[]},u.getDomains().then(function(c){if(b.appInfo.domains=c,null!=b.appInfo.domains){if(b.initDomainsByOwner(),1===b.appInfo.domains.length)f=b.appInfo.domains[0].domain;else if(null!=e){b.appInfo.domains=g("orderBy")(b.appInfo.domains,"position");for(var d=0;d<b.appInfo.domains.length;d++)if(b.appInfo.domains[d].domain===e){f=b.appInfo.domains[d].domain;break}}if(null==f){for(var d=0;d<b.appInfo.domains.length;d++)if("default"===b.appInfo.domains[d].domain){f=b.appInfo.domains[d].domain;break}null==f&&(b.appInfo.domains=g("orderBy")(b.appInfo.domains,"position"),f=b.appInfo.domains[0].domain)}b.clearDomainSession(),u.getDomainByKey(f).then(function(c){b.appInfo.selectedDomain=c.domain,m.set(m.APP_SELECTED_DOMAIN,c.domain),b.domain=c,b.loadingDomain=!1,w(function(){v.configs={},v.getDomainForms(b.domain.domain).then(function(a){b.transportSupported=null!=a&&a.length>0,b.transportSupported&&angular.forEach(a,function(a){var c=a.protocol;v.configs[c]||(v.configs[c]={}),v.configs[c].forms||(v.configs[c].forms={}),v.configs[c].forms=a,v.configs[c].error=null,v.configs[c].description=a.description,v.configs[c].key=a.protocol,v.getConfigData(b.domain.domain,c).then(function(a){v.configs[c].data=a,v.configs[c].open={ta:!0,sut:!1}},function(a){v.configs[c].error=a.data})})},function(b){a.error="No transport configs found."})},500)},function(a){b.loadingDomain=!0,b.openUnknownDomainDlg()})}else b.openCriticalErrorDlg("No Tool scope found. Please contact the administrator")},function(a){b.openCriticalErrorDlg("No Tool scope found. Please contact the administrator")})},function(a){b.loadingDomain=!0,b.appInfo={},b.openCriticalErrorDlg("Failed to fetch the server. Please try again")}),b.displayOwnership=function(a){return a.owner===e.getUsername()?"My Tool Scopes":"Others Tool Scopes"},b.orderOwnership=function(a){return a.owner===e.getUsername()?0:1}}]),angular.module("main").controller("LoginCtrl",["$scope","$modalInstance","user","$location",function(a,b,c,d){a.user=c,a.cancel=function(){b.dismiss("cancel")},a.login=function(){b.close(a.user)},a.cancelAndRedirect=function(a){b.dismiss("cancel"),d.url(a)},a.loginAndRedirect=function(c){b.close(a.user),d.url(c)},a.loginAndReload=function(){b.close(a.user),$route.reload()}}]),angular.module("main").controller("UnknownDomainCtrl",["$scope","$modalInstance","StorageService","$window","domain","userInfoService","$rootScope",function(a,b,c,d,e,f,g,h){a.error=e,a.domain=f,a.selectedDomain={domain:null},a.selectDomain=function(){c.set(c.APP_SELECTED_DOMAIN,a.selectedDomain.domain),b.close(a.selectedDomain.domain)},a.createNewDomain=function(){b.close("New")},a.loginReq=function(){a.$emit("event:loginRequired")}}]),angular.module("main").controller("RichTextCtrl",["$scope","$modalInstance","editorTarget",function(a,b,c){a.editorTarget=c,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(a.editorTarget)}}]),angular.module("main").controller("InputTextCtrl",["$scope","$modalInstance","editorTarget",function(a,b,c){a.editorTarget=c,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(a.editorTarget)}}]),angular.module("main").controller("ConfirmLogoutCtrl",["$scope","$modalInstance","$rootScope","$http",function(a,b,c,d){a.logout=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("main").controller("MessageWithHexadecimalDlgCtrl",["$scope","$modalInstance","original","MessageUtil",function(a,b,c,d){a.showHex=!0;var e=d.toHexadecimal(c);a.message=e,a.toggleHexadecimal=function(){a.showHex=!a.showHex,a.message=a.showHex?e:c},a.close=function(){b.dismiss("cancel")}}]),angular.module("main").controller("ValidationResultDetailsCtrl",["$scope","$modalInstance","selectedElement",function(a,b,c){a.selectedElement=c,a.ok=function(){b.close(a.selectedElement)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("main").controller("ConfirmDialogCtrl",["$scope","$modalInstance",function(a,b){a.confirm=function(){b.close(!0)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("transport").controller("TransportConfigListCtrl",["$scope","Transport","StorageService","$http","User","$timeout","$rootScope",function(a,b,c,d,e,f,g){a.transport=b,a.loading=!1,a.error=null,a.protocols=[],a.selectedProtocol=null,a.hasConfigs=function(){return!!a.transport.configs&&Object.getOwnPropertyNames(a.transport.configs).length>0},a.getProtocols=function(){return a.transport.configs?Object.getOwnPropertyNames(a.transport.configs):[]},a.getProtoDescription=function(b){try{return a.transport.configs[b].description}catch(a){}return null},a.getConfigs=function(){return a.transport.configs},a.initTransportConfigList=function(){a.error=null},a.selectProtocol=function(c){a.selectedProtocol=b.configs[c],a.$broadcast("load-transport-data",c)},a.isActiveProtocol=function(b){return null!=a.selectedProtocol&&a.selectedProtocol.key===b},a.toggleTransport=function(b){if(a.transport.disabled=b,c.set(c.TRANSPORT_DISABLED,b),!b){var d=a.getProtocols();null!=d&&1===d.length&&a.selectProtocol(d[0])}}}]),angular.module("transport").controller("InitiatorConfigCtrl",["$scope","$modalInstance","htmlForm","config","domain","protocol","$http","User",function(a,b,c,d,e,f,g,h){a.config=angular.copy(d),a.form=c,a.domain=e,a.protocol=f,a.initInitiatorConfig=function(b){a.config=angular.copy(b)},a.save=function(){var c=angular.fromJson({config:a.config,userId:h.info.id,type:"TA_INITIATOR",protocol:a.protocol});g.post("api/transport/config/save",c),b.close(a.config)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("transport").controller("TaInitiatorConfigCtrl",["$scope","$http","User","StorageService","Transport","$rootScope","Notification",function(a,b,c,d,e,f,g){a.transport=e,a.config=null,a.prevConfig=null,a.loading=!1,a.error=null,a.proto=null,a.saved=!0,a.dom=null,a.message=null,a.$on("load-transport-data",function(b,c){a.proto=c,a.dom=f.domain.domain,a.loadData()}),a.initTaInitiatorConfig=function(b,c){c&&null!=c&&b&&null!=b?(a.proto=c,a.dom=b,a.message=null,a.loadData()):a.error="Protocol or domain not defined."},a.loadData=function(){a.config=angular.copy(a.transport.configs[a.proto].data.taInitiator),a.prevConfig=angular.copy(a.config),a.message=null},a.save=function(){a.error=null,a.message=null;var d=angular.fromJson({config:a.config,userId:c.info.id,type:"TA_INITIATOR",protocol:a.proto,domain:a.dom});b.post("api/transport/config/save",d).then(function(b){a.transport.configs[a.proto].data.taInitiator=a.config,a.loadData(),a.saved=!0,g.success({message:"Configuration Information Saved !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3})},function(b){g.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4}),a.saved=!1,a.message=null})},a.reset=function(){a.config=angular.copy(a.prevConfig),a.saved=!0}}]),angular.module("transport").controller("SutInitiatorConfigCtrl",["$scope","$http","Transport","$rootScope","User","Notification",function(a,b,c,d,e,f){a.transport=c,a.config=null,a.loading=!1,a.saving=!1,a.error=null,a.proto=null,a.dom=null,a.$on("load-transport-data",function(b,c){a.proto=c,a.dom=d.domain.domain,a.loadData()}),a.initSutInitiatorConfig=function(b,c){c&&null!=c&&b&&null!=b?(a.proto=c,a.dom=b,a.loadData()):a.error="Protocol or domain not defined."},a.loadData=function(){a.config=a.transport.configs[a.proto].data.sutInitiator},a.save=function(){var c=a.config;if(c){a.saving=!0;var g=angular.copy(c);delete g.password,delete g.username;var h=angular.fromJson({config:a.config,userId:e.info.id,type:"SUT_INITIATOR",protocol:a.proto,domain:a.dom});b.post("api/transport/config/save",h).then(function(b){a.saving=!1,f.success({message:"Configuration Information Saved !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3})},function(b){a.saving=!1,a.error=b,f.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:d,delay:1e4})})}}}]),angular.module("transport").controller("CreateTransportConfigCtrl",["$scope","$modalInstance","scope","DomainsManager",function(a,b,c,d){}]),angular.module("cf").controller("CFEnvCtrl",["$scope","$window","$rootScope","CF","StorageService","$timeout","TestCaseService","TestStepService","$routeParams","$location","userInfoService","$modalStack","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l,m){if(a.testCase=null,a.token=i.x,a.nav=i.nav,a.setSubActive=function(b){c.setSubActive(b),"/cf_execution"===b?a.$broadcast("event:cf:initExecution"):"/cf_management"===b&&a.$broadcast("event:cf:initManagement")},void 0!==a.token)k.isAuthenticated()?f(function(){a.setSubActive("/cf_management"),a.$broadcast("cf:uploadToken",a.token)}):a.$broadcast("event:loginRequiredWithRedirect",j.url());else if("manage"===a.nav&&k.isAuthenticated())f(function(){a.setSubActive("/cf_management"),a.$broadcast("event:cf:manage",decodeURIComponent(i.scope))});else if("execution"===a.nav)e.set(e.CF_LOADED_TESTCASE_ID_KEY,decodeURIComponent(i.group)),a.setSubActive("/cf_execution");else{var n=e.get(e.ACTIVE_SUB_TAB_KEY);"/cf_management"===n?a.setSubActive("/cf_management"):f(function(){a.setSubActive("/cf_execution")})}}]),angular.module("cf").controller("CFTestExecutionCtrl",["$scope","$http","CF","$window","$modal","$filter","$rootScope","CFTestPlanExecutioner","$timeout","StorageService","TestCaseService","TestStepService","userInfoService","$routeParams",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.isInit=!1,a.cf=c,a.loading=!1,a.loadingTC=!1,a.error=null,a.testCases=[],a.testCase=null,a.tree={},a.tabs=new Array,a.error=null,a.collapsed=!1,a.selectedTP={id:null},a.selectedScope={key:null},a.allTestPlanScopes=[{key:"USER",name:"Private"},{key:"GLOBAL",name:"Public"}],a.testPlanScopes=[];var o=new k;a.setActiveTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.tabs[3]=!1,a.tabs[4]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0},a.getTestCaseDisplayName=function(a){return a.parentName+" - "+a.label},a.selectTP=function(){a.loadingTC=!1,a.errorTC=null,a.testCase=null,a.testCases=null,j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,""),a.selectedTP.id&&null!==a.selectedTP.id&&""!==a.selectedTP.id?(a.loadingTC=!0,h.getTestPlan(a.selectedTP.id).then(function(b){b.scope===a.selectedScope.key?(a.testCases=[b],o.buildCFTestCases(b),a.refreshTree(),j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,a.selectedTP.id),a.loadingTC=!1):(a.testCases=null,j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,""),a.loadingTC=!1)},function(b){a.errorTP="Sorry, Cannot load the test cases. Please try again"})):(a.testCases=null,j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,""),a.loadingTC=!1)},a.selectScope=function(){a.error=null,a.errorTP=null,a.testCases=null,a.testPlans=null,a.testCase=null,a.loadingTC=!1,a.loading=!1,a.selectedTP.id="",j.set(j.CF_SELECTED_TESTPLAN_SCOPE_KEY,a.selectedScope.key),a.selectedScope.key&&null!==a.selectedScope.key&&""!==a.selectedScope.key&&null!=g.domain&&null!=g.domain.domain?(a.loading=!0,h.getTestPlans(a.selectedScope.key,g.domain.domain).then(function(b){a.error=null,a.testPlans=f("orderBy")(b,"position");var c=null;if(a.testPlans.length>0){if(1===a.testPlans.length)c=a.testPlans[0].id;else{var d=j.get(j.CF_SELECTED_TESTPLAN_ID_KEY);if(c=void 0==d||null==d?"":d,null!=d&&void 0!=d&&""!=d){var e=q(d,a.testPlans);null!=e&&e.scope===a.selectedScope.key&&(c=e.id)}}if(null==c&&m.isAuthenticated()){var g=m.getLastTestPlanPersistenceId(),e=p(g,a.testPlans);null!=e&&e.scope===a.selectedScope.key&&(c=e.id)}null!=c&&(a.selectedTP.id=c.toString()),a.selectTP()}else a.loadingTC=!1;a.loading=!1},function(b){a.loadingTC=!1,a.loading=!1,a.error="Sorry, Cannot load the test plans. Please try again"})):(a.loading=!1,j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,""))};var p=function(a,b){if(null!=b&&void 0!=b)for(var c=0;c<b.length;c++)if(b[c].persistentId===a)return b[c];return null},q=function(a,b){if(null!=b&&void 0!=b)for(var c=0;c<b.length;c++)if(b[c].id===a)return b[c];return null};a.selectTestCase=function(b){a.loadingTC=!0,i(function(){var d=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=d&&l.clearRecords(d),b.testContext&&null!=b.testContext){c.testCase=b,a.testCase=c.testCase;var e=j.get(j.CF_LOADED_TESTCASE_ID_KEY);e!=b.id&&(j.set(j.CF_LOADED_TESTCASE_ID_KEY,b.id),j.remove(j.CF_EDITOR_CONTENT_KEY)),a.$broadcast("cf:testCaseLoaded",a.testCase),a.$broadcast("cf:profileLoaded",a.testCase.testContext.profile),a.$broadcast("cf:valueSetLibraryLoaded",a.testCase.testContext.vocabularyLibrary)}a.loadingTC=!1})},a.refreshTree=function(){i(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=null,c=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=c)for(var d=0;d<a.testCases.length;d++){var e=o.findOneById(c,a.testCases[d]);if(null!=e){b=e;break}}null==b&&null!=a.testCases&&a.testCases.length>=0&&(b=a.testCases[0]),null!=b&&a.selectNode(b.id,b.type),a.expandAll(),a.error=null}else a.error="Error: Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.initTesting=function(){a.isInit||(a.token=n.x,a.nav=n.nav,"execution"===a.nav&&j.set(j.CF_LOADED_TESTCASE_ID_KEY,decodeURIComponent(n.group)),a.isInit=!0,i(function(){if(m.isAuthenticated()){a.testPlanScopes=a.allTestPlanScopes;var b=j.get(j.CF_SELECTED_TESTPLAN_SCOPE_KEY);a.selectedScope.key=b&&null!=b?b:a.testPlanScopes[1].key}else a.testPlanScopes=[a.allTestPlanScopes[1]],a.selectedScope.key=a.allTestPlanScopes[1].key;a.selectScope()},100))},a.selectNode=function(b,c){i(function(){o.selectNodeByIdAndType(a.tree,b,c)},0)},a.openProfileInfo=function(){e.open({templateUrl:"CFProfileInfoCtrl.html",windowClass:"profile-modal",controller:"CFProfileInfoCtrl"})},a.isSelectable=function(a){return a.testContext&&null!=a.testContext},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()};var r=g.$on("event:logoutConfirmed",function(){a.initTesting()}),s=g.$on("event:loginConfirmed",function(){a.initTesting()});console.log("inint");var t=a.$on("event:cf:execute",function(b,c,d){console.log("Couou"),a.selectedScope.key=!c||null==c||"USER"!==c&&"GLOBAL"!==c?null!=a.testPlanScopes[0]?a.testPlanScopes[0].key:"GLOBAL":c,d&&null!=d&&(a.selectedTP.id=d,console.log(d),j.set(j.CF_SELECTED_TESTPLAN_ID_KEY,d)),a.selectScope()}),u=a.$on("event:cf:initExecution",function(){a.initTesting()});a.$on("$destroy",function(){u(),t(),r(),s();var a=j.get(j.CF_LOADED_TESTCASE_ID_KEY);null!=a&&l.clearRecords(a)})}]),angular.module("cf").controller("CFProfileInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CFValidatorCtrl",["$scope","$http","CF","$window","$timeout","$modal","NewValidationResult","$rootScope","ServiceDelegator","StorageService","TestStepService","MessageUtil","FileUpload","Notification","ReportService","userInfoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){a.cf=c,a.testCase=c.testCase,a.message=c.message,a.selectedMessage={},a.loading=!0,a.error=null,a.vError=null,a.vLoading=!0,a.mError=null,a.mLoading=!0,a.delimeters=[],a.counter=0,a.type="cf",a.loadRate=4e3,a.tokenPromise=null,a.editorInit=!1,a.nodelay=!1,a.resized=!1,a.selectedItem=null,a.activeTab=0,a.tError=null,a.tLoading=!1,a.hasNonPrintable=!1,a.dqaCodes=null!=j.get(j.DQA_OPTIONS_KEY)?angular.fromJson(j.get(j.DQA_OPTIONS_KEY)):[],a.showDQAOptions=function(){var b=f.open({templateUrl:"DQAConfig.html",controller:"DQAConfigCtrl",windowClass:"dq-modal",animation:!0,keyboard:!1,backdrop:!1});b.result.then(function(b){a.dqaCodes=b},function(){})},a.hasContent=function(){return""!=a.cf.message.content&&null!=a.cf.message.content},a.refreshEditor=function(){e(function(){a.editor&&a.editor.refresh()},1e3)},a.uploadMessage=function(b,c){a.f=b,m.uploadMessage(b,c).then(function(c){e(function(){b.result=c.data;var d=c.data,e=b.name;a.nodelay=!0;var f=angular.fromJson(d);a.cf.message.name=e,a.cf.editor.instance.doc.setValue(f.content),a.mError=null,a.execute(),n.success({message:"File "+e+" successfully uploaded!",templateUrl:"NotificationSuccessTemplate.html",scope:h,delay:3e4})})},function(b){a.mError=b.data})},a.loadMessage=function(){a.cf.testCase.testContext.message&&null!=a.cf.testCase.testContext.message&&(a.nodelay=!0,a.selectedMessage=a.cf.testCase.testContext.message,null!=a.selectedMessage&&null!=a.selectedMessage.content?a.editor.doc.setValue(a.selectedMessage.content):(a.editor.doc.setValue(""),a.cf.message.id=null,a.cf.message.name=""),a.execute())},a.setLoadRate=function(b){a.loadRate=b},a.initCodemirror=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("cfTextArea"),{lineNumbers:!0,fixedGutter:!0,theme:"elegant",readOnly:!1,showCursorWhenSelecting:!0,gutters:["CodeMirror-linenumbers","cm-edi-segment-name"]}),a.editor.setSize("100%",345),a.editor.on("keyup",function(){e(function(){var b=a.editor.doc.getValue();a.error=null,a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),c.message.name=null,""!==b.trim()?a.tokenPromise=e(function(){a.execute()},a.loadRate):a.execute()})}),a.editor.on("dblclick",function(b){e(function(){var b=i.getCursorService(a.testCase.testContext.format).getCoordinate(a.editor,a.cf.tree);b.start.index=b.start.index+1,b.end.index=b.end.index+1,a.cf.cursor.init(b,!0),i.getTreeService(a.testCase.testContext.format).selectNodeByIndex(a.cf.tree.root,c.cursor,c.message.content)})})},a.validateMessage=function(){try{if(a.vLoading=!0,a.vError=null,null!=a.cf.testCase&&""!==a.cf.message.content){var b=a.cf.testCase.testContext.id,c=a.cf.message.content,d=(a.cf.testCase.label,i.getMessageValidator(a.testCase.testContext.format).validate(b,c,null,"Free",a.cf.testCase.testContext.dqa===!0?a.dqaCodes:[],"1223"));d.then(function(b){a.vLoading=!1,a.loadValidationResult(b)},function(b){a.vLoading=!1,a.vError=b,a.loadValidationResult(null)})}else a.loadValidationResult(null),a.vLoading=!1,a.vError=null}catch(b){a.vLoading=!1,a.vError=b,a.loadValidationResult(null)}},a.loadValidationResult=function(b){e(function(){h.$emit("cf:validationResultLoaded",b,a.cf.testCase,"TestStep")})},a.select=function(b){if(void 0!=b&&null!=b.path&&b.line!=-1){var c=i.getTreeService(a.testCase.testContext.format).selectNodeByPath(a.cf.tree.root,b.line,b.path);a.cf.cursor.init(c.data,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)}},a.clearMessage=function(){a.nodelay=!0,a.mError=null,a.editor&&(a.editor.doc.setValue(""),a.execute())},a.saveMessage=function(){a.cf.message.download()},a.parseMessage=function(){try{if(null!=a.cf.testCase&&null!=a.cf.testCase.testContext&&""!=a.cf.message.content){a.tLoading=!0;var b=i.getMessageParser(a.testCase.testContext.format).parse(a.cf.testCase.testContext.id,a.cf.message.content);b.then(function(b){a.tLoading=!1,a.cf.tree.root.build_all(b.elements),i.updateEditorMode(a.editor,b.delimeters,a.cf.testCase.testContext.format),i.getEditorService(a.testCase.testContext.format).setEditor(a.editor),i.getTreeService(a.testCase.testContext.format).setEditor(a.editor)},function(b){a.tLoading=!1,a.tError=b})}else"function"==typeof a.cf.tree.root.build_all&&a.cf.tree.root.build_all([]),a.tError=null,a.tLoading=!1}catch(b){a.tLoading=!1,a.tError=b}},a.onNodeSelect=function(b){i.getTreeService(a.testCase.testContext.format).getEndIndex(b,a.cf.message.content),a.cf.cursor.init(b.data,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)},a.execute=function(){null!=a.cf.testCase&&(a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cf.message.content=a.editor.doc.getValue(),a.setHasNonPrintableCharacters(),j.set(j.CF_EDITOR_CONTENT_KEY,a.cf.message.content),a.validateMessage(),a.parseMessage(),a.refreshEditor())},a.removeDuplicates=function(){a.vLoading=!0,a.$broadcast("cf:removeDuplicates")},a.initValidation=function(){a.vLoading=!1,a.tLoading=!1,a.mLoading=!1,a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cf.savedReports=[],a.$on("cf:testCaseLoaded",function(b,c){if(a.testCase=c,null!=a.testCase){var d=null==j.get(j.CF_EDITOR_CONTENT_KEY)?"":j.get(j.CF_EDITOR_CONTENT_KEY);a.nodelay=!0,a.mError=null,e(function(){a.editor&&null!==a.editor||(a.initCodemirror(),a.refreshEditor()),a.cf.editor=i.getEditor(a.testCase.testContext.format),a.cf.editor.instance=a.editor,a.cf.cursor=i.getCursor(a.testCase.testContext.format),k.clearRecords(a.testCase.id),a.editor&&(a.editor.doc.setValue(d),a.execute())},500),p.isAuthenticated()&&h.isReportSavingSupported()&&e(function(){o.getAllTSByAccountIdAndDomainAndtestStepId(h.domain.domain,a.testCase.persistentId).then(function(b){null!==b?(a.cf.selectedSavedReport=null,a.cf.savedReports=b):(a.cf.savedReports=[],a.cf.selectedSavedReport=null)},function(b){a.cf.selectedSavedReport=null,a.cf.savedReports=[],a.loadingAll=!1,a.error="Sorry, Cannot load the reports. Please try again. \n DEBUG:"+b})},100)}}),h.$on("cf:updateSavedReports",function(b,c){p.isAuthenticated()&&h.isReportSavingSupported()&&e(function(){o.getAllTSByAccountIdAndDomainAndtestStepId(h.domain.domain,c.persistentId).then(function(b){null!==b?(a.cf.selectedSavedReport=null,a.cf.savedReports=b):(a.cf.savedReports=[],a.cf.selectedSavedReport=null)},function(b){a.cf.selectedSavedReport=null,a.cf.savedReports=[],a.loadingAll=!1,a.error="Sorry, Cannot load the reports. Please try again. \n DEBUG:"+b})},100)}),h.$on("cf:duplicatesRemoved",function(b,c){a.vLoading=!1})},a.expandAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.expand_all()},a.collapseAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.collapse_all()},a.expandMessageAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.expand_all()},a.collapseMessageAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.collapse_all()},a.setHasNonPrintableCharacters=function(){a.hasNonPrintable=l.hasNonPrintable(a.cf.message.content)},a.showMessageWithHexadecimal=function(){f.open({templateUrl:"MessageWithHexadecimal.html",controller:"MessageWithHexadecimalDlgCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{original:function(){return a.cf.message.content}}})}}]),angular.module("cf").controller("CFReportCtrl",["$scope","$sce","$http","CF",function(a,b,c,d){a.cf=d}]),angular.module("cf").controller("CFSavedReportCtrl",["$scope","$sce","$http","CF","ReportService","$modal",function(a,b,c,d,e,f){a.cf=d,a.selectReport=function(b){e.getUserTSReport(b.id).then(function(b){null!==b&&(a.cf.selectedSavedReport=b)},function(b){a.error="Sorry, Cannot load the report data. Please try again. \n DEBUG:"+b})},a.downloadAs=function(b){if(a.cf.selectedSavedReport)return e.downloadUserTestStepValidationReport(a.cf.selectedSavedReport.id,b)},a.deleteReport=function(b){var c=f.open({templateUrl:"confirmReportDelete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:!0,keyboard:!0});c.result.then(function(c){c&&e.deleteTSReport(b.id).then(function(c){var d=a.reports.indexOf(b);d>-1&&a.reports.splice(d,1),Notification.success({message:"Report deleted successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:$rootScope,delay:5e3})},function(a){Notification.error({message:"Report deletion failed! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:$rootScope,delay:1e4})})},function(a){})}}]),angular.module("cf").controller("CFVocabularyCtrl",["$scope","CF",function(a,b){a.cf=b}]),angular.module("cf").controller("CFProfileViewerCtrl",["$scope","CF","$rootScope",function(a,b,c){a.cf=b}]),angular.module("cf").controller("CFTestManagementCtrl",["$scope","$http","$window","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","FileUploader","Notification","userInfoService","CFTestPlanManager","modalService","$modalStack","$modal","$routeParams","$location",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.selectedScope={key:"USER"},a.groupScopes=[],a.allGroupScopes=[{key:"USER",name:"Private"},{key:"GLOBAL",name:"Public"}],a.uploaded=!1,a.testcase=null,a.existingTP={selected:null},a.selectedTP={id:null},a.categoryNodes=[],a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.existingTestPlans=null,a.tmpNewMessages=[],a.tmpOldMessages=[];new h;a.token=q.x,a.positions=function(a){for(var b=new Array(a.length),c=0;c<b.length;c++)b[c]=c+1;return b},a.filterMessages=function(a){return a=_.reject(a,function(a){return 1==a.removed}),a=d("orderBy")(a,"position")},a.$on("event:cf:manage",function(b,c){f(function(){e.isCfManagementSupported()&&l.isAuthenticated()&&(a.testcase=null,a.groupScopes=a.allGroupScopes,c!==a.allGroupScopes[1].key||l.isAdmin()||l.isSupervisor()||(c=a.allGroupScopes[0]),a.selectedScope={key:c},a.testcase=null,a.selectScope())},1e3)});var s=e.$on("event:logoutConfirmed",function(){a.initManagement()}),t=a.$on("event:cf:initManagement",function(){a.initManagement()}),u=e.$on("event:loginConfirmed",function(){a.initManagement()});a.$on("$destroy",function(){t(),s(),u()}),a.initManagement=function(){f(function(){e.isCfManagementSupported()&&l.isAuthenticated()&&e.hasWriteAccess()&&(l.isAdmin()||l.isSupervisor()?a.groupScopes=a.allGroupScopes:a.groupScopes=[a.allGroupScopes[0]],a.selectedScope.key=a.groupScopes[0].key,a.testcase=null,a.selectScope(),void 0!==a.token&&null!==a.token&&l.isAuthenticated()&&m.getTokenProfiles("hl7v2",a.token).then(function(b){if(0==b.success)void 0===b.debugError?(k.error({message:"The zip file you uploaded is not valid, please check and correct the error(s)",templateUrl:"NotificationErrorTemplate.html",scope:e,delay:1e4}),a.profileValidationErrors=angular.fromJson(b.profileErrors),a.valueSetValidationErrors=angular.fromJson(b.constraintsErrors),a.constraintValidationErrors=angular.fromJson(b.vsErrors)):k.error({message:"  "+b.message+"<br>"+b.debugError,templateUrl:"NotificationErrorTemplate.html",scope:e,delay:1e4});else{if(a.profileMessages=b.profiles,a.tmpNewMessages=a.filterMessages(a.profileMessages),a.tmpNewMessages.length>0)for(var c=0;c<a.tmpNewMessages.length;c++)a.tmpNewMessages[c].position=c+1;a.originalProfileMessages=angular.copy(a.profileMessages)}},function(a){}))},1e3)},a.selectScope=function(){a.existingTestPlans=null,a.selectedTP.id="",a.error=null,a.testcase=null,a.existingTP.selected=null,a.oldProfileMessages=null,a.testCases=null,g.set(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY,null),a.selectedScope.key&&null!==a.selectedScope.key&&""!==a.selectedScope.key&&null!=e.domain&&null!=e.domain.domain&&m.getTestPlans(a.selectedScope.key,e.domain.domain).then(function(b){a.existingTestPlans=b;var c=null;if(1===a.existingTestPlans.length&&(c=a.existingTestPlans[0].id),null==c){var d=g.get(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY);c=void 0==d||null==d?"":d}null!=c&&(a.selectedTP.id=c.toString(),a.selectTestPlan())},function(b){a.error="Sorry, Failed to load the profile groups. Please try again"})},a.selectTestPlan=function(){a.loadingTP=!1,a.errorTP=null,a.errorTC=null,a.error=null,a.selectedTP.id&&null!==a.selectedTP.id&&""!==a.selectedTP.id?(a.loadingTP=!0,m.getTestPlan(a.selectedTP.id).then(function(b){a.testCases=[b],a.testcase=null,a.generateTreeNodes(b),a.selectGroup(b),g.set(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY,a.selectedTP.id),a.loadingTP=!1},function(b){a.errorTP="Sorry, Cannot load the test cases. Please try again"})):(a.testCases=null,g.set(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY,""),a.loadingTP=!1)},a.loadOldProfileMessages=function(b,c){a.OldMessagesErrors=null,a.oldProfileMessages=null,a.originalOldProfileMessages=null,a.tmpOldMessages=null,null!=b&&("TestPlan"==c?m.getTestPlanProfiles(b).then(function(b){a.oldProfileMessages=b,a.tmpOldMessages=a.filterMessages(a.oldProfileMessages),a.originalOldProfileMessages=angular.copy(a.oldProfileMessages)},function(b){a.OldMessagesErrors="Sorry, Failed to load the existing profiles. Please try again"}):m.getTestStepGroupProfiles(b).then(function(b){a.oldProfileMessages=b,a.tmpOldMessages=a.filterMessages(a.oldProfileMessages),a.originalOldProfileMessages=angular.copy(a.oldProfileMessages)},function(b){a.OldMessagesErrors="Sorry, Failed to load the existing profiles. Please try again"}))},a.categorize=function(a){var b={};return null!=a&&a.length>0&&angular.forEach(a,function(a){void 0==b[a.category]&&(b[a.category]=[]),b[a.category].push(a)}),b},a.generateTreeNodes=function(b){if("TestObject"!==b.type){b.nav||(b.nav={});b.testStepGroups&&(b.children?angular.forEach(b.testStepGroups,function(c){b.children.push(c),c.nav={},c.parent={id:b.id,type:b.type},a.generateTreeNodes(c)}):(b.children=b.testStepGroups,angular.forEach(b.children,function(c){c.nav={},c.parent={id:b.id,type:b.type},a.generateTreeNodes(c)})),b.children=d("orderBy")(b.children,"position"),delete b.testStepGroups)}},a.deleteGroup=function(b){"TestPlan"===b.type?a.deleteTestPlan(b):a.deleteTestStepGroup(b)},a.deleteTestPlan=function(b){var c=p.open({templateUrl:"views/cf/manage/confirm-delete-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&m.deleteTestPlan(b).then(function(c){if("SUCCESS"===c.status){var d=a.findTestPlan(b.id,a.existingTestPlans),f=a.existingTestPlans.indexOf(d);f>-1&&a.existingTestPlans.splice(f,1),a.testCases=null,k.success({message:"Profile group deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),null!=a.testcase&&b.id===a.testcase.groupId&&"TestPlan"===a.testcase.type&&a.selectGroup(null),a.selectScope()}else a.error=c.message},function(b){a.error="Sorry, Cannot delete the profile group. Please try again"})},function(a){})},a.deleteTestStepGroup=function(b){var c=p.open({templateUrl:"views/cf/manage/confirm-delete-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&m.deleteTestStepGroup(b).then(function(c){"SUCCESS"===c.status?(k.success({message:"Profile group deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),null!=a.testcase&&b.id===a.testcase.groupId&&"TestStepGroup"===a.testcase.type&&a.selectGroup(null),a.selectTestPlan()):a.error=c.message},function(b){a.error="Sorry, Cannot delete the profile group. Please try again"})},function(a){})},a.findGroup=function(b,c,d){if(null!=b&&""!=b&&d&&null!=d&&d.length>0)for(var e=0;e<d.length;e++){if(d[e].id==b&&d[e].type===c)return d[e];var f=a.findGroup(b,c,d[e].children);if(null!=f)return f}return null},a.findTestPlan=function(a,b){if(null!=a&&""!=a&&b&&null!=b&&b.length>0)for(var c=0;c<b.length;c++)if(b[c].id===a)return b[c];return null},a.findGroupByPersistenceId=function(b){if(null!=b&&""!=b&&null!=a.existingTestPlans&&a.existingTestPlans.length>0)for(var c=0;c<a.existingTestPlans.length;c++)if(a.existingTestPlans[c].persistentId==b)return a.existingTestPlans[c];return null},a.selectGroup=function(b){null!=b&&(a.executionError=null,a.error=null,a.selectedNode=b,a.oldProfileMessages=[],a.originalOldProfileMessages=angular.copy(a.oldProfileMessages),a.testcase={},a.testcase.scope=a.selectedScope.key,a.testcase.name=b.name,a.testcase.description=b.description,a.testcase.groupId=b.id,a.testcase.persistentId=b.persistentId,a.testcase.type=b.type,a.testcase.position=b.position,a.loadOldProfileMessages(b.id,b.type))},a.createTestPlan=function(){var b=p.open({templateUrl:"views/cf/manage/createProfileGroup.html",controller:"CreateTestPlanCtrl",size:"lg",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{scope:function(){return a.selectedScope.key},domain:function(){return e.domain.domain},position:function(){
return a.existingTestPlans?a.existingTestPlans.length+1:1}}});b.result.then(function(b){b&&(a.existingTestPlans&&null!=a.existingTestPlans||(a.existingTestPlans=[]),g.set(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY,null),a.existingTestPlans.push(b),a.selectedTP.id=b.id,a.selectTestPlan())})},a.addNewTestStepGroup=function(b){var c=p.open({templateUrl:"views/cf/manage/createProfileGroup.html",controller:"CreateTestStepGroupCtrl",size:"lg",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{scope:function(){return a.selectedScope.key},domain:function(){return e.domain.domain},position:function(){return b.children?b.children.length+1:1},parentNode:function(){return b}}});c.result.then(function(c){if(c){var e={};e.id=c.id,e.persistentId=c.persistentId,e.name=c.name,e.position=c.position,e.description=c.description,e.scope=c.scope,e.type=c.type,e.nav={},e.parent={id:b.id,type:b.type},b.children||(b.children=[]),b.children.push(e),b.children=d("orderBy")(b.children,"position"),a.selectGroup(c)}})},a.afterSave=function(b){f(function(){if(null!=b&&b){var c=g.get(g.CF_MANAGE_SELECTED_TESTPLAN_ID_KEY);r.url("/cf?nav=execution&scope="+a.selectedScope.key+"&group="+c)}})},a.publishGroup=function(){a.error=null,a.executionError=[];var b=p.open({templateUrl:"views/cf/manage/confirm-publish-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.loading=!0,a.executionError=null,a.loading=!0,a.error=null,a.executionError=[],m.saveTestPlan("hl7v2",a.testcase.scope,a.token,a.getUpdatedProfiles(),a.getRemovedProfiles(),a.getAddedProfiles(),a.testcase).then(function(b){"SUCCESS"===b.status&&m.publishTestPlan(a.testcase.groupId).then(function(b){if("SUCCESS"===b.status){if(a.selectedNode=a.testCases[0],null!=a.selectedNode){a.selectedNode.name=a.testcase.name,a.selectedNode.description=a.testcase.description;var c=a.findTestPlan(a.selectedNode.id,a.existingTestPlans);c.name=a.testcase.name,c.description=a.testcase.description,k.success({message:"Profile Group saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.uploaded=!1,a.profileMessages=[],a.profileMessagesTmp=[],a.oldProfileMessages=[],a.tmpNewMessages=[],a.tmpOldMessages=[],a.originalOldProfileMessages=[],a.originalProfileMessages=[],a.selectedScope.key="GLOBAL",a.selectScope(),a.selectGroup(a.selectedNode),k.success({message:"Profile Group has been successfully published !",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.afterSave(a.token)}}else a.executionError.push(response.debugError);a.loading=!1},function(b){a.loading=!1,a.executionError.push(b.data)})},function(b){a.loading=!1,a.executionError.push(b.data)}))})},a.unPublishGroup=function(){a.error=null,a.executionError=[];var b=p.open({templateUrl:"views/cf/manage/confirm-unpublish-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.loading=!0,a.executionError=null,a.loading=!0,a.error=null,a.executionError=[],m.saveTestPlan("hl7v2","USER",a.token,a.getUpdatedProfiles(),a.getRemovedProfiles(),a.getAddedProfiles(),a.testcase).then(function(b){"SUCCESS"===b.status&&m.unPublishTestPlan(a.testcase.groupId).then(function(b){if("SUCCESS"===b.status){if(a.selectedNode=a.testCases[0],null!=a.selectedNode){a.selectedNode.name=a.testcase.name,a.selectedNode.description=a.testcase.description;var c=a.findTestPlan(a.selectedNode.id,a.existingTestPlans);c.name=a.testcase.name,c.description=a.testcase.description,k.success({message:"Profile Group saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.uploaded=!1,a.profileMessages=[],a.profileMessagesTmp=[],a.oldProfileMessages=[],a.tmpNewMessages=[],a.tmpOldMessages=[],a.originalOldProfileMessages=[],a.originalProfileMessages=[],a.selectedScope.key="USER",a.selectScope(),a.selectGroup(a.selectedNode),k.success({message:"Profile Group has been successfully published !",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.afterSave(a.token)}}else a.executionError.push(response.debugError);a.loading=!1},function(b){a.loading=!1,a.executionError.push(b.data)})},function(b){a.loading=!1,a.executionError.push(b.data)}))})},a.unPublishGroup=function(){a.error=null,a.executionError=[];var b=p.open({templateUrl:"views/cf/manage/confirm-unpublish-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.loading=!0,a.executionError=null,a.loading=!0,a.error=null,a.executionError=[],m.saveTestPlan("hl7v2","USER",a.token,a.getUpdatedProfiles(),a.getRemovedProfiles(),a.getAddedProfiles(),a.testcase).then(function(b){"SUCCESS"===b.status&&m.unPublishTestPlan(a.testcase.groupId).then(function(b){if("SUCCESS"===b.status){if(a.selectedNode=a.testCases[0],null!=a.selectedNode){a.selectedNode.name=a.testcase.name,a.selectedNode.description=a.testcase.description;var c=a.findTestPlan(a.selectedNode.id,a.existingTestPlans);c.name=a.testcase.name,c.description=a.testcase.description,k.success({message:"Profile Group saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.uploaded=!1,a.profileMessages=[],a.profileMessagesTmp=[],a.oldProfileMessages=[],a.tmpNewMessages=[],a.tmpOldMessages=[],a.originalOldProfileMessages=[],a.originalProfileMessages=[],a.selectedScope.key="USER",a.selectScope(),a.selectGroup(a.selectedNode),k.success({message:"Profile Group has been successfully published !",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.afterSave(a.token)}}else a.executionError.push(response.debugError);a.loading=!1},function(b){a.loading=!1,a.executionError.push(b.data)})},function(b){a.loading=!1,a.executionError.push(b.data)}))})},a.saveGroup=function(b){"TestPlan"===b.type?a.saveTestPlan():a.saveTestStepGroup()},a.saveTestPlan=function(){a.loading=!0,a.error=null,a.executionError=[],m.saveTestPlan("hl7v2",a.testcase.scope,a.token,a.getUpdatedProfiles(),a.getRemovedProfiles(),a.getAddedProfiles(),a.testcase).then(function(b){if("SUCCESS"===b.status){if(a.selectedNode=a.testCases[0],null!=a.selectedNode){a.selectedNode.name=a.testcase.name,a.selectedNode.description=a.testcase.description;var c=a.findTestPlan(a.selectedNode.id,a.existingTestPlans);c.name=a.testcase.name,c.description=a.testcase.description,k.success({message:"Profile Group saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.uploaded=!1,a.profileMessages=[],a.oldProfileMessages=[],a.tmpNewMessages=[],a.tmpOldMessages=[],a.originalOldProfileMessages=[],a.originalProfileMessages=[],a.selectGroup(a.selectedNode),a.afterSave(a.token),a.token=null}}else a.executionError=b.message;a.loading=!1},function(b){a.loading=!1,a.executionError=b.data})},a.saveTestStepGroup=function(){a.loading=!0,a.error=null,a.executionError=null,m.saveTestStepGroup("hl7v2",a.testcase.scope,a.token,a.getUpdatedProfiles(),a.getRemovedProfiles(),a.getAddedProfiles(),a.testcase).then(function(b){"SUCCESS"===b.status?(a.selectedNode=a.findGroup(a.testcase.groupId,"TestStepGroup",a.testCases),null!=a.selectedNode&&(a.selectedNode.name=a.testcase.name,a.selectedNode.description=a.testcase.description,k.success({message:"Profile Group saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.uploaded=!1,a.profileMessages=[],a.profileMessagesTmp=[],a.oldProfileMessages=[],a.tmpNewMessages=[],a.tmpOldMessages=[],a.originalOldProfileMessages=[],a.originalProfileMessages=[],a.selectGroup(a.selectedNode),a.afterSave(a.token),a.token=null)):a.executionError.push(response.debugError),a.loading=!1},function(b){a.loading=!1,a.executionError.push(b.data)})},a.reset=function(){a.error=null,a.executionError=[];var b=p.open({templateUrl:"views/cf/manage/confirm-reset-group.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){if(b){if(null!=a.selectedNode&&(a.testcase.name=a.selectedNode.name,a.testcase.description=a.selectedNode.description),a.profileMessages=angular.copy(a.originalProfileMessages),a.tmpNewMessages=a.filterMessages(a.profileMessages),a.tmpNewMessages.length>0)for(var c=0;c<a.tmpNewMessages.length;c++)a.tmpNewMessages[c].position=c+1;a.oldProfileMessages=angular.copy(a.originalOldProfileMessages),a.tmpOldMessages=a.filterMessages(a.oldProfileMessages),null!=a.token&&1==a.uploaded&&(m.deleteToken(a.token),a.token=null)}},function(a){})},a.cancelToken=function(){a.error=null,a.executionError=[],null!=a.token&&m.deleteToken(a.token).then(function(b){a.token=null,a.testcase=null,a.profileMessages=null,a.originalProfileMessages=null,a.originalOldProfileMessages=null,a.oldProfileMessages=null,a.existingTP={selected:null},a.selectedTP={id:null},a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.executionError=[],k.success({message:"Changes removed successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:5e3}),a.afterSave(a.token),a.token=null},function(b){a.executionError=b.data,a.executionError.push(b.data)})},a.deleteNewProfile=function(b){if(b.removed=!0,a.tmpNewMessages=a.filterMessages(a.profileMessages),a.tmpNewMessages.length>0)for(var c=0;c<a.tmpNewMessages.length;c++)a.tmpNewMessages[c].position=c+1},a.deleteOldProfile=function(b){b.removed=!0,a.tmpOldMessages=a.filterMessages(a.oldProfileMessages)},a.getAddedProfiles=function(){return _.reject(a.profileMessages,function(a){return 1==a.removed})},a.getRemovedProfiles=function(){return _.reject(a.oldProfileMessages,function(a){return void 0==a.removed||0==a.removed})},a.getUpdatedProfiles=function(){return _.reject(a.oldProfileMessages,function(a){return 1==a.removed})},a.treeOptions={beforeDrop:function(b){a.error=null;var c=b.source.nodeScope.$modelValue,d=b.dest.nodesScope.node,e=b.dest.index+1;return null!=c&&null!=d&&m.updateLocation(d,c,e).then(function(b){return"SUCCESS"==b.status||(a.error="Failed to change profile group "+c.name+" position ",!1)},function(b){return a.error="Failed to change profile group "+c.name+" position ",!1})},dropped:function(b){a.selectTestPlan()}},a.openUploadModal=function(){o.dismissAll("close");var b=p.open({templateUrl:"views/cf/manage/upload.html",controller:"UploadCtrl",resolve:{isValidationOnly:function(){return!1}},scope:a,controllerAs:"ctrl",windowClass:"upload-modal",backdrop:"static",keyboard:!1});a.close=function(a){b.close(a)},a.dismissModal=function(){b.dismiss("cancel")},b.result.then(function(b,c){if(null!=b.token){a.token=b.token,a.uploaded=!0,a.originalProfileMessages=[],a.profileMessages=[];for(var d=0;d<b.profiles.length;d++){var e=b.profiles[d];a.profileMessages.push(e)}if(a.tmpNewMessages=a.filterMessages(a.profileMessages),a.tmpNewMessages.length>0)for(var d=0;d<a.tmpNewMessages.length;d++)a.tmpNewMessages[d].position=d+1}},function(a){})},a.editExampleMessage=function(a){o.dismissAll("close");var b=p.open({templateUrl:"views/cf/manage/message.html",controller:"CFManageExampleMessageCtrl",controllerAs:"ctrl",windowClass:"upload-modal",backdrop:"static",keyboard:!1,resolve:{exampleMessage:function(){return a.exampleMessage}}});b.result.then(function(b){a.exampleMessage=b},function(a){})}}]),angular.module("cf").controller("CFManageExampleMessageCtrl",["$scope","$http","$window","$modal","$filter","$rootScope","$timeout","StorageService","FileUploader","Notification","$modalInstance","exampleMessage",function(a,b,c,d,e,f,g,h,i,j,k,l){a.exampleMessage=l,a.save=function(){k.close(a.exampleMessage)},a.cancel=function(){k.dismiss()}}]),angular.module("cf").controller("UploadCtrl",["$scope","$http","$window","$modal","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","FileUploader","Notification","userInfoService","CFTestPlanManager","isValidationOnly",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){k.FileSelect.prototype.isEmptyAfterSelection=function(){return!0},a.step=0,a.isValidationOnly=o,a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.profileUploadDone=!1,a.vsUploadDone=!1,a.constraintsUploadDone=!1,a.validationReport="",a.executionError=[];var p=a.profileUploader=new k({url:"api/cf/hl7v2/management/uploadProfiles",autoUpload:!1,filters:[{name:"xmlFilter",fn:function(a){return/\/(xml)$/.test(a.type)}}]}),q=a.vsUploader=new k({url:"api/cf/hl7v2/management/uploadValueSets",autoUpload:!1,filters:[{name:"xmlFilter",fn:function(a){return/\/(xml)$/.test(a.type)}}]}),r=a.constraintsUploader=new k({url:"api/cf/hl7v2/management/uploadConstraints",autoUpload:!1,filters:[{name:"xmlFilter",fn:function(a){return/\/(xml)$/.test(a.type)}}]}),s=a.zipUploader=new k({url:"api/cf/hl7v2/management/uploadZip",autoUpload:!0,filters:[{name:"zipFilter",fn:function(a){return/\/(zip)$/.test(a.type)}}]});p.onErrorItem=function(b,c,d,e){l.error({message:"There was an error while uploading "+b.file.name,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4}),a.step=1},q.onCompleteItem=function(b,c,d,e){0==c.success?(a.step=1,a.executionError.push(c.debugError)):(a.vsUploadDone=!0,a.vsUploadDone===!0&&a.profileUploadDone===!0&&a.constraintsUploadDone===!0&&a.validatefiles(a.token))},r.onCompleteItem=function(b,c,d,e){0==c.success?(a.step=1,a.executionError.push(c.debugError)):(a.constraintsUploadDone=!0,a.vsUploadDone===!0&&a.profileUploadDone===!0&&a.constraintsUploadDone===!0&&a.validatefiles(a.token))},p.onCompleteItem=function(b,c,d,e){0==c.success?(a.step=1,a.executionError.push(c.debugError)):(a.profileUploadDone=!0,a.vsUploadDone===!0&&a.profileUploadDone===!0&&a.constraintsUploadDone===!0&&a.validatefiles(a.token),a.profileMessagesTmp=c.profiles)},p.onBeforeUploadItem=function(b){a.profileValidationErrors=[],null==a.token&&(a.token=a.generateUUID()),b.formData.push({token:a.token}),b.formData.push({domain:f.domain.domain})},r.onBeforeUploadItem=function(b){a.constraintValidationErrors=[],null==a.token&&(a.token=a.generateUUID()),b.formData.push({token:a.token}),b.formData.push({domain:f.domain.domain})},q.onBeforeUploadItem=function(b){a.valueSetValidationErrors=[],null==a.token&&(a.token=a.generateUUID()),b.formData.push({token:a.token}),b.formData.push({domain:f.domain.domain})},s.onBeforeUploadItem=function(b){a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.validationReport="",a.executionError=[],b.formData.push({token:a.token}),b.formData.push({domain:f.domain.domain})},s.onCompleteItem=function(b,c,d,e){a.isValidationOnly?void 0!==c.report?(a.validationReport=c.report,a.step=1):void 0!==c.debugError&&(a.executionError.push(c.debugError),a.step=1):0==c.success?void 0===c.debugError?(l.error({message:"The zip file you uploaded is not valid, please check and correct the error(s) and try again",templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4}),a.validationReport=c.report,a.step=1):(a.executionError.push(c.debugError),a.step=1):(a.token=c.token,n.getTokenProfiles("hl7v2",a.token).then(function(b){0==b.success?void 0===b.debugError?(l.error({message:"The zip file you uploaded is not valid, please check and correct the error(s)",templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4}),a.step=1,a.validationReport=b.report):(l.error({message:"  "+b.message+"<br>"+b.debugError,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4}),a.step=1):(a.profileMessages=b.profiles,a.addSelectedTestCases())},function(a){}))},a.gotStep=function(b){a.step=b},p.onAfterAddingAll=function(a){p.queue.length>1&&p.removeFromQueue(0)},q.onAfterAddingAll=function(a){q.queue.length>1&&q.removeFromQueue(0)},r.onAfterAddingAll=function(a){r.queue.length>1&&r.removeFromQueue(0)},a.getSelectedTestcases=function(){return a.profileMessages},a.validatefiles=function(c){a.loading=!0,b.get("api/cf/hl7v2/management/validate",{params:{token:c}}).then(function(b){1==b.data.success?(a.profileMessages=a.profileMessagesTmp,a.profileMessagesTmp=[],a.addSelectedTestCases()):(a.profileMessagesTmp=[],a.step=1,b.data.report&&(a.validationReport=b.data.report),b.data.debugError&&a.executionError.push(b.data.debugError)),a.loading=!1},function(b){a.profileMessagesTmp=[],a.step=1,a.executionError.push(b.data.debugError),a.loading=!1})},a.upload=function(b){a.step=0,a.token=a.generateUUID(),a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.validationReport="",a.executionError=[],a.profileUploadDone=!1,a.vsUploadDone=!1,a.constraintsUploadDone=!1,q.uploadAll(),r.uploadAll(),p.uploadAll()},a.clear=function(b){a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.validationReport="",a.executionError=[],a.profileUploadDone=!1,a.vsUploadDone=!1,a.constraintsUploadDone=!1,p.clearQueue(),q.clearQueue(),r.clearQueue()},a.addSelectedTestCases=function(){a.loading=!0,l.success({message:"Profile Added !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3}),a.close({token:a.token,profiles:a.getSelectedTestcases()})},a.getTotalProgress=function(){var a=0,b=0;return p.queue.length>0&&(a++,b+=p.progress),q.queue.length>0&&(a++,b+=q.progress),r.queue.length>0&&(a++,b+=r.progress),b/a},a.generateUUID=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}}]),angular.module("cf").controller("UploadTokenCheckCtrl",["$scope","$http","CF","$window","$modal","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","userInfoService","Notification","modalService","$routeParams","$location",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){a.testcase={},a.profileValidationErrors=[],a.valueSetValidationErrors=[],a.constraintValidationErrors=[],a.profileCheckToggleStatus=!1,a.token=decodeURIComponent(o.x),a.auth=decodeURIComponent(o.y),a.domain=decodeURIComponent(o.d),void 0!==a.token&&void 0!==a.auth&&(l.isAuthenticated()?p.url("/addprofiles?x="+a.token+"&d="+a.domain):a.$emit("event:loginRequestWithAuth",a.auth,"/addprofiles?x="+a.token+"&d="+a.domain))}]),angular.module("cf").controller("CreateTestPlanCtrl",["$scope","$modalInstance","scope","CFTestPlanManager","position","domain",function(a,b,c,d,e,f){a.newGroup={name:null,description:null,scope:c,domain:f,position:e},a.error=null,a.loading=!1,a.submit=function(){null!=a.newGroup.name&&""!=a.newGroup.name&&null!=a.newGroup.domain&&""!=a.newGroup.domain&&(a.error=null,a.loading=!0,d.createTestPlan(a.newGroup).then(function(c){a.loading=!1,b.close(c)},function(b){a.loading=!1,a.error="Sorry, Cannot create a new profile group. Please try again"}))},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CreateTestStepGroupCtrl",["$scope","$modalInstance","scope","CFTestPlanManager","position","domain","parentNode",function(a,b,c,d,e,f,g){a.newGroup={name:null,description:null,scope:c,domain:f,position:e},a.error=null,a.loading=!1,a.submit=function(){null!=a.newGroup.name&&""!=a.newGroup.name&&null!=a.newGroup.domain&&""!=a.newGroup.domain&&(a.error=null,a.loading=!0,d.addChild(a.newGroup,g).then(function(c){a.loading=!1,b.close(c)},function(b){a.error="Sorry, Cannot create a new profile group. Please try again"}))},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("cb").controller("CBTestingCtrl",["$scope","$window","$rootScope","CB","StorageService","$timeout","TestCaseService","TestStepService","$routeParams","userInfoService",function(a,b,c,d,e,f,g,h,i,j){a.cb=d,a.testCase=null,a.token=i.x,a.domain=i.d,a.initTesting=function(){if(void 0!==i.scope&&void 0!==i.group)e.set(e.CB_SELECTED_TESTPLAN_ID_KEY,i.group),e.set(e.CB_SELECTED_TESTPLAN_SCOPE_KEY,i.scope),a.setSubActive("/cb_testcase",i.scope,i.group);else{var b=e.get(e.ACTIVE_SUB_TAB_KEY);(null==b||"/cb_execution"!==b&&"/cb_management"!==b)&&(b="/cb_testcase"),a.setSubActive(b)}a.$on("cb:testCaseLoaded",function(b,c,d){a.testCase=c})},a.setSubActive=function(b,d,e){c.setSubActive(b),f(function(){"/cb_execution"===b?(a.$broadcast("cb:refreshEditor"),c.$broadcast("event:refreshLoadedTestCase")):"/cb_testcase"===b?void 0!==d&&void 0!==e?a.$broadcast("event:cb:initTestCase",{scope:d,group:e}):a.$broadcast("event:cb:initTestCase"):"/cb_management"===b&&a.$broadcast("event:cb:initManagement")},500)}}]),angular.module("cb").controller("CBExecutionCtrl",["$scope","$window","$rootScope","CB","$modal","TestExecutionClock","Endpoint","TestExecutionService","$timeout","StorageService","User","ReportService","TestCaseDetailsService","$compile","Transport","$filter","SOAPEscaper","Notification",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.cb=d,a.targ="cb-executed-test-step",a.loading=!1,a.error=null,a.tabs=new Array,a.testCase=null,a.testStep=null,a.logger=d.logger,a.connecting=!1,a.transport=o,a.endpoint=null,a.hidePwd=!0,a.sent=null,a.received=null,a.configCollapsed=!0,a.counterMax=a.transport.getTimeout(),a.counter=0,a.listenerReady=!1,a.testStepListCollapsed=!1,a.warning=null,a.sutInititiatorForm="",a.taInititiatorForm="",a.user=k,a.domain=null,a.protocol=null!=j.get(j.TRANSPORT_PROTOCOL)&&void 0!=j.get(j.TRANSPORT_PROTOCOL)?j.get(j.TRANSPORT_PROTOCOL):null,a.exampleMessageEditor=null,a.testExecutionService=h,a.loadingExecution=!1,a.saveButtonText="Save Test Case Report",a.initExecution=function(){a.$on("cb:testCaseLoaded",function(b,c,d){a.executeTestCase(c,d)})};var s=["Incorrect message Received. Please check the log for more details","No Outbound message found","Invalid message Received. Please see console for more details.","Invalid message Sent. Please see console for more details."],t=function(a){return a},u=function(a){return a};a.setTestStepExecutionTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.tabs[3]=!1,a.tabs[4]=!1,a.tabs[5]=!1,a.tabs[6]=!1,a.tabs[7]=!1,a.tabs[8]=!1,a.tabs[9]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0,5===a.activeTab?a.buildExampleMessageEditor():6===a.activeTab?a.loadArtifactHtml("jurorDocument"):7===a.activeTab?a.loadArtifactHtml("messageContent"):8===a.activeTab?a.loadArtifactHtml("testDataSpecification"):9===a.activeTab&&a.loadArtifactHtml("testStory")},a.isTestCase=function(){return null!=d.testCase&&"TestCase"===d.testCase.type},a.getTestType=function(){return d.testCase.type},a.disabled=function(){return null==d.testCase||null===d.testCase.id},a.getTestType=function(){return null!=a.testCase?a.testCase.type:""},a.loadTestStepDetails=function(b){var c=a.targ+"-testStory",d=a.targ+"-jurorDocument",e=a.targ+"-messageContent",f=a.targ+"-testDataSpecification";m.removeHtml(f),m.removeHtml(e),m.removeHtml(d),m.removeHtml(c),a.$broadcast(c,b.testStory,b.name+"-TestStory"),a.$broadcast(d,b.jurorDocument,b.name+"-JurorDocument"),a.$broadcast(e,b.messageContent,b.name+"-MessageContent"),a.$broadcast(f,b.testDataSpecification,b.name+"-TestDataSpecification"),a.isManualStep(b)&&a.setTestStepExecutionTab(1)},a.loadTestStepExecutionPanel=function(b){a.exampleMessageEditor=null,a.detailsError=null;var d=b.testContext;if(d&&null!=d){a.setTestStepExecutionTab(0),a.$broadcast("cb:testStepLoaded",b),a.$broadcast("cb:profileLoaded",d.profile),a.$broadcast("cb:valueSetLibraryLoaded",d.vocabularyLibrary),m.removeHtml(a.targ+"-exampleMessage");var e=d.message&&d.message.content&&null!=d.message.content?d.message.content:null;null!=e&&a.$broadcast(a.targ+"-exampleMessage",e,d.format,b.name)}else{a.setTestStepExecutionTab(1);var f=h.getTestStepValidationReport(b);c.$emit("cbManual:updateTestStepValidationReport",void 0!=f&&null!=f?f.reportId:null,b,a.isTestCase())}a.targ+"-exampleMessage";m.details("cb","TestStep",b.id).then(function(c){b.testStory=c.testStory,b.jurorDocument=c.jurorDocument,b.testDataSpecification=c.testDataSpecification,b.messageContent=c.messageContent,a.loadTestStepDetails(b),a.detailsError=null},function(c){b.testStory=null,b.testPackage=null,b.jurorDocument=null,b.testDataSpecification=null,b.messageContent=null,a.loadTestStepDetails(b),a.detailsError="Sorry, could not load the test step details. Please try again"})},a.buildExampleMessageEditor=function(){var b=a.targ+"-exampleMessage";null!==a.exampleMessageEditor&&a.exampleMessageEditor||i(function(){a.exampleMessageEditor=m.buildExampleMessageEditor(b,a.testStep.testContext.message.content,a.exampleMessageEditor,a.testStep.testContext&&null!=a.testStep.testContext?a.testStep.testContext.format:null)},100),i(function(){$("#"+b)&&$("#"+b).scrollLeft()},1e3)},a.loadArtifactHtml=function(b){if(null!=a.testStep){var c=m.loadArtifactHtml(a.targ+"-"+b,a.testStep[b]);c&&null!=c&&n(c.contents())(a)}},a.resetTestCase=function(){null!=a.testCase&&(a.loadingExecution=!0,a.error=null,h.clear(a.testCase.id).then(function(b){a.loadingExecution=!1,a.error=null,null!=d.editor&&null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!1),j.remove(j.CB_LOADED_TESTSTEP_TYPE_KEY),j.remove(j.CB_LOADED_TESTSTEP_ID_KEY),a.executeTestCase(a.testCase)},function(b){a.loadingExecution=!1,a.error=null}))},a.selectProtocol=function(b){null!=b&&(a.protocol=b.protocol,j.set(j.TRANSPORT_PROTOCOL,a.protocol))},a.selectTestStep=function(b){if(d.testStep=b,a.testStep=b,null!=b)if(j.set(j.CB_LOADED_TESTSTEP_TYPE_KEY,a.testStep.type),j.set(j.CB_LOADED_TESTSTEP_ID_KEY,a.testStep.id),a.isManualStep(b))a.loadTestStepExecutionPanel(b);else if(void 0===a.testExecutionService.getTestStepExecutionMessage(b)&&"TA_INITIATOR"===b.testingType)if(a.transport.disabled||null==a.domain||null==a.protocol){var c=a.testExecutionService.getTestStepExecutionMessage(b);c=null!=c&&void 0!=c?c:b.testContext.message.content,a.testExecutionService.setTestStepExecutionMessage(b,c),a.loadTestStepExecutionPanel(b)}else{var e=a.transport.populateMessage(b.id,b.testContext.message.content,a.domain,a.protocol);e.then(function(c){a.testExecutionService.setTestStepExecutionMessage(b,c.outgoingMessage),a.loadTestStepExecutionPanel(b)},function(c){a.testExecutionService.setTestStepExecutionMessage(b,b.testContext.message.content),a.loadTestStepExecutionPanel(b)})}else void 0===a.testExecutionService.getTestStepExecutionMessage(b)&&"TA_RESPONDER"===b.testingType&&a.transport.disabled?(a.testExecutionService.setTestStepExecutionMessage(b,b.testContext.message.content),a.loadTestStepExecutionPanel(b)):a.loadTestStepExecutionPanel(b)},a.viewTestStepResult=function(b){d.testStep=b,a.testStep=b,null!=b&&(j.set(j.CB_LOADED_TESTSTEP_TYPE_KEY,a.testStep.type),j.set(j.CB_LOADED_TESTSTEP_ID_KEY,a.testStep.id),a.loadTestStepExecutionPanel(b))},a.clearTestStep=function(){d.testStep=null,a.testStep=null,a.$broadcast("cb:removeTestStep")},a.getTestStepExecutionStatus=function(b){return a.testExecutionService.getTestStepExecutionStatus(b)},a.getTestStepValidationResult=function(b){return a.testExecutionService.getTestStepValidationResult(b)},a.getTestStepValidationReport=function(b){return a.testExecutionService.getTestStepValidationReport(b)},a.getManualValidationStatusTitle=function(b){return a.testExecutionService.getManualValidationStatusTitle(b)},a.isManualStep=function(a){return null!=a&&("TA_MANUAL"===a.testingType||"SUT_MANUAL"===a.testingType)},a.isSutInitiator=function(a){return"SUT_INITIATOR"==a.testingType},a.isTaInitiator=function(a){return"TA_INITIATOR"==a.testingType},a.isTestStepCompleted=function(b){return"COMPLETE"===a.testExecutionService.getTestStepExecutionStatus(b)},a.completeStep=function(b){a.testExecutionService.setTestStepExecutionStatus(b,"COMPLETE")},a.completeManualStep=function(b){a.completeStep(b)},a.progressStep=function(b){a.testExecutionService.setTestStepExecutionStatus(b,"IN_PROGRESS")},a.goNext=function(b){null!=b&&b&&(a.isLastStep(b)?a.completeTestCase():a.executeTestStep(a.findNextStep(b.position)))},a.goBack=function(b){null!=b&&b&&(a.isFirstStep(b)||a.executeTestStep(a.findPreviousStep(b.position)))},a.executeTestStep=function(b){if(null!=b&&void 0!=b){if(a.testExecutionService.testStepCommentsChanged[b.id]=!1,h.setTestStepValidationReport(b,null),d.testStep=b,a.warning=null,(a.isManualStep(b)||"TA_RESPONDER"===b.testingType)&&a.completeStep(b),b.protocol=null,a.protocol=null,null!=b.protocols&&b.protocols&&b.protocols.length>0){var c=null!=j.get(j.TRANSPORT_PROTOCOL)&&void 0!=j.get(j.TRANSPORT_PROTOCOL)?j.get(j.TRANSPORT_PROTOCOL):null;c=null!=c&&b.protocols.indexOf(c)>0?c:null,c=null!=c?c:a.getDefaultProtocol(b),b.protocol=c,a.selectProtocol(b)}var e=a.transport.logs[b.id];a.logger.content=e&&null!=e?e:"",a.selectTestStep(b)}},a.getDefaultProtocol=function(a){if(null!=a.protocols&&a.protocols&&a.protocols.length>0){a.protocols=p("orderBy")(a.protocols,"position");for(var b=0;b<a.protocols.length;b++)if(void 0!=a.protocols[b].defaut&&a.protocols[b].defaut===!0)return a.protocols[b].value;return a.protocols[0].value}return null},a.completeTestCase=function(){j.remove(j.CB_LOADED_TESTSTEP_ID_KEY),a.testExecutionService.setTestCaseExecutionStatus(a.testCase,"COMPLETE"),null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!0),h.setTestCaseValidationResultFromTestSteps(a.testCase),a.clearTestStep(),a.selectTestStep(null)},a.isTestCaseCompleted=function(){return"COMPLETE"===a.testExecutionService.getTestCaseExecutionStatus(a.testCase)},a.shouldNextStep=function(b){return null!=a.testStep&&a.testStep===b&&!a.isTestCaseCompleted()&&!a.isLastStep(b)&&a.isTestStepCompleted(b)},a.isLastStep=function(b){return b&&null!=b&&null!=a.testCase&&a.testCase.children.length===b.position},a.isFirstStep=function(b){return b&&null!=b&&null!=a.testCase&&1===b.position},a.isTestCaseSuccessful=function(){var b=a.testExecutionService.getTestCaseValidationResult(a.testCase);return"PASSED"===b},a.isTestStepValidated=function(b){return void 0!=a.testExecutionService.getTestStepValidationResult(b)},a.isTestStepSuccessful=function(b){a.testExecutionService.getTestStepValidationResult(b);return!0},a.findNextStep=function(b){for(var c=0;c<a.testCase.children.length;c++)if(a.testCase.children[c].position===b+1)return a.testCase.children[c];return null},a.findPreviousStep=function(b){for(var c=0;c<a.testCase.children.length;c++)if(a.testCase.children[c].position===b-1)return a.testCase.children[c];return null},a.clearExecution=function(){null!=d.editor&&null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!1),a.loadingExecution=!0,a.error=null,h.clear(a.testCase).then(function(b){a.loadingExecution=!1,a.error=null},function(b){a.loadingExecution=!1,a.error=null})},a.setNextStepMessage=function(b){var c=a.findNextStep(a.testStep.position);null==c||a.isManualStep(c)||(a.completeStep(c),a.testExecutionService.setTestStepExecutionMessage(c,b))},a.log=function(b){a.logger.log(b)},a.isValidConfig=function(){},a.outboundMessage=function(){return null!=a.testStep?a.testStep.testContext.message.content:null},a.hasUserContent=function(){return d.editor&&null!=d.editor&&null!=d.editor.instance.doc.getValue()&&""!=d.editor.instance.doc.getValue()},a.hasRequestContent=function(){return null!=a.outboundMessage()&&""!=a.outboundMessage()},a.saveTransportLog=function(){i(function(){a.transport.saveTransportLog(a.testStep.id,a.logger.content,a.domain,a.protocol)})},a.send=function(){a.connecting=!0,a.openConsole(a.testStep),a.logger.clear(),a.progressStep(a.testStep),a.error=null,a.hasUserContent()?(a.received="",a.logger.log("Sending outbound Message. Please wait..."),a.transport.send(a.testStep.id,d.editor.instance.doc.getValue(),a.domain,a.protocol).then(function(b){var c=b.incoming,d=b.outgoing;if(a.logger.log("Outbound Message  -------------------------------------->"),null!=d&&""!=d)if(a.logger.log(d),a.logger.log("Inbound Message  <--------------------------------------"),null!=c&&""!=c)try{a.completeStep(a.testStep);var e=u(c);a.logger.log(c);var f=a.findNextStep(a.testStep.position);null!=f&&"SUT_RESPONDER"===f.testingType&&a.setNextStepMessage(e)}catch(b){a.error=s[0],a.logger.log("An error occured: "+a.error)}else a.logger.log("No Inbound message received");else a.logger.log("No outbound message sent");
a.connecting=!1,a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction completed"),a.saveTransportLog()},function(b){a.connecting=!1,a.error=b.data,a.logger.log("Error: "+b.data),a.received="",a.completeStep(a.testStep),a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction stopped"),a.saveTransportLog()})):(a.error="No message to send",a.connecting=!1,a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction completed"),a.saveTransportLog())},a.viewConsole=function(b){a.consoleDlg&&null!==a.consoleDlg&&a.consoleDlg.opened&&a.consoleDlg.dismiss("cancel"),a.consoleDlg=e.open({templateUrl:"PastTestStepConsole.html",controller:"PastTestStepConsoleCtrl",windowClass:"console-modal",size:"sm",animation:!0,keyboard:!0,backdrop:!0,resolve:{log:function(){return a.transport.logs[b.id]},title:function(){return b.name}}})},a.openConsole=function(b){a.consoleDlg&&null!==a.consoleDlg&&a.consoleDlg.opened&&a.consoleDlg.dismiss("cancel"),a.consoleDlg=e.open({templateUrl:"CurrentTestStepConsole.html",controller:"CurrentTestStepConsoleCtrl",windowClass:"console-modal",size:"lg",animation:!0,keyboard:!0,backdrop:!0,resolve:{logger:function(){return a.logger},title:function(){return b.name}}})},a.stopListener=function(){a.connecting=!1,a.counter=a.counterMax,f.stop(),a.logger.log("Stopping listener. Please wait...."),a.transport.stopListener(a.testStep.id,a.domain,a.protocol).then(function(b){a.logger.log("Listener stopped."),a.transport.logs[a.testStep.id]=a.logger.content,a.saveTransportLog()},function(b){a.saveTransportLog()})},a.updateTestStepValidationReport=function(b){if(a.saveButtonDisabled=!1,a.saveButtonText="Save Test Case Report",j.set("testStepValidationResults",angular.toJson(h.testStepValidationResults)),j.set("testStepComments",angular.toJson(h.testStepComments)),null===a.testStep||b.id!==a.testStep.id)h.updateTestStepValidationReport(b);else{var d=b.testContext&&null!=b.testContext?"cbValidation":"cbManual",e=h.getTestStepValidationReport(b);c.$emit(d+":updateTestStepValidationReport",e&&null!=e?e:null,b,a.getTestType())}},a.abortListening=function(){a.testExecutionService.deleteTestStepExecutionStatus(a.testStep),a.stopListener()},a.completeListening=function(){a.completeStep(a.testStep),a.stopListener()},a.setTimeout=function(b){a.transport.setTimeout(b),a.counterMax=b},a.startListener=function(){a.openConsole(a.testStep);var b=a.findNextStep(a.testStep.position);if(null!=b){var c=b.testContext.message.id;a.configCollapsed=!1,a.logger.clear(),a.counter=0,a.connecting=!0,a.error=null,a.warning=null,a.progressStep(a.testStep),a.logger.log("Starting listener. Please wait..."),a.transport.startListener(a.testStep.id,c,a.domain,a.protocol).then(function(b){if(b){a.logger.log("Listener started.");var d=function(){var b=parseInt(a.counterMax)-parseInt(a.counter);b%20===0&&a.logger.log("Waiting for Inbound Message....Remaining time:"+b+"s"),++a.counter;var d=null;try{d=a.transport.configs[a.protocol].data.sutInitiator}catch(a){d=null}a.transport.searchTransaction(a.testStep.id,d,c,a.domain,a.protocol).then(function(b){if(null!=b){var c=b.incoming,d=b.outgoing;if(a.logger.log("Inbound message received <-------------------------------------- "),null!=c&&""!=c)try{var e=t(c);a.log(e),a.testExecutionService.setTestStepExecutionMessage(a.testStep,e),a.$broadcast("cb:loadEditorContent",e)}catch(b){a.error=s[2],a.logger.log("Incorrect Inbound message type")}else a.logger.log("Incoming message received is empty");if(a.logger.log("Outbound message sent --------------------------------------> "),null!=d&&""!=d)try{var f=u(d);a.log(f);var g=a.findNextStep(a.testStep.position);null!=g&&"TA_RESPONDER"===g.testingType&&a.setNextStepMessage(f)}catch(b){a.error=s[3],a.logger.log("Incorrect outgoing message type")}else a.logger.log("Outbound message sent is empty");a.completeListening()}else a.counter>=a.counterMax&&(a.warning="We did not receive any incoming message after 2 min. <p>Possible cause (1): You are using wrong credentials. Please check the credentials in your outbound message against those created for your system.</p>  <p>Possible cause (2):The endpoint address may be incorrect.   Verify that you are using the correct endpoint address that is displayed by the tool.</p>",a.abortListening())},function(b){a.error=b,a.log("Error: "+b),a.received="",a.sent="",a.abortListening()})};f.start(d)}else a.logger.log("Failed to start listener"),a.logger.log("Transaction stopped"),a.connecting=!1,a.error="Failed to start the listener. Please contact the administrator.",f.stop()},function(b){a.connecting=!1,a.counter=a.counterMax,a.error="Failed to start the listener. Error: "+b,a.logger.log(a.error),a.logger.log("Transaction stopped"),f.stop()})}},a.downloadJurorDoc=function(a,b){var c=$("#"+a).html();if(c&&""!=c){var d=document.createElement("form");d.action="api/artifact/generateJurorDoc/pdf",d.method="POST",d.target="_target";var e=document.createElement("textarea");e.name="html",e.value=c,d.appendChild(e);var f=document.createElement("input");f.name="type",f.value="JurorDocument",d.style.display="none",d.appendChild(f);var g=document.createElement("input");g.name="type",g.value=b,d.style.display="none",d.appendChild(g),document.body.appendChild(d),d.submit()}},a.downloadTestArtifact=function(b){if(null!=a.testCase){var c=document.createElement("form");c.action="api/artifact/download",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="path",d.value=b,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()}},a.executeTestCase=function(b,e){if(null!=b){if(a.loading=!0,h.init(),d.testStep=null,a.testStep=null,a.setTestStepExecutionTab(0),e=e&&null!=e?e:"/cb_execution",c.setSubActive(e),"/cb_execution"===e&&a.$broadcast("cb:refreshEditor"),a.logger.clear(),a.error=null,a.warning=null,a.connecting=!1,a.domain=b.domain,d.testCase=b,a.transport.logs={},a.transport.transactions=[],a.testCase=b,f.stop(),null!=d.editor&&null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!1),"TestCase"===b.type){var g=j.get(j.CB_LOADED_TESTSTEP_ID_KEY),i=a.findTestStepById(g);i=null!=i?i:a.testCase.children[0],a.executeTestStep(i)}else"TestStep"===b.type&&a.executeTestStep(b);a.loading=!1}},a.findTestStepById=function(b){if(null!=b&&void 0!=b)for(var c=0;c<a.testCase.children.length;c++)if(a.testCase.children[c].id===b)return a.testCase.children[c];return null},a.exportAs=function(b){if(null!=a.testCase){var c=h.getTestCaseValidationResult(a.testCase);c=void 0!=c?c:null;var d=h.getTestCaseComments(a.testCase);d=void 0!=d?d:null,l.downloadTestCaseReports(a.testCase.id,b,c,d,a.testCase.nav.testPlan,a.testCase.nav.testGroup)}},a.isReportSavingSupported=function(){return c.isReportSavingSupported()},a.savetestcasereport=function(){return l.saveTestCaseValidationReport(a.testCase.id)},a.downloadReportAs=function(b,c){var d=a.getTestStepValidationReport(c);if(null!=d&&void 0!=d)return l.downloadTestStepValidationReport(d,b)},a.savetestcasereport=function(){if(null!=a.testCase){a.saveButtonDisabled=!0,a.saveButtonText="Saving...";var b=h.getTestCaseValidationResult(a.testCase);b=void 0!=b?b:null;var d=h.getTestCaseComments(a.testCase);d=void 0!=d?d:null;for(var e=[],f=0;f<a.testCase.children.length;f++)e.push(h.getTestStepValidationReport(a.testCase.children[f]));l.saveTestCaseValidationReport(a.testCase.id,e,b,d).then(function(b){r.success({message:"Report saved successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:c,delay:5e3}),a.saveButtonText="Report Saved!"},function(b){r.error({message:"Report could not be saved! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:c,delay:1e4}),a.saveButtonDisabled=!1,a.saveButtonText="Save Test Case Report"})}},a.toggleTransport=function(b){a.transport.disabled=b,j.set(j.TRANSPORT_DISABLED,b),null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!b)},a.editTestStepComment=function(b){a.testExecutionService.testStepComments[b.id]||(a.testExecutionService.testStepComments[b.id]=""),a.testExecutionService.testStepCommentsChanged[b.id]=!0,a.testExecutionService.testStepCommentsChanges[b.id]=a.testExecutionService.testStepComments[b.id]},a.deleteTestStepComment=function(b){a.testExecutionService.testStepComments[b.id]=null,a.testExecutionService.testStepCommentsChanges[b.id]=null,a.testExecutionService.testStepCommentsChanged[b.id]=!1,a.saveTestStepComment(b)},a.resetTestStepComment=function(b){a.testExecutionService.testStepCommentsChanged[b.id]=!1,a.testExecutionService.testStepCommentsChanges[b.id]=null},a.saveTestStepComment=function(b){a.testExecutionService.testStepCommentsChanged[b.id]=!1,a.testExecutionService.testStepComments[b.id]=a.testExecutionService.testStepCommentsChanges[b.id],a.updateTestStepValidationReport(b),a.testExecutionService.testStepCommentsChanges[b.id]=null},a.editTestCaseComment=function(b){a.testExecutionService.testCaseComments[b.id]||(a.testExecutionService.testCaseComments[b.id]=""),a.testExecutionService.testCaseCommentsChanged[b.id]=!0,a.testExecutionService.testCaseCommentsChanges[b.id]=a.testExecutionService.testCaseComments[b.id]},a.deleteTestCaseComment=function(b){a.testExecutionService.testCaseComments[b.id]=null,a.testExecutionService.testCaseCommentsChanges[b.id]=null,a.testExecutionService.testCaseCommentsChanged[b.id]=!1,a.saveTestCaseComment(b)},a.resetTestCaseComment=function(b){a.testExecutionService.testCaseCommentsChanged[b.id]=!1,a.testExecutionService.testCaseCommentsChanges[b.id]=null},a.saveTestCaseComment=function(b){a.testExecutionService.testCaseCommentsChanged[b.id]=!1,a.testExecutionService.testCaseComments[b.id]=a.testExecutionService.testCaseCommentsChanges[b.id],a.testExecutionService.testCaseCommentsChanges[b.id]=null}}]),angular.module("cb").controller("CBTestCaseCtrl",["$scope","$window","$filter","$rootScope","CB","$timeout","CBTestPlanListLoader","$sce","StorageService","TestCaseService","TestStepService","TestExecutionService","CBTestPlanLoader","User","userInfoService","ReportService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){a.cb=e,a.error=null,a.selectedTestCase=e.selectedTestCase,a.testCase=e.testCase,a.selectedTP={id:null},a.preSelectedTP={id:null},a.selectedScope={key:null},a.testPlanScopes=[],a.allTestPlanScopes=[{key:"USER",name:"Private"},{key:"GLOBAL",name:"Public"}],a.testCases=[],a.testPlans=[],a.tree={},a.loading=!0,a.loadingTP=!1,a.loadingTC=!1,a.loadingTPs=!1,a.collapsed=!1;var q=new j;a.initTestCase=function(){if(a.error=null,a.loading=!0,a.testCases=null,o.isAuthenticated()){a.testPlanScopes=a.allTestPlanScopes;var b=i.get(i.CB_SELECTED_TESTPLAN_SCOPE_KEY);a.selectedScope.key=b&&null!=b?b:a.allTestPlanScopes[1].key}else a.testPlanScopes=[a.allTestPlanScopes[1]],a.selectedScope.key=a.allTestPlanScopes[1].key;a.selectScope()},a.$on("event:cb:initTestCase",function(b,c){a.preSelectedTP.id=null,void 0!==c&&void 0!==c.scope&&void 0!==c.group&&(a.preSelectedTP.id=i.get(i.CB_SELECTED_TESTPLAN_ID_KEY)),a.initTestCase()}),d.$on("event:logoutConfirmed",function(){a.initTestCase()}),d.$on("event:loginConfirmed",function(){a.initTestCase()});var r=function(a,b){for(var c=0;c<b.length;c++)if(b[c].persistentId===a)return b[c];return null};a.selectTP=function(){if(a.loadingTP=!0,a.errorTP=null,a.selectedTestCase=null,a.selectedTP.id&&null!==a.selectedTP.id&&""!==a.selectedTP.id){var b=new m(a.selectedTP.id,d.domain);b.then(function(b){a.testCases=[b],q.buildTree(b),a.refreshTree(),i.set(i.CB_SELECTED_TESTPLAN_ID_KEY,a.selectedTP.id),a.loadingTP=!1},function(b){a.loadingTP=!1,a.errorTP="Sorry, Cannot load the test cases. Please try again"})}else a.testCases=null,i.set(i.CB_SELECTED_TESTPLAN_ID_KEY,""),a.loadingTP=!1},a.selectScope=function(){if(a.errorTP=null,a.selectedTestCase=null,a.testPlans=null,a.testCases=null,a.errorTP=null,a.loadingTP=!1,i.set(i.CB_SELECTED_TESTPLAN_SCOPE_KEY,a.selectedScope.key),a.selectedScope.key&&null!==a.selectedScope.key&&""!==a.selectedScope.key){if(null!=d.domain&&null!=d.domain.domain){a.loadingTP=!0;var b=new g(a.selectedScope.key,d.domain.domain);b.then(function(b){a.error=null,a.testPlans=c("orderBy")(b,"position");var d=null;if(a.testPlans.length>0){if(1===a.testPlans.length)d=a.testPlans[0].id;else if(null!==a.preSelectedTP.id)d=a.preSelectedTP.id;else if(null!==i.get(i.CB_SELECTED_TESTPLAN_ID_KEY)){var e=i.get(i.CB_SELECTED_TESTPLAN_ID_KEY);d=void 0==e||null==e?a.testPlans[0].id:e}else if(o.isAuthenticated()){var f=o.getLastTestPlanPersistenceId(),g=r(f,a.testPlans);d=null!=g?g.id:a.testPlans[0].id}else d=a.testPlans[0].id;a.selectedTP.id=d.toString(),a.selectTP()}else a.loadingTP=!1;a.loading=!1},function(b){a.loadingTP=!1,a.loading=!1,a.error="Sorry, Cannot load the test plans. Please try again"})}}else i.set(i.CB_SELECTED_TESTPLAN_ID_KEY,"")},a.refreshTree=function(){f(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=a.tree.get_first_branch();null!=b&&b&&a.tree.expand_branch(b);var c=null,d=i.get(i.CB_SELECTED_TESTCASE_ID_KEY),e=i.get(i.CB_SELECTED_TESTCASE_TYPE_KEY);if(null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var g=q.findOneByIdAndType(d,e,a.testCases[f]);if(null!=g){c=g;break}}null!=c&&a.selectNode(d,e)}if(c=null,d=i.get(i.CB_LOADED_TESTCASE_ID_KEY),e=i.get(i.CB_LOADED_TESTCASE_TYPE_KEY),null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var g=q.findOneByIdAndType(d,e,a.testCases[f]);if(null!=g){c=g;break}}if(null!=c){var h=i.get(i.ACTIVE_SUB_TAB_KEY);a.loadTestCase(c,h,!1)}}}else a.error="Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.refreshLoadedTestCase=function(){var b=null,c=i.get(i.CB_LOADED_TESTCASE_ID_KEY),d=i.get(i.CB_LOADED_TESTCASE_TYPE_KEY);if(null!=c&&null!=d){for(var e=0;e<a.testCases.length;e++){var f=q.findOneByIdAndType(c,d,a.testCases[e]);if(null!=f){b=f;break}}if(null!=b){var g=i.get(i.ACTIVE_SUB_TAB_KEY);a.loadTestCase(b,g,!1)}}},a.isSelectable=function(a){return!0},a.selectTestCase=function(b){a.loadingTC=!0,a.selectedTestCase=b,a.cb.selectedTestCase=b,i.set(i.CB_SELECTED_TESTCASE_ID_KEY,b.id),i.set(i.CB_SELECTED_TESTCASE_TYPE_KEY,b.type),f(function(){a.$broadcast("cb:testCaseSelected",a.selectedTestCase),a.loadingTC=!1})},a.selectNode=function(b,c){f(function(){q.selectNodeByIdAndType(a.tree,b,c)},0)},a.loadTestCase=function(a,b,c){if(void 0===c||c===!0){i.remove(i.CB_EDITOR_CONTENT_KEY);var g=i.get(i.CB_LOADED_TESTCASE_ID_KEY),h=i.get(i.CB_LOADED_TESTCASE_TYPE_KEY);null!=g&&void 0!=g&&("TestCase"===h?l.clearTestCase(g):"TestStep"===h&&l.clearTestStep(g),i.remove(i.CB_LOADED_TESTCASE_ID_KEY),i.remove(i.CB_LOADED_TESTCASE_TYPE_KEY)),g=i.get(i.CB_LOADED_TESTSTEP_ID_KEY),h=i.get(i.CB_LOADED_TESTSTEP_TYPE_KEY),null!=g&&void 0!=g&&(l.clearTestStep(g),i.remove(i.CB_LOADED_TESTCASE_ID_KEY),i.remove(i.CB_LOADED_TESTCASE_TYPE_KEY))}i.set(i.CB_LOADED_TESTCASE_ID_KEY,a.id),i.set(i.CB_LOADED_TESTCASE_TYPE_KEY,a.type),"TestStep"===a.type&&d.$emit("cb:updateSavedReports",a),f(function(){d.$broadcast("cb:testCaseLoaded",a,b)}),null!=e.editor&&null!=e.editor.instance&&e.editor.instance.setOption("readOnly",!1)},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()},d.$on("event:logoutConfirmed",function(){a.initTestCase()}),d.$on("event:loginConfirmed",function(){a.initTestCase()}),d.$on("event:refreshLoadedTestCase",function(){a.refreshLoadedTestCase()}),d.$on("cb:updateSavedReports",function(b,c){o.isAuthenticated()&&d.isReportSavingSupported()&&f(function(){p.getAllIndependantTSByAccountIdAndDomainAndtestStepId(d.domain.domain,c.persistentId).then(function(b){null!==b?(a.cb.selectedSavedReport=null,a.cb.savedReports=b):(a.cb.savedReports=[],a.cb.selectedSavedReport=null)},function(b){a.cb.selectedSavedReport=null,a.cb.savedReports=[],a.loadingAll=!1,a.error="Sorry, Cannot load the reports. Please try again. \n DEBUG:"+b})},100)})}]),angular.module("cb").controller("CBSavedReportCtrl",["$scope","$sce","$http","CB","ReportService","$modal",function(a,b,c,d,e,f){a.cb=d,a.selectReport=function(b){e.getUserTSReport(b.id).then(function(b){null!==b&&(a.cb.selectedSavedReport=b)},function(b){a.error="Sorry, Cannot load the report data. Please try again. \n DEBUG:"+b})},a.downloadAs=function(b){if(a.cb.selectedSavedReport)return e.downloadUserTestStepValidationReport(a.cb.selectedSavedReport.id,b)},a.deleteReport=function(b){var c=f.open({templateUrl:"confirmReportDelete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:!0,keyboard:!0});c.result.then(function(c){c&&e.deleteTSReport(b.id).then(function(c){var d=a.reports.indexOf(b);d>-1&&a.reports.splice(d,1),Notification.success({message:"Report deleted successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:$rootScope,delay:5e3})},function(a){Notification.error({message:"Report deletion failed! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:$rootScope,delay:1e4})})},function(a){})}}]),angular.module("cb").controller("CBValidatorCtrl",["$scope","$http","CB","$window","$timeout","$modal","NewValidationResult","$rootScope","ServiceDelegator","StorageService","TestExecutionService","MessageUtil","FileUpload",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.cb=c,a.testStep=null,a.message=c.message,a.loading=!0,a.error=null,a.vError=null,a.vLoading=!0,a.mError=null,a.mLoading=!0,a.counter=0,a.type="cb",a.loadRate=4e3,a.tokenPromise=null,a.editorInit=!1,a.nodelay=!1,a.resized=!1,a.selectedItem=null,a.activeTab=0,a.tError=null,a.tLoading=!1,a.dqaCodes=null!=j.get(j.DQA_OPTIONS_KEY)?angular.fromJson(j.get(j.DQA_OPTIONS_KEY)):[],a.domain=null,a.protocol=null,a.hasNonPrintable=!1,a.showDQAOptions=function(){var b=f.open({templateUrl:"DQAConfig.html",controller:"DQAConfigCtrl",windowClass:"dq-modal",animation:!0,keyboard:!1,backdrop:!1});b.result.then(function(b){a.dqaCodes=b},function(){})},a.isTestCase=function(){return null!=c.testCase&&"TestCase"===c.testCase.type},a.refreshEditor=function(){e(function(){a.editor&&a.editor.refresh()},1e3)},a.loadExampleMessage=function(){if(null!=a.testStep){var b=a.testStep.testContext;if(b){var c=b.message&&null!=b.message?b.message.content:"";a.isTestCase()&&k.setTestStepExecutionMessage(a.testStep,c),a.nodelay=!0,a.cb.editor.instance.doc.setValue(c),a.execute()}}},a.uploadMessage=function(b,c){a.f=b,m.uploadMessage(b,c).then(function(c){e(function(){b.result=c.data;var d=c.data,e=b.name;a.nodelay=!0;var f=angular.fromJson(d);a.cb.message.name=e,a.cb.editor.instance.doc.setValue(f.content),a.mError=null,a.execute(),Notification.success({message:"File "+e+" successfully uploaded!",templateUrl:"NotificationSuccessTemplate.html",scope:h,delay:3e4})})},function(b){a.mError=b.data})},a.setLoadRate=function(b){a.loadRate=b},a.initCodemirror=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("cb-textarea"),{lineNumbers:!0,fixedGutter:!0,theme:"elegant",readOnly:!1,showCursorWhenSelecting:!0}),a.editor.setSize("100%",345),a.editor.on("keyup",function(){e(function(){var b=a.editor.doc.getValue();a.error=null,a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),""!==b.trim()?a.tokenPromise=e(function(){a.execute()},a.loadRate):a.execute()})}),a.editor.on("dblclick",function(b){e(function(){var b=i.getCursorService(a.testStep.testContext.format).getCoordinate(a.editor,a.cb.tree);b&&null!=b&&(b.start.index=b.start.index+1,b.end.index=b.end.index+1,a.cb.cursor.init(b,!0),i.getTreeService(a.testStep.testContext.format).selectNodeByIndex(a.cb.tree.root,c.cursor,c.message.content))})})},a.validateMessage=function(){try{if(null!=a.testStep)if(""!==a.cb.message.content&&null!=a.testStep.testContext){a.vLoading=!0,a.vError=null,k.deleteTestStepValidationReport(a.testStep);var b=i.getMessageValidator(a.testStep.testContext.format).validate(a.testStep.testContext.id,a.cb.message.content,a.testStep.nav,"Based",[],"1223");b.then(function(b){a.vLoading=!1,a.setTestStepValidationReport(b)},function(b){a.vLoading=!1,a.vError=b,a.setTestStepValidationReport(null)})}else{var c=k.getTestStepValidationReport(a.testStep);a.setTestStepValidationReport({reportId:c}),a.vLoading=!1,a.vError=null}}catch(b){a.vLoading=!1,a.vError=null,a.setTestStepValidationReport(null)}},a.setTestStepValidationReport=function(b){null!=a.testStep&&(null!=b&&void 0!=b&&null!=b.reportId&&(a.completeStep(a.testStep),k.setTestStepValidationReport(a.testStep,b.reportId)),h.$emit("cb:validationResultLoaded",b,a.testStep,a.getTestType()))},a.setTestStepMessageTree=function(b){a.buildMessageTree(b);var c=b&&null!=b&&b.elements?b:void 0;k.setTestStepMessageTree(a.testStep,c)},a.buildMessageTree=function(b){if(null!=a.testStep){var c=b&&null!=b&&b.elements?b.elements:[];"function"==typeof a.cb.tree.root.build_all&&a.cb.tree.root.build_all(c);var d=b&&null!=b&&b.delimeters?b.delimeters:[];i.updateEditorMode(a.editor,d,a.testStep.testContext.format),i.getEditorService(a.testStep.testContext.format).setEditor(a.editor),i.getTreeService(a.testStep.testContext.format).setEditor(a.editor)}},a.clearMessage=function(){a.nodelay=!0,a.mError=null,null!=a.testStep&&(k.deleteTestStepValidationReport(a.testStep),k.deleteTestStepMessageTree(a.testStep)),a.editor&&(a.editor.doc.setValue(""),a.execute())},a.saveMessage=function(){a.cb.message.download()},a.parseMessage=function(){try{if(null!=a.testStep)if(""!=a.cb.message.content&&null!=a.testStep.testContext){a.tLoading=!0,k.deleteTestStepMessageTree(a.testStep);var b=i.getMessageParser(a.testStep.testContext.format).parse(a.testStep.testContext.id,a.cb.message.content);b.then(function(b){a.tLoading=!1,a.setTestStepMessageTree(b)},function(b){a.tLoading=!1,a.tError=b,a.setTestStepMessageTree([])})}else a.setTestStepMessageTree([]),a.tError=null,a.tLoading=!1}catch(b){a.tLoading=!1,a.tError=b}},a.onNodeSelect=function(b){i.getTreeService(a.testStep.testContext.format).getEndIndex(b,a.cb.message.content),a.cb.cursor.init(b.data,!1),i.getEditorService(a.testStep.testContext.format).select(a.editor,a.cb.cursor)},a.execute=function(){if(a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cb.message.content=a.editor.doc.getValue(),a.setHasNonPrintableCharacters(),j.set(j.CB_EDITOR_CONTENT_KEY,a.cb.message.content),a.refreshEditor(),a.isTestCase()&&a.isTestCaseCompleted()){var b=k.getTestStepValidationReport(a.testStep);a.setTestStepValidationReport({reportId:b}),a.setTestStepMessageTree(k.getTestStepMessageTree(a.testStep))}else k.setTestStepExecutionMessage(a.testStep,a.cb.message.content),a.validateMessage(),a.parseMessage()},a.executeWithMessage=function(b){a.editor&&(a.editor.doc.setValue(b),a.execute())},a.clear=function(){a.vLoading=!1,a.tLoading=!1,a.mLoading=!1,a.error=null,a.tError=null,a.mError=null,a.vError=null,a.setTestStepValidationReport(null)},a.removeDuplicates=function(){a.vLoading=!0,a.$broadcast("cb:removeDuplicates")},a.clear(),a.initCodemirror(),a.$on("cb:refreshEditor",function(b){a.refreshEditor()}),a.$on("cb:clearEditor",function(b){a.clearMessage()}),h.$on("cb:reportLoaded",function(b,c){null!=a.testStep&&k.setTestStepValidationReport(a.testStep,c)}),a.$on("cb:testStepLoaded",function(b,c){if(a.clear(),a.testStep=c,null!=a.testStep.testContext){a.cb.editor=i.getEditor(a.testStep.testContext.format),a.cb.editor.instance=a.editor,a.cb.cursor=i.getCursor(a.testStep.testContext.format);var d=null;a.isTestCase()?(a.nodelay=!0,d=k.getTestStepExecutionMessage(a.testStep),void 0==d&&(d="")):(a.nodelay=!1,d=null==j.get(j.CB_EDITOR_CONTENT_KEY)?"":j.get(j.CB_EDITOR_CONTENT_KEY)),a.executeWithMessage(d)}}),a.$on("cb:removeTestStep",function(b,c){a.testStep=null}),a.$on("cb:loadEditorContent",function(b,c){a.nodelay=!0;var d=null==c?"":c;a.editor.doc.setValue(d),a.cb.message.id=null,a.cb.message.name="",a.execute()}),h.$on("cb:duplicatesRemoved",function(b,c){a.vLoading=!1}),a.initValidation=function(){},a.expandAll=function(){null!=a.cb.tree.root&&a.cb.tree.root.expand_all()},a.collapseAll=function(){null!=a.cb.tree.root&&a.cb.tree.root.collapse_all()},a.setHasNonPrintableCharacters=function(){a.hasNonPrintable=l.hasNonPrintable(a.cb.message.content)},a.showMessageWithHexadecimal=function(){f.open({templateUrl:"MessageWithHexadecimal.html",controller:"MessageWithHexadecimalDlgCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{original:function(){return a.cb.message.content}}})}}]),angular.module("cb").controller("CBProfileViewerCtrl",["$scope","CB",function(a,b){a.cb=b}]),angular.module("cb").controller("CBReportCtrl",["$scope","$sce","$http","CB",function(a,b,c,d){a.cb=d}]),angular.module("cb").controller("CBVocabularyCtrl",["$scope","CB",function(a,b){a.cb=b}]),angular.module("cb").controller("PastTestStepConsoleCtrl",["$scope","$modalInstance","title","log",function(a,b,c,d){a.title=c,a.log=d,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close()}}]),angular.module("cb").controller("CurrentTestStepConsoleCtrl",["$scope","$modalInstance","title","logger",function(a,b,c,d){a.title=c,a.logger=d,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close()}}]),angular.module("cb").controller("CBManualValidationCtrl",["$scope","CB","$http","TestExecutionService","$timeout","ManualReportService","$rootScope",function(a,b,c,d,e,f,g){a.cb=b,a.saving=!1,a.error=null,a.testStep=null,a.report=null,a.testExecutionService=d,a.saved=!1,a.error=null,a.$on("cb:manualTestStepLoaded",function(b,c){a.saved=!1,a.saving=!1,a.error=null,a.testStep=c,a.report=void 0===d.getTestStepValidationReport(c)||null===d.getTestStepValidationReport(c)?{result:{value:"",comments:""},html:null}:d.getTestStepValidationReport(c)})}]),angular.module("cb").controller("CBManualReportCtrl",["$scope","$sce","$http","CB",function(a,b,c,d){a.cb=d}]),angular.module("cb").controller("CBTestManagementCtrl",["$scope","$window","$filter","$rootScope","CB","$timeout","$sce","StorageService","TestCaseService","TestStepService","CBTestPlanManager","User","userInfoService","$modal","Notification","$modalStack","$location","$routeParams",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.selectedTestCase=e.selectedTestCase,a.testCase=e.testCase,a.selectedTP={id:null},a.selectedScope={key:null},a.testPlanScopes=null,a.testCases=[],a.testPlans=[],a.tree={},a.loading=!0,a.loadingTP=!1,a.loadingTC=!1,a.loadingTPs=!1,a.allTestPlanScopes=[{key:"USER",name:"Private"},{key:"GLOBAL",name:"Public"}],a.token=r.x,a.domain=r.d,a.error=null,a.collapsed=!1;var s=new i;a.$on("event:cb:initManagement",function(){a.initTestCase()}),a.initTestCase=function(){if(console.log("coocu"),d.isCbManagementSupported()&&m.isAuthenticated()&&d.hasWriteAccess()){if(a.error=null,a.loading=!0,a.testPlans=null,m.isAdmin()||m.isSupervisor()){a.testPlanScopes=a.allTestPlanScopes;var b=h.get(h.CB_MANAGE_SELECTED_TESTPLAN_SCOPE_KEY);a.selectedScope.key=b&&null!=b?b:a.testPlanScopes[1].key}else a.testPlanScopes=[a.allTestPlanScopes[0]],a.selectedScope.key=a.testPlanScopes[0].key;a.selectScope()}};a.get_icon_type=function(a){if("TestObject"===a.type||"TestStep"===a.type){var b=a.testingType;return"TA_MANUAL"===b||"SUT_MANUAL"===b?"fa fa-wrench":"SUT_RESPONDER"===b||"SUT_INITIATOR"===b?"fa fa-arrow-right":"TA_RESPONDER"===b||"TA_INITIATOR"===b?"fa fa-arrow-left":"fa fa-check-square-o"}return""},a.selectTP=function(){a.loadingTP=!0,a.errorTP=null,a.selectedTestCase=null,a.selectedTP.id&&null!==a.selectedTP.id&&""!==a.selectedTP.id?k.getTestPlan(a.selectedTP.id).then(function(b){a.testCases=[b],s.buildTree(b),h.set(h.CB_MANAGE_SELECTED_TESTPLAN_ID_KEY,a.selectedTP.id),a.loadingTP=!1},function(b){a.loadingTP=!1,a.errorTP="Sorry, Cannot load the test cases. Please try again"}):(a.testCases=null,h.set(h.CB_MANAGE_SELECTED_TESTPLAN_ID_KEY,""),a.loadingTP=!1)},a.selectScope=function(){a.errorTP=null,a.selectedTestCase=null,a.testPlans=null,a.testCases=null,a.errorTP=null,a.loadingTP=!1,h.set(h.CB_MANAGE_SELECTED_TESTPLAN_SCOPE_KEY,a.selectedScope.key),a.selectedScope.key&&null!==a.selectedScope.key&&""!==a.selectedScope.key&&null!=d.domain?d.domain&&null!=d.domain.domain&&(a.loadingTP=!0,k.getTestPlans(a.selectedScope.key,d.domain.domain).then(function(b){a.error=null,a.testPlans=c("orderBy")(b,"position");var d=null;if(a.testPlans.length>0){if(1===a.testPlans.length&&(d=a.testPlans[0].id),null==d){var e=h.get(h.CB_MANAGE_SELECTED_TESTPLAN_ID_KEY);d=void 0==e||null==e?"":e}a.selectedTP.id=d.toString(),a.selectTP()}else a.loadingTP=!1;a.loading=!1},function(b){a.loadingTP=!1,a.loading=!1,a.error="Sorry, Cannot load the test plans. Please try again"})):h.set(h.CB_MANAGE_SELECTED_TESTPLAN_ID_KEY,"")},a.refreshTree=function(){f(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=a.tree.get_first_branch();null!=b&&b&&a.tree.expand_branch(b);var c=null,d=h.get(h.CB_MANAGE_SELECTED_TESTCASE_ID_KEY),e=h.get(h.CB_MANAGE_SELECTED_TESTCASE_TYPE_KEY);if(null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var g=s.findOneByIdAndType(d,e,a.testCases[f]);if(null!=g){c=g;break}}null!=c&&a.selectNode(d,e)}if(c=null,d=h.get(h.CB_MANAGE_LOADED_TESTCASE_ID_KEY),e=h.get(h.CB_MANAGE_LOADED_TESTCASE_TYPE_KEY),null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var g=s.findOneByIdAndType(d,e,a.testCases[f]);if(null!=g){c=g;break}}if(null!=c){var i=h.get(h.ACTIVE_SUB_TAB_KEY);a.loadTestCase(c,i,!1)}}}else a.error="Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.isSelectable=function(a){return!0},a.selectTestNode=function(b){a.loadingTC=!0,a.error=null,a.selectedTestCase=b,h.set(h.CB_MANAGE_SELECTED_TESTCASE_ID_KEY,b.id),h.set(h.CB_MANAGE_SELECTED_TESTCASE_TYPE_KEY,b.type),f(function(){a.$broadcast("cb-manage:testCaseSelected",a.selectedTestCase),a.loadingTC=!1})},a.selectNode=function(b,c){f(function(){s.selectNodeByIdAndType(a.tree,b,c)},0)},a.deleteTreeNode=function(b,c){if(c.children&&c.children.length>0)for(var d=0;d<c.children.length;d++){var e=c.children[d];if(e==b)return c.children.splice(d,1),!0;var f=a.deleteTreeNode(b,e);if(f)return!0}return!1},a.afterDelete=function(b){for(var c=0;c<a.testCases.length;c++)if(1==a.deleteTreeNode(b,a.testCases[c])){b===a.selectedTestCase&&(a.selectedTestCase=null);break}},a.deleteTestStep=function(b){a.error=null;var c=n.open({templateUrl:"views/cb/manage/confirm-delete-teststep.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&k.deleteTestStep(b).then(function(c){"SUCCESS"===c.status?(a.afterDelete(b),o.success({message:"Test Step deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3})):a.error=c.message},function(b){a.error="Sorry, Cannot delete the test step. Please try again. \n DEBUG:"+b})},function(a){})},a.deleteTestCase=function(b){a.error=null;var c=n.open({templateUrl:"views/cb/manage/confirm-delete-testcase.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&k.deleteTestCase(b).then(function(c){"SUCCESS"===c.status?(a.afterDelete(b),o.success({message:"Test Case deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3})):a.error=c.message},function(b){a.error="Sorry, Cannot delete the test case. Please try again. \n DEBUG:"+b})},function(a){})},a.deleteTestCaseGroup=function(b){a.error=null;var c=n.open({templateUrl:"views/cb/manage/confirm-delete-testgroup.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&k.deleteTestCaseGroup(b).then(function(c){"SUCCESS"===c.status?(a.afterDelete(b),o.success({message:"Test Case Group deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3})):a.error=c.message},function(b){a.error="Sorry, Cannot delete the test case group. Please try again. \n DEBUG:"+b;
})},function(a){})},a.deleteTestPlan=function(b){a.error=null;var c=n.open({templateUrl:"views/cb/manage/confirm-delete-testplan.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&k.deleteTestPlan(b).then(function(b){if("SUCCESS"===b.status){if(null!=a.testPlans){for(var c=-1,e=0;e<a.testPlans.length;e++)if(a.testPlans[e].id==a.testCases[0].id){c=e;break}c>-1&&a.testPlans.splice(c,1),a.testCases=[],a.selectedTestCase=null}o.success({message:"Test Plan deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3})}else a.error=b.message},function(b){a.error="Sorry, Cannot delete the test plan. Please try again. \n DEBUG:"+b})},function(a){})},a.editNodeName=function(a){a.editName=a.name,a.edit=!0,a.disableEdit=!1},a.resetNodeName=function(a){a.editName=null,a.edit=!1},a.deleteTestNode=function(b){b.editName!=b.name&&("TestPlan"===b.type?a.deleteTestPlan(b):"TestCaseGroup"===b.type?a.deleteTestCaseGroup(b):"TestCase"===b.type?a.deleteTestCase(b):"TestStep"===b.type&&a.deleteTestStep(b))},a.saveNodeName=function(b){b.disableEdit=!0,b.editName!=b.name?"TestPlan"===b.type?k.updateTestPlanName(b).then(function(){b.name=b.editName,b.label=b.name,b.edit=!1,b.editName=null},function(b){a.error="Could not saved the name, please try again"}):"TestCaseGroup"===b.type?k.updateTestCaseGroupName(b).then(function(){b.name=b.editName,b.label=b.name,b.edit=!1,b.editName=null},function(b){a.error="Could not saved the name, please try again"}):"TestCase"===b.type?k.updateTestCaseName(b).then(function(){b.name=b.editName,b.label=b.name,b.edit=!1,b.editName=null},function(b){a.error="Could not saved the name, please try again"}):"TestStep"===b.type&&k.updateTestStepName(b).then(function(){b.name=b.editName,b.label=b.position+"."+b.name,b.editName=null,b.edit=!1},function(b){a.error="Could not saved the name, please try again"}):(b.edit=!1,b.editName=null)},a.publishTestPlan=function(){var b=n.open({templateUrl:"views/cb/manage/confirm-publish-testplan.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.loading=!0,k.publishTestPlan(a.selectedTestCase.id).then(function(b){"SUCCESS"===b.status?(a.selectedScope.key="GLOBAL",o.success({message:"Test Plan successfully published !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3}),a.selectScope(),a.selectedTP.id=a.selectedTestCase.id,a.selectTP()):o.error({message:b.message,templateUrl:"NotificationErrorTemplate.html",scope:d,delay:1e4}),a.loading=!1},function(b){a.loading=!1,o.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:d,delay:1e4})}))})},a.unpublishTestPlan=function(){var b=n.open({templateUrl:"views/cb/manage/confirm-unpublish-testplan.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.loading=!0,k.unpublishTestPlan(a.selectedTestCase.id).then(function(b){"SUCCESS"===b.status?(a.selectedScope.key="USER",o.success({message:"Test Plan successfully unpublished !",templateUrl:"NotificationSuccessTemplate.html",scope:d,delay:5e3}),a.selectScope(),a.selectedTP.id=a.selectedTestCase.id,a.selectTP()):o.error({message:b.message,templateUrl:"NotificationErrorTemplate.html",scope:d,delay:1e4}),a.loading=!1},function(b){a.loading=!1,o.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:d,delay:1e4})}))})},a.openUploadTestPlanModal=function(){p.dismissAll("close");var b=n.open({templateUrl:"views/cb/manage/upload.html",controller:"CBUploadCtrl",controllerAs:"ctrl",windowClass:"upload-modal",backdrop:"static",keyboard:!1});b.result.then(function(b){null!=b.id&&(a.selectedScope.key="USER",a.selectScope(),a.selectedTP.id=b.id,a.selectTP())})},a.expandAll=function(){a.$broadcast("angular-ui-tree:expand-all"),a.testCases.forEach(function(b){a.collapse(b,!1)})},a.collapseAll=function(){a.$broadcast("angular-ui-tree:collapse-all"),a.testCases.forEach(function(b){a.collapse(b,!0)})},a.collapse=function(b,c){b.collapsed,void 0!==b.children&&b.children.length>0&&b.children.forEach(function(b){a.collapse(b)})},d.$on("event:logoutConfirmed",function(){a.initTestCase()}),d.$on("event:loginConfirmed",function(){a.initTestCase()})}]),angular.module("cb").controller("CBUploadCtrl",["$scope","$http","$window","$modal","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","FileUploader","Notification","$modalInstance","userInfoService","CBTestPlanManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){k.FileSelect.prototype.isEmptyAfterSelection=function(){return!0},a.step=0;var p=a.zipUploader=new k({url:"api/cb/management/uploadZip",autoUpload:!0});p.onBeforeUploadItem=function(b){a.error=null,a.loading=!0,b.formData.push({domain:f.domain.domain})},p.onCompleteItem=function(b,c,d,e){a.error=null,"FAILURE"==c.status?(a.step=1,a.error=c.message,a.loading=!1):"SUCCESS"===c.status&&(void 0!==c.token?o.saveZip(c.token,a.domain.domain).then(function(b){a.loading=!1,"FAILURE"==b.status?(a.step=1,a.error="Could not saved the zip, please try again"):"ADD"===b.action?(l.success({message:"Test Plan Added Successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3}),m.close({id:b.id})):"UPDATE"===b.action&&(l.success({message:"Test Plan Updated Successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3}),m.close({id:b.id}))},function(b){a.step=1,a.error="Could not saved the zip, please try again"}):(a.step=1,a.error="Could not saved the zip, no token was received, please try again"))},a.gotStep=function(b){a.step=b},a.dismissModal=function(){m.dismiss()},a.generateUUID=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}}]),angular.module("cb").controller("UploadCBTokenCheckCtrl",["$scope","$http","CF","$window","$modal","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","userInfoService","Notification","modalService","$routeParams","$location","CBTestPlanManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(a.profileCheckToggleStatus=!1,a.token=decodeURIComponent(o.x),a.auth=decodeURIComponent(o.y),a.domain=decodeURIComponent(o.d),void 0!==a.token&&"undefined"!==a.auth&&void 0!==a.domain)l.isAuthenticated()?p.url("/addcbprofiles?x="+a.token+"&d="+a.domain):a.$emit("event:loginRequestWithAuth",a.auth,"/addcbprofiles?x="+a.token+"&d="+a.domain);else if(void 0!==a.token&&"undefined"===a.auth&&void 0!==a.domain){var r=e.open({templateUrl:"views/cb/manage/savingTestPlanModal.html",windowClass:"upload-modal",backdrop:"static",keyboard:!1});q.saveZip(a.token,a.domain).then(function(b){r.close(),"FAILURE"==b.status?(m.error({message:"An error occured while adding the Test Plan. Please try again or contact the administator for help",templateUrl:"NotificationErrorTemplate.html",scope:g,delay:1e4}),a.error="Could not saved the zip, please try again",r.close()):(m.success({message:"Test Plan added successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:g,delay:5e3}),r.close(),p.url("/cb?scope=USER&group="+b.id))},function(b){a.error="Could not saved the zip, please try again",r.close()})}}]),angular.module("logs").controller("LogCtrl",["$scope","ValidationLogService","TransportLogService","$rootScope","$timeout",function(a,b,c,d,e){a.numberOfValidationLogs=0,a.numberOfTransportLogs=0,a.error=null,a.loadingAll=!1,a.loadingOne=!1,a.currentDate=new Date,a.selectedType=null,a.initLogs=function(){a.loadingAll=!0,a.numberOfValidationLogs=0,e(function(){b.getTotalCount(d.domain.domain).then(function(b){a.numberOfValidationLogs=b,a.loadingAll=!1},function(b){a.loadingAll=!1,a.error="Sorry, Cannot load the logs. Please try again. \n DEBUG:"+b}),a.numberOfTransportLogs=0,c.getTotalCount(d.domain.domain).then(function(b){a.numberOfTransportLogs=b,a.loadingAll=!1},function(b){a.loadingAll=!1,a.error="Sorry, Cannot load the logs. Please try again. \n DEBUG:"+b})},1e3),d.$on("logs:decreaseValidationCount",function(b){a.numberOfValidationLogs-=1}),d.$on("logs:decreaseTransportCount",function(b){a.numberOfTransportLogs-=1})},a.selectType=function(b){a.selectedType=b}}]),angular.module("logs").controller("ValidationLogCtrl",["$scope","ValidationLogService","Notification","$modal","$rootScope","$timeout",function(a,b,c,d,e,f){a.logs=null,a.tmpLogs=null,a.logDetails=null,a.error=null,a.loadingAll=!1,a.loadingOne=!1,a.allLogs=null,a.contextType="*",a.userType="*",a.resultType="*",a.initValidationLogs=function(){a.loadingAll=!0,f(function(){b.getAll(e.domain.domain).then(function(b){a.allLogs=b,a.contextType="*",a.userType="*",a.resultType="*",a.filterBy(),a.loadingAll=!1},function(b){a.loadingAll=!1,a.error="Sorry, Cannot load the logs. Please try again. \n DEBUG:"+b})},1e3)},a.openLogDetails=function(a){d.open({templateUrl:"ValidationLogDetails.html",controller:"ValidationLogDetailsCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{validationLogItem:function(){return a}}})},a.filterBy=function(){a.logs=a.filterByResultType(a.filterByUserType(a.filterByContextType(a.allLogs))),a.tmpLogs=[].concat(a.logs)},a.filterByContextType=function(b){return _.filter(b,function(b){return"*"===a.contextType||a.contextType===b.testingStage})},a.filterByUserType=function(b){return _.filter(b,function(b){return"*"===a.userType||"AUTH"===a.userType&&b.userFullname.indexOf("Guest-")===-1||"NOT_AUTH"===a.userType&&b.userFullname.indexOf("Guest-")!==-1})},a.filterByResultType=function(b){return _.filter(b,function(b){return"*"===a.resultType||"SUCCESS"===a.resultType&&b.validationResult||"FAILED"===a.resultType&&!b.validationResult})},a.deleteLog=function(c){b.deleteLog(c.id).then(function(b){e.$emit("logs:decreaseValidationCount");var d=a.logs.indexOf(c);d>-1&&a.logs.splice(d,1)},function(b){a.error="Sorry, Cannot delete the log. Please try again. \n DEBUG:"+b})}}]),angular.module("logs").controller("TransportLogCtrl",["$scope","TransportLogService","Notification","$modal","$rootScope","$timeout",function(a,b,c,d,e,f){a.logs=null,a.tmpLogs=null,a.logDetails=null,a.error=null,a.loadingAll=!1,a.loadingOne=!1,a.allLogs=null,a.selected={},a.selected.transportType="*",a.selected.protocol="*",a.userType="*",a.transportTypes=[],a.protocols=[],a.initTransportLogs=function(){a.loadingAll=!0,f(function(){b.getAll(e.domain.domain).then(function(b){a.allLogs=b,a.selected.transportType="*",a.selected.protocol="*",a.userType="*",a.protocols=_(b).chain().flatten().pluck("protocol").unique().value(),a.transportTypes=_(b).chain().flatten().pluck("testingType").unique().value(),a.filterBy(),a.loadingAll=!1},function(b){a.loadingAll=!1,a.error="Sorry, Cannot load the logs. Please try again. \n DEBUG:"+b})},1e3)},a.openLogDetails=function(a){d.open({templateUrl:"TransportLogDetails.html",controller:"TransportLogDetailsCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{transportLogItem:function(){return a}}})},a.filterBy=function(){a.logs=a.filterByProtocol(a.filterByTransportType(a.filterByUserType(a.allLogs))),a.tmpLogs=[].concat(a.logs)},a.filterByUserType=function(b){return _.filter(b,function(b){return"*"===a.userType||"AUTH"===a.userType&&b.userFullname.indexOf("Guest-")===-1||"NOT_AUTH"===a.userType&&b.userFullname.indexOf("Guest-")!==-1})},a.filterByProtocol=function(b){return _.filter(b,function(b){return"*"===a.selected.protocol||a.selected.protocol===b.protocol})},a.filterByTransportType=function(b){return _.filter(b,function(b){return"*"===a.selected.transportType||a.selected.transportType===b.testingType})},a.getTransportTypeIcon=function(a){return"TA_MANUAL"===a||"SUT_MANUAL"===a?"fa fa-wrench":"SUT_RESPONDER"===a||"SUT_INITIATOR"===a?"fa fa-arrow-right":"TA_RESPONDER"===a||"TA_INITIATOR"===a?"fa fa-arrow-left":"fa fa-check-square-o"},a.deleteLog=function(c){b.deleteLog(c.id).then(function(b){e.$emit("logs:decreaseTransportCount");var d=a.logs.indexOf(c);d>-1&&a.logs.splice(d,1)},function(b){a.error="Sorry, Cannot delete the log. Please try again. \n DEBUG:"+b})}}]),angular.module("logs").controller("TransportLogDetailsCtrl",["$scope","$modalInstance","transportLogItem",function(a,b,c){a.transportLogItem=c,a.close=function(){b.dismiss("cancel")}}]),angular.module("logs").controller("ValidationLogDetailsCtrl",["$scope","$modalInstance","validationLogItem",function(a,b,c){a.validationLogItem=c,a.segmentErrors=[],Object.keys(a.validationLogItem.errorCountInSegment).forEach(function(b){a.segmentErrors.push({segment:b,errorCount:a.validationLogItem.errorCountInSegment[b]})}),a.tmpSegmentErrors=[].concat(a.segmentErrors),a.close=function(){b.dismiss("cancel")}}]),angular.module("account").controller("UserProfileCtrl",["$scope","$resource","AccountLoader","Account","userInfoService","$location","Transport","Notification",function(a,b,c,d,e,f,g,h){var i=b("api/accounts/:id/passwordchange",{id:"@id"});a.accountpwd={},a.initModel=function(b){a.account=b,a.accountOrig=angular.copy(a.account)},a.updateAccount=function(){new d(a.account).$save().then(function(){},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}),a.accountOrig=angular.copy(a.account)},a.resetForm=function(){a.account=angular.copy(a.accountOrig)},a.isUnchanged=function(b){return angular.equals(b,a.accountOrig)},a.changePassword=function(){var b=new i;b.username=a.account.username,b.password=a.accountpwd.currentPassword,b.newPassword=a.accountpwd.newPassword,b.id=a.account.id,b.$save().then(function(b){a.msg=angular.fromJson(b)},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.deleteAccount=function(){var b=new d;b.id=a.account.id,b.$remove(function(){e.setCurrentUser(null),a.$emit("event:logoutRequest"),f.url("/home")},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},c(e.getAccountID()).then(function(b){a.initModel(b),a.$$phase||a.$apply()},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}]),angular.module("account").controller("UserAccountCtrl",["$scope","$resource","AccountLoader","Account","userInfoService","$location","$rootScope",function(a,b,c,d,e,f,g){a.accordi={account:!0,accounts:!1},a.setSubActive=function(a){a&&null!=a&&(g.setSubActive(a),$(".accountMgt").hide(),$("#"+a).show())},a.initAccount=function(){null==g.subActivePath&&(g.subActivePath="account"),a.setSubActive(g.subActivePath)}}]),angular.module("account").directive("stDateRange",["$timeout",function(a){return{restrict:"E",require:"^stTable",scope:{before:"=",after:"="},templateUrl:"stDateRange.html",link:function(a,b,c,d){function e(b){return function(c){c.preventDefault(),c.stopPropagation(),b?a.isBeforeOpen=!0:a.isAfterOpen=!0}}var f=b.find("input"),g=angular.element(f[0]),h=angular.element(f[1]),i=c.predicate;[g,h].forEach(function(b){b.bind("blur",function(){var b={};a.isBeforeOpen||a.isAfterOpen||(a.before&&(b.before=a.before),a.after&&(b.after=a.after),a.$apply(function(){d.search(b,i)}))})}),a.openBefore=e(!0),a.openAfter=e()}}}]).directive("stNumberRange",["$timeout",function(a){return{restrict:"E",require:"^stTable",scope:{lower:"=",higher:"="},templateUrl:"stNumberRange.html",link:function(a,b,c,d){var e=b.find("input"),f=angular.element(e[0]),g=angular.element(e[1]),h=c.predicate;[f,g].forEach(function(b,c){b.bind("blur",function(){var b={};a.lower&&(b.lower=a.lower),a.higher&&(b.higher=a.higher),a.$apply(function(){d.search(b,h)})})})}}}]).filter("customFilter",["$filter",function(a){var b=a("filter"),c=function(a,b){return b=(""+b).toLowerCase(),(""+a).toLowerCase().indexOf(b)>-1};return function(a,d){function e(a,b){var d,e,f,g,h=b.before,i=b.after,j=b.lower,k=b.higher;if(angular.isObject(b)){if(b.before||b.after)try{return!(h&&(d=b.before,f=new Date(a),g=new Date(d),f>g))&&!(i&&(e=b.after,f=new Date(a),g=new Date(e),f<g))}catch(a){return!1}else if(j||k)return!(j&&(d=b.lower,a>d))&&!(k&&(e=b.higher,a<e));return!0}return c(a,b)}var f=b(a,d,e);return f}}]),angular.module("account").controller("AccountsListCtrl",["$scope","MultiTestersLoader","MultiSupervisorsLoader","Account","$modal","$resource","AccountLoader","userInfoService","$location","Notification",function(a,b,c,d,e,f,g,h,i,j){a.tmpAccountList=[].concat(a.accountList),a.account=null,a.accountOrig=null,a.accountType="tester",a.scrollbarWidth=a.getScrollbarWidth(),a.authorities=[];var k=f("api/accounts/:id/userpasswordchange",{id:"@id"}),l=(f("api/accounts/:id/approveaccount",{id:"@id"}),f("api/accounts/:id/suspendaccount",{id:"@id"}),f("api/accounts/:id/useraccounttypechange",{id:"@id"}));a.msg=null,a.accountpwd={},a.updateAccount=function(){new d(a.account).$save(function(a){},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}),a.accountOrig=angular.copy(a.account)},a.resetForm=function(){a.account=angular.copy(a.accountOrig)},a.isUnchanged=function(b){return angular.equals(b,a.accountOrig)},a.changePassword=function(){var b=new k;b.username=a.account.username,b.password=a.accountpwd.currentPassword,b.newPassword=a.accountpwd.newPassword,b.id=a.account.id,b.$save().then(function(b){a.msg=angular.fromJson(b)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.saveAccountType=function(){var b=new l;b.username=a.account.username,b.accountType=a.account.accountType,b.id=a.account.id,b.$save().then(function(b){a.msg=angular.fromJson(b)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.loadAccounts=function(){h.isAuthenticated()&&h.isAdmin()&&(a.msg=null,(new b).then(function(b){a.accountList=b,a.tmpAccountList=[].concat(a.accountList)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}))},a.initManageAccounts=function(){a.loadAccounts()},a.selectAccount=function(b){a.accountpwd={},a.account=b,a.authorities=a.accountOrig=angular.copy(a.account)},a.deleteAccount=function(){a.confirmDelete(a.account)},a.confirmDelete=function(b){var c=e.open({templateUrl:"ConfirmAccountDeleteCtrl.html",controller:"ConfirmAccountDeleteCtrl",resolve:{accountToDelete:function(){return b},accountList:function(){return a.accountList}}});c.result.then(function(b){var c=a.accountList.indexOf(b);c!==-1&&a.accountList.splice(c,1),a.tmpAccountList=[].concat(a.accountList),a.account=null},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}}]),angular.module("account").controller("ConfirmAccountDeleteCtrl",["$scope","$modalInstance","accountToDelete","accountList","Account","Notification",function(a,b,c,d,e,f){a.accountToDelete=c,a.accountList=d,a.delete=function(){e.remove({id:c.id},function(){b.close(a.accountToDelete)},function(b){f.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("account").controller("ForgottenCtrl",["$scope","$resource","$rootScope","Notification",function(a,b,c,d){var e=b("api/sooa/accounts/passwordreset",{username:"@username"});a.requestResetPassword=function(){var b=new e;b.username=a.username,b.$save(function(){"resetRequestProcessed"===b.text&&(a.username="")},function(b){d.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.getAppInfo=function(){return c.appInfo}}]),angular.module("account").controller("RegistrationCtrl",["$scope","$resource","$modal","$location","$rootScope","Notification",function(a,b,c,d,e,f){a.account={},a.registered=!1,a.agreed=!1;var g=(b("api/sooa/usernames/:username",{username:"@username"}),b("api/sooa/emails/:email",{email:"@email"}),b("api/sooa/accounts/register"));a.registerAccount=function(){if(a.agreed){var b=new g;b.accountType="tester",b.employer=a.account.employer,b.fullName=a.account.fullName,b.phone=a.account.phone,b.title=a.account.title,b.juridiction=a.account.juridiction,b.username=a.account.username,b.password=a.account.password,b.email=a.account.email,b.signedConfidentialityAgreement=!0,b.$save(function(){"userAdded"===b.text?(a.account={},a.registered=!0,d.path("/home"),f.success({message:e.appInfo.registrationSubmittedContent,templateUrl:"NotificationSuccessTemplate.html",scope:e,delay:3e4})):a.registered=!1},function(){a.registered=!1}),a.registered=!0}},a.getAppInfo=function(){return e.appInfo}}]),angular.module("account").controller("RegisterResetPasswordCtrl",["$scope","$resource","$modal","$routeParams","isFirstSetup","Notification",function(a,b,c,d,e,f){a.agreed=!1,a.displayForm=!0,a.isFirstSetup=e,angular.isDefined(d.username)||(a.displayForm=!1),""===d.username&&(a.displayForm=!1),angular.isDefined(d.token)||(a.displayForm=!1),""===d.token&&(a.displayForm=!1),angular.isDefined(d.userId)||(a.displayForm=!1),""===d.userId&&(a.displayForm=!1);var g=(b("api/sooa/accounts/register/:userId/passwordreset",{userId:"@userId",token:"@token"}),b("api/sooa/accounts/:id/passwordreset",{id:"@userId",token:"@token"}));a.user={},a.user.username=d.username,a.user.newUsername=d.username,a.user.userId=d.userId,a.user.token=d.token,a.changePassword=function(){if(a.agreed){var b=new g(a.user);b.$save(function(){a.user.password="",a.user.passwordConfirm=""},function(b){f.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}}}]),angular.module("hit-tool-directives").directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}]),angular.module("hit-tool-directives").directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),angular.module("hit-tool-directives").directive("csSelect",function(){return{require:"^stTable",template:"",scope:{row:"=csSelect"},link:function(a,b,c,d){b.bind("change",function(b){a.$apply(function(){d.select(a.row,"single")})}),a.$watch("row.isSelected",function(a,c){a===!0?b.parent().addClass("st-selected"):b.parent().removeClass("st-selected")})}}}),angular.module("hit-tool-directives").directive("mypopover",["$compile","$templateCache",function(a,b){return{restrict:"A",link:function(a,c,d){var e=b.get("profileInfo.html"),f={content:e,placement:"bottom",html:!0};$(c).popover(f)}}}]),angular.module("hit-tool-directives").directive("windowExit",["$window","$templateCache","$http","User",function(a,b,c,d){return{restrict:"AE",compile:function(c,d){var e=a.attachEvent||a.addEventListener,f=a.attachEvent?"onbeforeunload":"beforeunload";e(f,function(a){b.removeAll()})}}}]),angular.module("hit-tool-directives").directive("msg",[function(){return{restrict:"EA",replace:!0,link:function(a,b,c){var d=c.key;c.keyExpr&&a.$watch(c.keyExpr,function(a){d=a,b.text($.i18n.prop(a))}),a.$watch("language()",function(a){b.text($.i18n.prop(d))})}}}]),angular.module("hit-tool-directives").directive("loadingTestcases",["$http",function(a){return{restrict:"E",replace:!0,template:'<div><div class="overlay"></div><div class="loading"><i class="fa fa-circle-o-notch fa-spin fa-2x "></i><br>Adding test cases...</div></div>',link:function(a,b,c){a.$watch("loading",function(a){a?$(b).show():$(b).hide()})}}}]),angular.module("hit-tool-directives").directive("validatingFiles",["$http",function(a){return{restrict:"E",replace:!0,template:'<div><div class="overlay"></div><div class="loading"><i class="fa fa-circle-o-notch fa-spin fa-2x "></i><br>validating files...</div></div>',link:function(a,b,c){a.$watch("loading",function(a){a?$(b).show():$(b).hide()})}}}]),angular.module("hit-tool-directives").directive("selectMin",function(){return{restrict:"A",require:"ngModel",scope:{ngMin:"="},link:function(a,b,c,d){d.$validators.min=function(b){return!b||b>=a.ngMin}}}}),angular.module("doc").directive("apiDocs",[function(){return{restrict:"A",templateUrl:"ApiDocs.html",replace:!1,controller:"ApiDocsCtrl"}}]),angular.module("doc").directive("testcaseDoc",[function(){return{restrict:"A",templateUrl:"TestCaseDoc.html",replace:!1,controller:"TestCaseDocumentationCtrl"}}]),angular.module("doc").directive("knownIssues",[function(){return{restrict:"A",templateUrl:"KnownIssues.html",replace:!1,controller:"KnownIssuesCtrl"}}]),angular.module("doc").directive("releaseNotes",[function(){return{restrict:"A",templateUrl:"ReleaseNotes.html",replace:!1,controller:"ReleaseNotesCtrl"}}]),angular.module("doc").directive("userDocs",[function(){return{restrict:"A",templateUrl:"UserDocs.html",replace:!1,controller:"UserDocsCtrl"}}]),angular.module("doc").directive("installationGuide",[function(){return{restrict:"A",templateUrl:"InstallationGuide.html",replace:!1,controller:"InstallationGuideCtrl"}}]),angular.module("doc").directive("toolDownloads",[function(){return{restrict:"A",templateUrl:"ToolDownloadList.html",replace:!1,controller:"ToolDownloadListCtrl"}}]),angular.module("doc").controller("DocumentationCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","userInfoService","StorageService",function(a,b,c,d,e,f,g,h,i){a.status={userDoc:!0},a.scrollbarWidth=b.getScrollbarWidth(),a.selectedScope={key:"USER"},a.sectionType={key:"app"},a.documentsScopes=[],a.allDocumentsScopes=[{key:"USER",name:"Private"},{key:"GLOBAL",name:"Public"}],a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.initDocumentation=function(){a.selectSectionType("app")},a.selectScope=function(){a.error=null,a.selectedScope.key&&null!==a.selectedScope.key&&""!==a.selectedScope.key&&(i.set("DOC_MANAGE_SELECTED_SCOPE_KEY",a.selectedScope.key),a.$broadcast("event:doc:scopeChangedEvent",a.selectedScope.key,a.sectionType.key))},a.selectSectionType=function(c){a.sectionType.key=c,a.documentsScopes=[a.allDocumentsScopes[1]],b.isDocumentationManagementSupported()&&h.isAuthenticated()?("app"==a.sectionType.key&&h.isAdmin()||b.hasWriteAccess())&&(a.documentsScopes=a.allDocumentsScopes):a.documentsScopes=[a.allDocumentsScopes[1]],a.selectedScope.key=a.documentsScopes[0].key,a.selectScope()}}]),angular.module("doc").controller("UserDocsCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","StorageService","$modal","Notification","userInfoService",function(a,b,c,d,e,f,g,h,i,j,k,l){a.docs=[],a.loading=!0,a.error=null,a.scrollbarWidth=b.getScrollbarWidth(),a.scope=null,a.actionError=null,a.type="USERDOC",a.sectionType="app",a.loadDocs=function(b,c){a.loading=!0,null!==b&&void 0!==b||(b=i.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),b=b&&null!=b?b:"GLOBAL"),a.scope=b,h.getDocuments(c,b,a.type).then(function(b){a.loading=!1,a.docs=b},function(b){a.loading=!1,a.error=null,a.docs=[]})},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.isLink=function(a){return a&&null!=a&&a.startsWith("http")},a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.gotToDoc=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.initDocs(null,3e3),a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.addDocument=function(){a.actionError=null;var c=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){var c={};return c.position=a.docs.length+1,c.type=a.type,c.scope=a.scope,c.domain="app"!==a.sectionType?b.domain.domain:a.sectionType,c},accept:function(){return".pdf,.html,.doc,.docx,.pptx,.ppt"}}});c.result.then(function(c){c&&null!=c&&(k.success({message:"Document added successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.editDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){return angular.copy(c)},accept:function(){return".pdf,.html,.doc,.docx,.pptx,.ppt"}}});d.result.then(function(c){c&&null!=c&&(k.success({message:"Document saved successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.deleteDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.deleteDocument(c.id).then(function(c){k.success({message:"Document deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})},a.publishDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.publishDocument(c.id).then(function(c){k.success({message:"Document published successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})}}]),angular.module("doc").controller("CreateOrEditDocumentCtrl",["$scope","$modalInstance","DocumentationManager","FileUploader","totalNumber","document","accept",function(a,b,c,d,e,f,g){a.error=null,a.loading=!1,a.hasUrl=!1,a.totalNumber=e,a.document=f,a.uploadedPath=null,a.accept=g,a.document.path&&a.document.path.startsWith("http")?a.hasUrl=!0:(a.uploadedPath=a.document.path,a.document.path=""),a.positions=function(){for(var b=new Array(a.totalNumber),c=0;c<b.length;c++)b[c]=c+1;return b},d.FileSelect.prototype.isEmptyAfterSelection=function(){return!0};var h=a.documentUploader=new d({url:"api/documentation/uploadDocument",autoUpload:!0});h.onBeforeUploadItem=function(b){a.error=null,a.uploadedPath=null,a.loading=!0,b.formData.push({domain:a.document.domain,type:a.document.type})},h.onCompleteItem=function(b,c,d,e){a.loading=!1,a.error=null,a.uploadedPath=null,0==c.success?a.error="Could not upload and process your file.<br>"+c.message:a.uploadedPath=c.path},a.noFileFound=function(){return!a.hasUrl&&(null===a.uploadedPath||""===a.uploadedPath)},a.submit=function(){null!=a.document.title&&""!=a.document.title&&(a.error=null,a.loading=!0,a.hasUrl||null===a.uploadedPath||""===a.uploadedPath||(a.document.path=a.uploadedPath,a.document.name=a.uploadedPath.split("\\").pop().split("/").pop()),c.saveDocument(a.document).then(function(c){a.loading=!1,b.close(c)},function(b){a.loading=!1,a.error=b}))},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("doc").controller("ReleaseNotesCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","StorageService","$modal","Notification",function(a,b,c,d,e,f,g,h,i,j,k){
a.docs=[],a.loading=!1,a.error=null,a.scrollbarWidth=b.getScrollbarWidth(),a.type="RELEASENOTE",a.sectionType="app",a.scope=null,a.loadDocs=function(c,d){a.loading=!0,null!=b.domain&&(null!==c&&void 0!==c||(c=i.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),c=c&&null!=c?c:"GLOBAL"),a.scope=c,h.getDocuments(d,c,a.type).then(function(b){a.loading=!1,a.docs=b},function(b){a.loading=!1,a.error=null,a.docs=[]}))},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.initDocs(null,3e3),a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.addDocument=function(){a.actionError=null;var c=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){var c={};return c.position=a.docs.length+1,c.type=a.type,c.scope=a.scope,c.domain="app"!==a.sectionType?b.domain.domain:a.sectionType,c},accept:function(){return".pdf,.doc,.docx"}}});c.result.then(function(c){c&&null!=c&&(k.success({message:"Document added successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.editDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){return angular.copy(c)},accept:function(){return".pdf,.doc,.docx"}}});d.result.then(function(c){c&&null!=c&&(k.success({message:"Document saved successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.deleteDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.deleteDocument(c.id).then(function(c){k.success({message:"Document deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})},a.publishDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.publishDocument(c.id).then(function(c){k.success({message:"Document published successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot publish the document. Please try again. \n DEBUG:"+b})})}}]),angular.module("doc").controller("KnownIssuesCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","StorageService","$modal","Notification",function(a,b,c,d,e,f,g,h,i,j,k){a.docs=[],a.loading=!1,a.error=null,a.type="KNOWNISSUE",a.scope=null,a.sectionType="app",a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.loadDocs=function(b,c){null!=c&&(a.loading=!0,null!==b&&void 0!==b||(b=i.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),b=b&&null!=b?b:"GLOBAL"),a.scope=b,h.getDocuments(c,b,a.type).then(function(b){a.loading=!1,a.docs=b},function(b){a.loading=!1,a.error=null,a.docs=[]}))},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.initDocs(null,3e3),a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.addDocument=function(){a.actionError=null;var c=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){var c={};return c.position=a.docs.length+1,c.type=a.type,c.scope=a.scope,c.domain="app"!==a.sectionType?b.domain.domain:a.sectionType,c},accept:function(){return".pdf,.doc,.docx"}}});c.result.then(function(c){c&&null!=c&&(k.success({message:"Document added successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.editDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){return angular.copy(c)},accept:function(){return".pdf,.doc,.docx"}}});d.result.then(function(c){c&&null!=c&&(k.success({message:"Document saved successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.deleteDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.deleteDocument(c.id).then(function(c){k.success({message:"Document deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})},a.publishDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.publishDocument(c.id).then(function(c){k.success({message:"Document published successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot publish the document. Please try again. \n DEBUG:"+b})})}}]),angular.module("doc").controller("ToolDownloadListCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","StorageService","$modal","Notification",function(a,b,c,d,e,f,g,h,i,j,k){a.loading=!1,a.error=null,a.scrollbarWidth=b.getScrollbarWidth(),a.loading=!0,a.type="DELIVERABLE",a.scope=null,a.actionError=null,a.docs=[],a.canEdit=!1,a.sectionType="app",a.loadDocs=function(b,c){null!=c&&(a.loading=!0,null!==b&&void 0!==b||(b=i.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),b=b&&null!=b?b:"GLOBAL"),a.scope=b,h.getDocuments(c,b,a.type).then(function(b){a.error=null,a.docs=b,a.loading=!1},function(b){a.loading=!1,a.error="Sorry, failed to load the files",a.data=[]}))},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.initDocs(null,3e3),a.isLink=function(a){return a&&null!=a&&a.startsWith("http")},a.downloadTool=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.isLink=function(a){return a&&null!=a&&a.startsWith("http")},a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.addDocument=function(){a.actionError=null;var c=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){var c={};return c.position=a.docs.length+1,c.type=a.type,c.scope=a.scope,c.domain="app"!==a.sectionType?b.domain.domain:a.sectionType,c},accept:function(){return".zip"}}});c.result.then(function(c){c&&null!=c&&(k.success({message:"Document added successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.editDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){return angular.copy(c)},accept:function(){return".zip"}}});d.result.then(function(c){c&&null!=c&&(k.success({message:"Document saved successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.deleteDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.deleteDocument(c.id).then(function(c){k.success({message:"Document deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})},a.publishDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.publishDocument(c.id).then(function(c){k.success({message:"Document published successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot publish the document. Please try again. \n DEBUG:"+b})})}}]),angular.module("doc").controller("ApiDocsCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","$window","StorageService",function(a,b,c,d,e,f,g,h,i){a.data=[],a.loading=!1,a.error=null,a.scrollbarWidth=b.getScrollbarWidth(),a.apiLink=function(){return b.apiLink}}]),angular.module("doc").controller("InstallationGuideCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","StorageService","$modal","Notification",function(a,b,c,d,e,f,g,h,i,j,k){a.docs=[],a.loading=!1,a.error=null,a.scope=null,a.loading=!1,a.scope=null,a.type="INSTALLATION",a.sectionType="app",a.loadDocs=function(b,c){null!=c&&(a.loading=!0,null!==b&&void 0!==b||(b=i.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),b=b&&null!=b?b:"GLOBAL"),a.scope=b,h.getDocuments(c,b,a.type).then(function(b){a.error=null,a.docs=b,a.loading=!1},function(b){a.loading=!1,a.error="Sorry, failed to load the files",a.data=[]}))},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.initDocs(null,3e3),a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.isLink=function(a){return a&&null!=a&&a.startsWith("http")},a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}},a.addDocument=function(){a.actionError=null;var c=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){var c={};return c.position=a.docs.length+1,c.type=a.type,c.scope=a.scope,c.domain="app"!==a.sectionType?b.domain.domain:a.sectionType,c},accept:function(){return".pdf,.doc,.docx,.pptx,.ppt"}}});c.result.then(function(c){c&&null!=c&&(k.success({message:"Document added successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.editDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/edit-document.html",controller:"CreateOrEditDocumentCtrl",windowClass:"documentation-upload-modal",backdrop:"static",keyboard:!1,backdropClick:!1,resolve:{totalNumber:function(){return a.docs.length+1},document:function(){return angular.copy(c)},accept:function(){return".pdf,.doc,.docx,.pptx,.ppt"}}});d.result.then(function(c){c&&null!=c&&(k.success({message:"Document saved successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100))})},a.deleteDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.deleteDocument(c.id).then(function(c){k.success({message:"Document deleted successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot delete the document. Please try again. \n DEBUG:"+b})})},a.publishDocument=function(c){a.actionError=null;var d=j.open({templateUrl:"views/documentation/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&h.publishDocument(c.id).then(function(c){k.success({message:"Document published successfully !",templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.initDocs(a.scope,100)},function(b){a.actionError="Sorry, Cannot publish the document. Please try again. \n DEBUG:"+b})})}}]),angular.module("doc").controller("TestCaseDocumentationCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","DocumentationManager","ngTreetableParams","StorageService","Notification",function(a,b,c,d,e,f,g,h,i,j,k){a.context=null,a.data=null,a.loading=!1,a.scrollbarWidth=b.getScrollbarWidth(),a.error=null,a.error=null,a.tree={},a.sectionType="app",a.loadDocs=function(c,d){a.loading=!0,null!==c&&void 0!==c||(c=j.get("DOC_MANAGE_SELECTED_SCOPE_KEY"),c=c&&null!=c?c:"GLOBAL"),a.scope=c,a.domain=d,b.isDomainSelectionSupported()||1!==b.appInfo.domains.length||(a.domain=b.appInfo.domains[0].domain),h.getTestCaseDocuments(a.domain,c).then(function(b){if(a.error=null,a.context=b,a.data=[],null!=b)for(var c=0;c<b.length;c++)a.data.push(angular.fromJson(a.context[c].json));a.params.refresh(),a.loading=!1},function(b){a.loading=!1,a.error="Sorry, failed to load the documents"})},a.initDocs=function(b,c){"app"!==a.sectionType?a.initDomainDocs(b,c):a.initAppDocs(b,c)},a.initDomainDocs=function(c,d){g(function(){null!=b.domain&&a.loadDocs(c,b.domain.domain,d)},d)},a.initAppDocs=function(b,c){g(function(){a.loadDocs(b,"app",c)},c)},a.initDocs(null,3e3),a.$on("event:doc:scopeChangedEvent",function(b,c,d){a.sectionType=d,a.initDocs(c,500)}),a.params=new i({getNodes:function(b){return b?b.children:null!=a.data?a.data:[]},getTemplate:function(a){return"TestCaseDocumentationNode.html"},options:{initialState:"expanded"}}),a.downloadCompleteTestPackage=function(b){if(null!=b&&null!=a.scope&&null!=a.domain){var c=document.createElement("form");c.action="api/documentation/testPackages",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="stage",d.value=b,c.appendChild(d),d=document.createElement("input"),d.name="domain",d.value=a.domain,c.appendChild(d),d=document.createElement("input"),d.name="scope",d.value=a.scope,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()}},a.downloadExampleMessages=function(b){if(null!=b&&null!=a.scope&&null!=a.domain){var c=document.createElement("form");c.action="api/documentation/exampleMessages",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="stage",d.value=b,c.appendChild(d),d=document.createElement("input"),d.name="domain",d.value=a.domain,c.appendChild(d),d=document.createElement("input"),d.name="scope",d.value=a.scope,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()}},a.downloadArtifact=function(a,b){if(null!=a&&b){var c=document.createElement("form");c.action="api/documentation/artifact",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="path",d.value=a,c.appendChild(d),d=document.createElement("input"),d.name="title",d.value=b,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()}},a.formatUrl=function(a){return"api/"+a+"/documentation/"},a.downloadMessage=function(b){a.downloadContextFile(b.id,b.type,a.formatUrl(b.format)+"message.txt",b.title)},a.downloadProfile=function(b){a.downloadContextFile(b.id,b.type,a.formatUrl(b.format)+"profile.xml",b.title)},a.downloadValueSetLib=function(b){a.downloadContextFile(b.id,b.type,a.formatUrl(b.format)+"valueset.xml",b.title)},a.downloadConstraints=function(b){a.downloadContextFile(b.id,b.type,a.formatUrl(b.format)+"constraints.zip",b.title)},a.downloadContextFile=function(a,b,c,d){if(null!=a&&null!=b&&null!=c){var e=document.createElement("form");e.action=c,e.method="POST",e.target="_target";var f=document.createElement("input");f.name="targetId",f.value=a,e.appendChild(f),f=document.createElement("input"),f.name="targetType",f.value=b,e.appendChild(f),f=document.createElement("input"),f.name="targetTitle",f.value=d,e.appendChild(f),e.style.display="none",document.body.appendChild(e),e.submit()}},a.downloadDocument=function(a){if(null!=a){var b=document.createElement("form");b.action="api/documentation/downloadDocument",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()}}}]),angular.module("account").directive("checkEmail",["$resource",function(a){return{restrict:"AC",require:"ngModel",link:function(b,c,d,e){var f=a("api/sooa/emails/:email",{email:"@email"}),g=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;c.on("keyup",function(){if(0!==c.val().length&&g.test(c.val())){var a=new f({email:c.val()});a.$get(function(){b.emailUnique="emailNotFound"===a.text?"valid":void 0,b.emailValid=g.test(c.val())?"valid":void 0,b.emailUnique&&b.emailValid?e.$setValidity("email",!0):e.$setValidity("email",!1)},function(){})}else b.emailUnique=void 0,b.emailValid=void 0,e.$setValidity("email",!1)})}}}]),angular.module("account").directive("checkEmployer",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.checkEmployer;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(firstPassword).val();d.$setValidity("noMatch",a)})})}}}]),angular.module("account").directive("checkPassword",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.checkPassword;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("noMatch",a)})})}}}]),angular.module("account").directive("checkPhone",[function(){return{restrict:"AC",require:"ngModel",link:function(a,b,c,d){var e=/[0-9]*/;b.on("keyup",function(){b.val()&&null!=b.val()&&""!=b.val()?(a.phoneIsNumber=e.test(b.val())&&b.val()>0?"valid":void 0,a.phoneValidLength=b.val().length>=7?"valid":void 0,a.phoneIsNumber&&a.phoneValidLength?d.$setValidity("phone",!0):d.$setValidity("phone",!1)):(a.phoneIsNumber=void 0,a.phoneValidLength=void 0,d.$setValidity("phone",!0))})}}}]),angular.module("account").directive("checkPoaDate",[function(){return{replace:!0,link:function(a,b,c,d){var e=b.find("#inputStartDate"),f=b.find("#inputEndDate"),g=e.inheritedData().$ngModelController,h=f.inheritedData().$ngModelController,i=function(){var a=new Date(e.val()),b=new Date(f.val());a<b?(g.$setValidity("datesOK",!0),h.$setValidity("datesOK",!0)):(g.$setValidity("datesOK",!1),h.$setValidity("datesOK",!1))};e.on("change",i),f.on("change",i)}}}]),angular.module("account").directive("checkTimerange",[function(){return{replace:!0,link:function(a,b,c,d){var e,f,g,h,i=b.children(),j=i.find(".shour"),k=i.find(".sminute"),l=i.find(".ehour"),m=i.find(".eminute");e=j.inheritedData().$ngModelController,f=k.inheritedData().$ngModelController,g=l.inheritedData().$ngModelController,h=m.inheritedData().$ngModelController;var n=!0,o=function(){n&&(e.$setViewValue(e.$modelValue),f.$setViewValue(f.$modelValue),g.$setViewValue(g.$modelValue),h.$setViewValue(h.$modelValue),n=!1);var a=new Date,b=angular.copy(a),c=angular.copy(a);b.setHours(j.val()),b.setMinutes(k.val()),c.setHours(l.val()),c.setMinutes(m.val()),b<c?(e.$setValidity("poaOK",!0),f.$setValidity("poaOK",!0),g.$setValidity("poaOK",!0),h.$setValidity("poaOK",!0)):(e.$setValidity("poaOK",!1),f.$setValidity("poaOK",!1),g.$setValidity("poaOK",!1),h.$setValidity("poaOK",!1))};j.on("change",o),k.on("change",o),l.on("change",o),m.on("change",o)}}}]),angular.module("account").directive("checkUsername",["$resource",function(a){return{restrict:"AC",require:"ngModel",link:function(b,c,d,e){var f=a("api/sooa/usernames/:username",{username:"@username"});c.on("keyup",function(){if(c.val().length>=4){var a=new f({username:c.val()});a.$get(function(){b.usernameValidLength=c.val()&&c.val().length>=4&&c.val().length<=20?"valid":void 0,b.usernameUnique="usernameNotFound"===a.text?"valid":void 0,b.usernameValidLength&&b.usernameUnique?e.$setValidity("username",!0):e.$setValidity("username",!1)},function(){})}else b.usernameValidLength=void 0,b.usernameUnique=void 0,e.$setValidity("username",!1)})}}}]),angular.module("account").directive("passwordValidate",[function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.pwdValidLength=b&&b.length>=7?"valid":void 0,a.pwdHasLowerCaseLetter=b&&/[a-z]/.test(b)?"valid":void 0,a.pwdHasUpperCaseLetter=b&&/[A-Z]/.test(b)?"valid":void 0,a.pwdHasNumber=b&&/\d/.test(b)?"valid":void 0,a.pwdValidLength&&a.pwdHasLowerCaseLetter&&a.pwdHasUpperCaseLetter&&a.pwdHasNumber?(d.$setValidity("pwd",!0),b):void d.$setValidity("pwd",!1)})}}}]),angular.module("domains").controller("DomainsCtrl",["$scope","$rootScope","$http","$filter","$cookies","$sce","$timeout","userInfoService","StorageService","DomainsManager","$modal","$location","$window",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.status={userDoc:!0},a.selectedDomain={id:null},a.userDomains=null,a.userDomain=null,a.alertMessage=null,a.loading=!1,a.loadingDomain=!1,a.loadingAction=!1,a.loadingDomains=!1,a.domainsErrors=null,a.hasDomainAccess=function(a){return h.isAuthenticated()&&(h.isAdmin()||null!=a&&a.owner===h.getUsername())},a.initDomain=function(){a.loadDomains()},a.viewDomain=function(c,d){d=void 0==d?1e3:d,a.loadingDomain=!0,a.errorDomain=null,a.originalUserDomain=null,a.userDomain=null,g(function(){b.isDomainsManagementSupported()&&h.isAuthenticated()&&null!=c&&a.hasDomainAccess(c)?(a.userDomain=null,a.errorDomain=null,a.userDomain=angular.copy(c),a.originalUserDomain=angular.copy(a.userDomain),a.loadingDomain=!1):a.loadingDomain=!1},d)},a.openDomain=function(a){var b=m.location.protocol+"//"+m.location.host+m.location.pathname+"#/home?d="+a.domain;m.open(b,"open_toolscope_page","_blank")},a.displayScope=function(a){return"GLOBAL"===a?"Public":"Private"},a.loadDomains=function(){a.userDomains=null,a.loadingDomains=!0,a.domainsError=null,j.findByUserAndRole().then(function(c){if(a.userDomains=c,a.userDomains=d("orderBy")(a.userDomains,"position"),a.loadingDomains=!1,null!=a.userDomains&&a.userDomains.length>0){var e=null;if(1===a.userDomains.length)e=a.userDomains[0];else for(var f=0;f<a.userDomains.length;f++)if(a.userDomains[f].domain===b.domain.domain){e=a.userDomains[f];break}null!=e&&a.viewDomain(e)}},function(b){a.loadingDomains=!1,a.domainsError=b})},a.closeAlert=function(){a.alertMessage=null},a.setErrorAlert=function(b){a.alertMessage={},a.alertMessage.type="danger",a.alertMessage.message=b},a.setInfoAlert=function(b){a.alertMessage={},a.alertMessage.type="info",a.alertMessage.message=b},a.setSuccessAlert=function(b){a.alertMessage={},a.alertMessage.type="success",a.alertMessage.message=b},a.deleteDomain=function(){var c=k.open({templateUrl:"views/domains/confirm-delete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&j.delete(a.userDomain.id).then(function(c){a.userDomain=null,a.originalUserDomain=null,a.loadingAction=!1,a.setSuccessAlert("Tool scope deleted successfully!"),b.domain=null,b.reloadPage()},function(b){a.loadingAction=!1,a.setErrorAlert(b.text)})})},a.saveDomain=function(){a.loadingAction=!0,j.save(a.userDomain).then(function(c){a.userDomain=c,a.originalUserDomain=angular.copy(c),a.loadingAction=!1,a.setSuccessAlert("Tool scope saved successfully!"),b.domain=angular.copy(c),b.reloadPage()},function(b){a.loadingAction=!1,a.setErrorAlert(b.text)})},a.resetDomain=function(){var b=k.open({templateUrl:"views/domains/confirm-reset.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});b.result.then(function(b){b&&(a.userDomain=a.originalUserDomain,a.originalUserDomain=angular.copy(a.userDomain),a.setSuccessAlert("Tool scope reset successfully!"))})},a.saveAndPublishDomain=function(){if(a.canPublish(a.userDomain)){var c=k.open({templateUrl:"views/domains/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&(a.loadingAction=!0,j.saveAndPublish(a.userDomain).then(function(c){a.userDomain=c,a.originalUserDomain=angular.copy(c),a.loadingAction=!1,a.setSuccessAlert("Tool scope "+a.userDomain.name+" is now public. Please note only public test plans will be visible to users!"),a.userDomain.domain===b.domain.domain&&(b.domain=angular.copy(c),b.reloadPage())},function(b){a.loadingAction=!1,a.setErrorAlert(b.text)}))})}},a.publishDomain=function(c){if(a.canPublish(c)){var d=k.open({templateUrl:"views/domains/confirm-publish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&j.publish(c.id).then(function(d){a.setSuccessAlert("Tool scope "+c.name+" is now public. Please note only public test plans will be visible to users!"),c.domain===b.domain.domain&&(b.domain=angular.copy(d),b.reloadPage())},function(b){a.setErrorAlert(b.text)})})}},a.hasWriteAccess=function(a){return h.isAuthenticated()&&(h.isAdmin()||null!=a&&a.owner===h.getUsername())},a.canPublish=function(b){return a.hasWriteAccess(b)&&(h.isAdmin()||h.isPublisher())},a.unpublishDomain=function(c){if(a.canPublish(c)){var d=k.open({templateUrl:"views/domains/confirm-unpublish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});d.result.then(function(d){d&&j.unpublish(c.id).then(function(d){a.setSuccessAlert("Tool scope "+c.name+" is now private!"),c.domain===b.domain.domain&&(b.domain=angular.copy(d),b.reloadPage())},function(b){a.setErrorAlert(b.text)})})}},a.saveAndUnpublishDomain=function(){if(a.canPublish(a.userDomain)){var c=k.open({templateUrl:"views/domains/confirm-unpublish.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:"static",keyboard:!1});c.result.then(function(c){c&&(a.loadingAction=!0,j.saveAndUnpublish(a.userDomain).then(function(c){a.userDomain=c,a.originalUserDomain=angular.copy(c),a.loadingAction=!1,a.setSuccessAlert("Tool scope "+a.userDomain.name+" is now private. Please note only you can access the tool scope!"),a.userDomain.domain===b.domain.domain&&(b.domain=angular.copy(c),b.reloadPage())},function(b){a.loadingAction=!1,a.setErrorAlert(b.text)}))})}},a.loadDefaultHomeContent=function(){j.getDefaultHomeContent().then(function(b){a.userDomain.homeContent=b},function(b){a.loadingAction=!1,a.setErrorAlert(b)})},a.loadDefaultProfileInfo=function(){j.getDefaultProfileInfo().then(function(b){a.userDomain.profileInfo=b},function(b){a.setErrorAlert(b)})},a.loadDefaultValueSetCopyright=function(){j.getDefaultValueSetCopyright().then(function(b){a.userDomain.valueSetCopyright=b},function(b){a.setErrorAlert(b)})},a.loadDefaultMessageContent=function(){j.getDefaultMessageContent().then(function(b){a.userDomain.messageContent=b},function(b){a.setErrorAlert(b)})},a.loadDefaultValidationResultInfo=function(){j.getDefaultValidationResultInfo().then(function(b){a.userDomain.validationResultInfo=b},function(b){a.setErrorAlert(b)})}}]),angular.module("domains").controller("CreateDomainCtrl",["$scope","$modalInstance","scope","DomainsManager",function(a,b,c,d){a.newDomain={name:null,domain:null,homeTitle:null},a.error=null,a.loading=!1,a.submit=function(){null!=a.newDomain.name&&""!=a.newDomain.name&&null!=a.newDomain.homeTitle&&""!=a.newDomain.homeTitle&&"app"!=a.newDomain.name.toLowerCase()&&(a.error=null,a.loading=!0,a.newDomain.domain=a.newDomain.name.replace(/\s+/g,"-").toLowerCase(),d.create(a.newDomain.name,a.newDomain.domain,c,a.newDomain.homeTitle).then(function(c){a.loading=!1,b.close(c)},function(b){a.loading=!1,a.error=b.text}))},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("logs").directive("stLogDateRange",["$timeout",function(a){return{restrict:"E",require:"^stTable",scope:{before:"=",after:"="},templateUrl:"stLogDateRange.html",link:function(a,b,c,d){function e(b){return function(c){c.preventDefault(),c.stopPropagation(),b?a.isBeforeOpen=!0:a.isAfterOpen=!0}}var f=b.find("input"),g=angular.element(f[0]),h=angular.element(f[1]),i=c.predicate;[g,h].forEach(function(b){b.bind("blur",function(){var b={};a.isBeforeOpen||a.isAfterOpen||(a.before&&(b.before=a.before),a.after&&(b.after=a.after),a.$apply(function(){d.search(b,i)}))})}),a.openBefore=e(!0),a.openAfter=e()}}}]).directive("stNumberRange",["$timeout",function(a){return{restrict:"E",require:"^stTable",scope:{lower:"=",higher:"="},templateUrl:"stNumberRange.html",link:function(a,b,c,d){var e=b.find("input"),f=angular.element(e[0]),g=angular.element(e[1]),h=c.predicate;[f,g].forEach(function(b,c){b.bind("blur",function(){var b={};a.lower&&(b.lower=a.lower),a.higher&&(b.higher=a.higher),a.$apply(function(){d.search(b,h)})})})}}}]).filter("logCustomFilter",["$filter",function(a){var b=a("filter"),c=function(a,b){return b=(""+b).toLowerCase(),(""+a).toLowerCase().indexOf(b)>-1};return function(a,d){function e(a,b){var d,e,f,g,h=b.before,i=b.after,j=b.lower,k=b.higher;if(angular.isObject(b)){if(b.before||b.after)try{return!(h&&(d=b.before,f=new Date(a),g=new Date(d),g.setDate(g.getDate()+1),f>g))&&!(i&&(e=b.after,f=new Date(a),g=new Date(e),f<g))}catch(a){return!1}else if(j||k)return!(j&&(d=b.lower,a>d))&&!(k&&(e=b.higher,a<e));return!0}return c(a,b)}var f=b(a,d,e);return f}}]),angular.module("reports").controller("ReportsCtrl",["$scope","ValidationLogService","ReportService","Notification","$modal","$rootScope","$timeout",function(a,b,c,d,e,f,g){a.reports=null,a.tmpReports=null,a.logDetails=null,a.error=null,a.loadingAll=!1,a.loadingOne=!1,a.allReports=[],a.tmpReports-[],
a.contextType="*",a.userType="*",a.resultType="*",a.expandTCs=!0,a.expandTree=!0,a.initReportsLogs=function(){a.loadingAll=!0,g(function(){c.getAllReportsByAccountIdAndDomain(f.domain.domain).then(function(b){a.allReports=b,a.contextType="*",a.resultType="*",a.filterBy(),a.loadingAll=!1},function(b){a.loadingAll=!1,a.error="Sorry, Cannot load the reports. Please try again. \n DEBUG:"+b})},1e3)},a.toggleExpand=function(){for(var b=0,c=a.reports.length;b<c;b++)a.reports[b].expanded=a.expandTCs},a.openReportDetails=function(a){e.open({templateUrl:"ReportDetails.html",controller:"ReportDetailsCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{report:function(){return a}}})},a.filterBy=function(){a.reports=a.filterByResultType(a.filterByContextType(a.allReports)),a.tmpReports=[].concat(a.reports)},a.filterByContextType=function(b){return _.filter(b,function(b){return"*"===a.contextType||a.contextType===b.stage})},a.filterByResultType=function(b){return _.filter(b,function(b){return"*"===a.resultType||"SUCCESS"===a.resultType&&("PASSED"===b.result||"PASSED_NOTABLE_EXCEPTION"===b.result)||"FAILED"===a.resultType&&("FAILED"===b.result||"FAILED_NOT_SUPPORTED"===b.result)})},a.deleteReport=function(b){var g=e.open({templateUrl:"confirmReportDelete.html",controller:"ConfirmDialogCtrl",size:"md",backdrop:!0,keyboard:!0});g.result.then(function(e){e&&("TESTSTEP"===b.type?c.deleteTSReport(b.id).then(function(c){var e=a.reports.indexOf(b);e>-1&&a.reports.splice(e,1),d.success({message:"Report deleted successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3})},function(a){d.error({message:"Report deletion failed! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4})}):"TESTCASE"===b.type&&c.deleteTCReport(b.id).then(function(c){var e=a.reports.indexOf(b);e>-1&&a.reports.splice(e,1),d.success({message:"Report deleted successfully!",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3})},function(a){d.error({message:"Report deletion failed! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4})}))},function(a){})}}]),angular.module("reports").controller("ReportDetailsCtrl",["$scope","$modalInstance","report","ReportService",function(a,b,c,d){a.report=c,a.type=a.report.type,"TESTSTEP"===a.report.type&&d.getUserTSReport(a.report.id).then(function(b){a.reportItem=b},function(b){a.loadingAll=!1,Notification.error({message:"Report could not be loaded! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:$rootScope,delay:1e4})}),"TESTCASE"===a.report.type&&d.getUserTCReport(a.report.id).then(function(b){a.reportItem=b},function(b){a.loadingAll=!1,Notification.error({message:"Report could not be loaded! <br>If error persists, please contact the website administrator.",templateUrl:"NotificationErrorTemplate.html",scope:$rootScope,delay:1e4})}),a.close=function(){b.dismiss("cancel")},a.downloadAs=function(b){if(a.report){if("TESTSTEP"===a.report.type)return d.downloadUserTestStepValidationReport(a.report.id,b);if("TESTCASE"===a.report.type)return d.downloadUserTestCaseValidationReport(a.report.id,b)}}}]);